!function(){"use strict";angular.module("chloe",["ui.router","ui.bootstrap","angularMoment","btford.socket-io","hmTouchEvents"]).constant("baseURL","http://54.206.38.223:5006").run(["$state","$rootScope","$window",function(o,t,n){t.goBack=function(){n.history.back()}}]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(o,t,n){n.html5Mode({enabled:!1,requireBase:!1}),n.hashPrefix(""),t.otherwise("/"),o.state("main",{url:"/",templateUrl:"modules/main.html",controller:"MainCtrl"})}]).factory("jQuery",["$window",function(o){return o.jQuery}]).factory("_",["$window",function(o){return o.jQuery}]).factory("async",["$window",function(o){return o.async}]).factory("io",["$window",function(o){return o.io}]).factory("moment",["$window",function(o){return o.moment}]).factory("mySocket",["socketFactory","io","baseURL",function(o,t,n){var r=t.connect(n),e=o({ioSocket:r});return e}])}();
!function(){"use strict";angular.module("chloe").constant("Category",[{menuType:"Beverages",menuCode:"1"},{menuType:"Desserts",menuCode:"2"},{menuType:"Sides & Salads",menuCode:"3"},{menuType:"Entree",menuCode:"4"},{menuType:"Appetizers",menuCode:"5"}])}();
!function(){"use strict";function e(e,o,n,r,t,a,i,d){function c(){if(e.menuRecords&&e.menuRecords.length>0){var o=_.map(e.menuRecords,function(e){return e.orders}),n=_.flattenDeep(o);_.each(e.orderSum,function(o){var r=[],t=_.filter(n,{producttypeId:o.menuCode}),a=_.uniqBy(t,"tableno");_.each(a,function(n){if(n.producttypeId==o.menuCode){var t=_.find(e.menuRecords,{tableno:n.tableno});t?r.push(t):r=[]}}),o.menu=r}),i(function(){_.each(e.menuRecords,function(e){e.orders.sort(function(e,o){return e.checked-o.checked})})},500)}else _.each(e.orderSum,function(e){delete e.menu});console.log("SAVE $scope.menuRecords: ",e.menuRecords),r.localStorage.setItem("kitchen_orders",JSON.stringify(e.menuRecords))}e.menuRecords=[],e.orderSum=a,e.checkzz=!1,e.limit=10,e.clearDone=!1;e._menuRecords=[],o(function(){e.CurrentDate=new Date},1e3),n.on("connect",function(){console.log("socket connected...."),n.emit("register:device","Chloe"),n.on("VoidOrSuccessTo:OrderApp",function(o){if(console.log("billout: ",o),!_.isEmpty(o)){var n=_.find(e.menuRecords,{tableno:o.tableno});_.isEmpty(n)||_.each(e.menuRecords,function(e){e.tableno==o.tableno&&(e.isPaid=!0)}),c(),i(function(){d.reload()},1e3)}}),n.on("sendto:Kitchen",function(o){if(console.log("sendto:Kitchen: ",o),!_.isEmpty(o)){o.ready=!1,o.serve=!1,o.isDone=!1,o.isPaid=!1,_.isNull(o.datetime)?o.datetime1=t().format("LT"):o.datetime1=t(o.datetime).format("LT");var n=JSON.parse(r.localStorage.getItem("kitchen_orders"))||[];if(!_.isEmpty(o)){var a=_.find(n,{tableno:o.tableno});_.isEmpty(a)?(_.each(o.orders,function(e){e.checked=!1,e.tableno=o.tableno}),e.menuRecords.push(o)):(_.each(n,function(e){e.tableno==o.tableno&&e.orders.length!==o.orders.length&&(console.log("not equal"),_.each(o.orders,function(o){var n=_.find(e.orders,{p_id:o.p_id});console.log("result1: ",n),_.isEmpty(n)&&e.orders.push(o)}),e.isDone=!1,e.ready=!1,e.serve=!1)}),e.menuRecords=n)}c(),i(function(){d.reload()},1e3)}})});var s=JSON.parse(r.localStorage.getItem("kitchen_orders"))||[];_.isEmpty(s)||(s=_.reject(s,{isPaid:!0,isDone:!1}),console.log("menuRecords: ",s),e.menuRecords=s,c(),e.menuRecords=_.reject(e.menuRecords,function(e){if(e.isDone){var o=_.filter(e.orders,{isDone:!0});return console.log("ready: ",o.length," orders: ",e.orders.length),e.orders.length==o.length}}),console.log("$scope.menuRecords: ",e.menuRecords),o(function(){e.menuRecords&&e.menuRecords.length>0?_.each(e.menuRecords,function(o){var n=t(new Date),r=t(o.datetime),a=n.diff(r),i=t.duration(a).asMinutes();Math.floor(i)>1?(o.isLapsed=!0,o.lapsedTime=Math.floor(i)):o.isLapsed=!1,o.serve&&(e.clearDone=!0)}):e.clearDone=!1},1e3)),e.hmSwipeleft=function(o,r){_.each(e.menuRecords,function(e){if(e.orders&&e.orders.length>0){var r=_.filter(e.orders,{p_id:o.p_id,checked:!0});r&&r.length>0?(r=r[0],r.isDone=!0):r.isDone=!1;var a=_.filter(e.orders,{isDone:!0});if(a&&a.length==e.orders.length){e.ready=!0;var i={roomname:"Chloe",tableno:e.tableno,datetime:t().format("LT"),serve:!1,done:!1};return void n.emit("ReceiveData:sendingTo:Que",i)}e.ready=!1}}),c()},e.checkChecked=function(o){_.each(e.menuRecords,function(e){if(e.orders&&e.orders.length>0){var o=_.filter(e.orders,{checked:!0});o&&o.length>0?e.checked=!0:e.checked=!1}}),c()},e.transparentcheck=function(o){_.each(e.orderSum,function(e){_.each(e.menu,function(e){var o=_.filter(e.orders,{checked:!0});if(o&&o.length?e.checked=!0:e.checked=!1,o&&o.length==e.orders.length){e.ready=!0;var r={roomname:"Chloe",tableno:e.tableno,datetime:t().format("LT"),orders:e.orders,serve:!1,done:!1};return void n.emit("ReceiveData:sendingTo:Que",r)}e.ready=!1}),c()})},e.serveOrder=function(o){_.each(e.menuRecords,function(r){if(r.tableno==o.tableno){r.serve=!0;var a={roomname:"Chloe",tableno:o.tableno,datetime:t().format("LT"),orders:r.orders,serve:!0,done:!1};n.emit("ReceiveData:sendingTo:Que",a),e.clearDone=!0}else r.serve=!1}),c()},e.doneOrder=function(o){_.each(e.menuRecords,function(e){if(e.serve){e.isDone=!0;var r={roomname:"Chloe",tableno:o.tableno,datetime:t().format("LT"),serve:!0,orders:e.orders,done:!0};return void n.emit("ReceiveData:sendingTo:Que",r)}}),c(),i(function(){d.reload()},1e3)},e.removeAllDone=function(){_.each(e.menuRecords,function(e){if(e.serve){e.isDone=!0;var o={roomname:"Chloe",tableno:e.tableno,datetime:t().format("LT"),serve:!0,done:!0};n.emit("ReceiveData:sendingTo:Que",o)}}),c(),i(function(){d.reload()},1e3)},e.generateRandomData=function(){var o=["Vcuie","Loy2x","Estoy","LuckyBoy","Pipoy","EJBoy","Dodong"],n=["Dine - In","Take - Out","Deliver"],r=[{quantity:_.random(1,5),item_name:"Chicken Binakol",p_id:_.uniqueId()},{quantity:_.random(1,5),item_name:"Pork Sisig",p_id:_.uniqueId()},{quantity:_.random(1,5),item_name:"Sinuglaw",p_id:_.uniqueId()},{quantity:_.random(1,5),item_name:"Sack Rice",p_id:_.uniqueId()}],i=_.random(1,15);_.each(r,function(e){var o=_.sample(a);e.producttypename=o.menuType,e.producttypeId=o.menuCode,e.checked=!1,e.tableno=i});var d={orderstatus:_.sample(n),tableno:i,waitername:_.sample(o),orders:r,datetime:t().format(),datetime1:t().format("LT"),roomname:"Chloe",ready:!1,serve:!1,isDone:!1,isPaid:!1};e.menuRecords.push(d),c()}}angular.module("chloe").controller("MainCtrl",e),e.$inject=["$scope","$interval","mySocket","$window","moment","Category","$timeout","$state"]}();
!function(){"use strict";function o(o){console.log("AppConfigCtrl")}angular.module("chloe").controller("AppConfigCtrl",o),o.$inject=["$scope"]}();