!function(){"use strict";angular.module("POS17",["ngSanitize","ngAnimate","ui.router","chart.js","angular-flot","ui.bootstrap","textAngular","ngFileUpload","ui.footable","restangular","toastr","angularMoment","angularSpinner","ngDialog","ui.select","mgcrea.ngStrap","LocalStorageModule","dibari.angular-ellipsis","angular-jwt","color.picker","ja.qr","angularTreeview","angularFileUpload","dndLists","ngTable","kk.timepicker","angularjs-dropdown-multiselect","bootstrapLightbox","videosharing-embed","com.2fdevs.videogular","com.2fdevs.videogular.plugins.controls","com.2fdevs.videogular.plugins.overlayplay","com.2fdevs.videogular.plugins.buffering","info.vietnamcode.nampnq.videogular.plugins.flash","pdf","io.dennis.contextmenu","satellizer","frapontillo.bootstrap-switch","angularRipple","barcode","angular-progress-button-styles","angularPromiseButtons","ngRoute","angular-loading-bar","nvd3","ngLetterAvatar","daterangepicker"]).constant("API_URL","http://54.206.38.223:5002").constant("API_VERSION","/api/1.0/").constant("API_URL_2","http://54.206.38.223:5005").constant("API_VERSION_2","/api/1.0/").constant("FACEBOOK_API","218087938610404").constant("GOOGLE_API","608675325087-lsbmqc0m5hm6rtosar8bt99agvfce8dh.apps.googleusercontent.com").constant("TWITTER_API","04gzA1YhW0oAm2Aj36J2tcNH3").constant("LINKEDIN_API","81j8xuo5umqyqn").constant("ONESIGNAL",{appID:"b4a5359b-0427-4e97-a1e8-db8af8ebfb3b",domain:"https://4loopph.onesignal.com"})}();
!function(){"use strict";angular.module("POS17").config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider","RestangularProvider","$uibTooltipProvider","API_URL","API_VERSION","$provide","localStorageServiceProvider","uiSelectConfig","LightboxProvider","$authProvider","FACEBOOK_API","GOOGLE_API","TWITTER_API","LINKEDIN_API",function(e,r,i,t,o,a,l,n,c,d,s,u,p,h,P,m,I){i.html5Mode({enabled:!1,requireBase:!1}),i.hashPrefix(""),r.otherwise("/login"),s.resetSearchInput=!0,e.state("main",{url:"/main","abstract":!0,templateUrl:"modules/main.html",controller:"MainCtrl"}),t.interceptors.push("httpInterceptor"),t.interceptors.push("authInterceptor"),c.value("baseURL",l),o.setBaseUrl(l+n),p.facebook({clientId:h,url:l+"/auth/facebook",redirectUri:window.location.origin+"/",requiredUrlParams:["display","scope"],scope:["email"],scopeDelimiter:",",oauthType:"2.0"}),p.google({clientId:P,url:l+"/auth/google",redirectUri:window.location.origin,requiredUrlParams:["scope"],scope:["profile","email"],scopePrefix:"openid",scopeDelimiter:" ",oauthType:"2.0"}),p.linkedin({clientId:I,url:l+"/auth/linkedin",redirectUri:window.location.origin,requiredUrlParams:["state"],scope:["r_emailaddress"],scopeDelimiter:" ",oauthType:"2.0",state:"STATE"}),p.twitter({clientId:m,url:l+"/auth/twitter",redirectUri:window.location.origin+"/",oauthType:"1.0"}),u.fullScreenMode=!0}])}();
!function(){"use strict";angular.module("POS17").factory("jQuery",["$window",function(e){return e.jQuery}]).factory("_",["$window",function(e){return e.jQuery}]).factory("PDFJS",["$window",function(e){return e.PDFJS}]).factory("async",["$window",function(e){return e.async}]).run(["$state","$rootScope","usSpinnerService","AuthFctry","$window","jwtHelper","localStorageService","$location","ONESIGNAL","ngDialog","$browser",function(e,n,t,o,r,u,a,i,c,s,g){n.currentUser={},n.$state=e,n.previousState,n.currentState,n.changesOccur=0,g.baseHref=function(){return"/"},r.user_timezone=moment.tz.guess(),r.user_timezone2=moment().format("Z"),n.$on("loading:progress",function(){n.productIsLoading=!0}),n.$on("loading:finish",function(){n.productIsLoading=!1}),n.$on("unauthorized",function(){o.setCurrentUser(null),o.setUserToken(null),e.go("login")}),n.goBack=function(){r.history.back()},n.$on("$stateChangeStart",function(t,r,c,g,l){if(o.getCurrentUser()){var f=o.getUserToken();u.isTokenExpired(f)&&(a.remove("user"),a.remove("token"),i.path("/login"))}n.changesOccur>2&&(t.preventDefault(),n.modal={title:"Changes Detected?",message:"Are you sure to proceed without saving or updating?"},s.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:n,className:"ngdialog-theme-default"}).then(function(){n.changesOccur=0,e.go(r.name)},function(){console.log("NO")}))}),n.$on("$stateChangeSuccess",function(e,t,r,u,a){n.previousState=u.name,n.currentState=t.name,n.currentUser=o.getCurrentUser()});var l=r.OneSignal||[];l.push(["init",{appId:c.appID,autoRegister:!1,subdomainName:c.domain,notifyButton:{enable:!0}}])}])}();
!function(){"use strict";function e(e,t,s,o,n,r,i,u,c,a){e.profile={},e.activeSub="",t.logoutApp=function(){r.logout().then(function(e){if(200==e.statusCode&&e.response.success){var t=JSON.parse(i.get("user"));a.logTransaction("User Logout","LOGOUT",t.username,"User Logout USERNAME:="+t.username).then(function(){r.setCurrentUser(null),r.setUserToken(null),c.logout()}),s.go("login")}})},t.getCurrentUser=function(){r.userprofile().then(function(t){if(200==t.statusCode&&t.response.success){e.profile=t.response.result;var s=JSON.parse(i.get("user"));e.activeSub=s.company_name}else if(400==t.statusCode&&!t.response.success)return void o.error(t.response.msg,"Error")})},t.openSubscription=function(){var e=n.open({animation:!0,templateUrl:"./modules/templates/header.subscription.html",controller:"ModalSubscriptionCtrl",size:"sm"}),t=JSON.parse(i.get("user"));a.logTransaction("Active Subscription","DASHBOARD","N/A","User:="+t.username+" Views Active Subscription"),e.result.then(function(e){var t=JSON.parse(i.get("user"));t.sub_id=e.sub_id,t.company_name=e.company_name,t.subscriptionKey=e.subscriptionKey,i.set("user",JSON.stringify(t)),u(function(){s.go("main.dashboard",null,{reload:!0})},1e3)})},t.getCurrentUser()}function t(e,t,s){e.switchSubscription=function(e){s(function(){t.close(e)},300)},e.cancel=function(){t.dismiss("cancel")}}angular.module("POS17").controller("MainCtrl",e).controller("ModalSubscriptionCtrl",t),e.$inject=["$rootScope","$scope","$state","toastr","$uibModal","AuthFctry","localStorageService","$timeout","$auth","transLogFctry"],t.$inject=["$scope","$uibModalInstance","$timeout"]}();
!function(){"use strict";function e(e,o,n){e.dtFrom=new Date(n.dateFrom),e.dtTo=new Date(n.dateTo),e.dateOptions={formatYear:"yy",maxDate:new Date(3e3,12,31),minDate:new Date(1800,1,1),startingDay:1},e.popup1={opened:!1},e.popup2={opened:!1},e.openFrom=function(){e.popup1.opened=!0},e.openTo=function(){e.popup2.opened=!0},e.save=function(){o.close({dateFrom:e.dtFrom,dateTo:e.dtTo})},e.cancel=function(){o.dismiss("cancel")}}angular.module("POS17").controller("ModalInstanceCtrl",e),e.$inject=["$scope","$uibModalInstance","dateValue"]}();
!function(){"use strict";function e(e,n,o){e.showPreview=!1,e.fileChanged=function(n){e.sheets=[],e.excelFile=n[0],o.readFile(e.excelFile,e.showPreview).then(function(n){e.sheets=n.sheets})},e.showPreviewChanged=function(){e.showPreview&&o.readFile(e.excelFile,e.showPreview).then(function(n){e.sheets=n.sheets})},e.cancel=function(){n.dismiss("cancel")}}function n(e,n,o,i,a,s){function c(n){console.log("handleParseResult: ",n);var o=n.meta.fields;o=_.filter(o,function(e){return""!==e});var a=n.data,s=angular.copy(n.data);e.isLoading=!0,i(function(){e.$apply(function(){e.csvToSave=a,s.length=100,e.csvResult=s,e.csvHeaders=o})},10)}function t(e){console.log("handleParseError: ",e)}function r(){e.isClear=!0}var l={delimiter:"",newline:"",header:!0,dynamicTyping:!1,preview:0,encoding:"",worker:!1,comments:!1,step:void 0,complete:void 0,error:void 0,download:!1,skipEmptyLines:!0,chunk:void 0,fastMode:void 0,beforeFirstChunk:void 0,withCredentials:void 0};e.isClear=!1,e.isLoading=!1,e.csvResult={},e.csvToSave={},e.csvHeaders=[],e.csvHeadersToSave=[],e.infiniteScrollData={},e.infiniteScrollData.numToAdd=10,e.infiniteScrollData.currentItems=10,e.resetInfScroll=function(){e.infiniteScrollData.currentItems=e.infiniteScrollData.numToAdd},e.addMoreItems=function(){e.infiniteScrollData.currentItems+=e.infiniteScrollData.numToAdd},e.pairColumnsToHeaders=function(n,o){_.find(e.csvHeadersToSave,{index:o})?(e.csvHeadersToSave[o].header=n,e.csvHeadersToSave[o].index=o):e.csvHeadersToSave.push({header:n,index:o})},e.onEnd=function(){e.isLoading=!1},e.clear=function(){console.log("clear"),e.csvResult={},e.csvHeaders=[],e.isClear=!1,e.isLoading=!1},e.upload=function(e){if(e&&e.length>0){var n=e[0];o.parse(n,l).then(c)["catch"](t)["finally"](r)}},e["import"]=function(){console.log("import"),s.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){console.log("fieldName: ",e.csvHeaders),_.each(e.csvHeadersToSave,function(n){n.csvHeader=e.csvHeaders[n.index]}),console.log("$scope.csvHeadersToSave: ",e.csvHeadersToSave)})},e.cancel=function(){n.dismiss("cancel")}}angular.module("POS17").controller("ImportInstanceCtrl",e).controller("ImportCSVInstanceCtrl",n),e.$inject=["$scope","$uibModalInstance","XLSXReaderService"],n.$inject=["$scope","$uibModalInstance","Papa","$timeout","companyFactory","ngDialog"]}();
!function(){"use strict";function e(e,s,r,t,o,n,u){e.user={},e.login=function(){t.authenticate(e.user).then(function(e){e.success?(t.setUserToken(e.result.token),t.setCurrentUser(JSON.stringify(e.result.user)),u.logTransaction("User Logged In","LOGIN",e.result.user.username,"User Login for USERNAME:="+e.result.user.username),setTimeout(function(){r.info("Welcome back "+e.result.user.displayName)},2500),setTimeout(function(){s.go("main.dashboard")},3e3)):400===e.statusCode&&!e.response.success&&_.isArray(e.response.result)?_.each(e.response.result,function(e){setTimeout(function(){s.go("login")},2e3)}):(setTimeout(function(){r.error(e.msg,"Error")},3e3),setTimeout(function(){location=""},4e3))})},e.authenticate=function(e){o.authenticate(e).then(function(o){if(o){var i=o.data;console.log("resp: ",i),i.success?(t.setUserToken(i.result.token),t.setCurrentUser(JSON.stringify(i.result.user)),u.logTransaction("Social Media Logged In","LOGIN",i.result.user.username,"User Login for USERNAME:="+i.result.user.username+" TYPE:="+e),r.success("Login successfully with "+e.toUpperCase()+"!"),n(function(){s.go("main.dashboard")},100)):400===i.statusCode&&!i.response.success&&_.isArray(i.response.result)?_.each(i.response.result,function(e){r.warning(e.msg,"Warning")}):r.error(i.msg,"Error")}})["catch"](function(e){e.message?r.error(e.message):e.data?r.error(e.data.message,e.status):r.error(e)})}}angular.module("POS17").config(["$stateProvider","$routeProvider",function(e,s){var r=["$q","$auth",function(e,s){var r=e.defer();return s.isAuthenticated()?r.reject():r.resolve(),r.promise}];e.state("login",{url:"/login",templateUrl:"modules/login/login.html",controller:"LoginCtrl",resolve:{skipIfLoggedIn:r}}),s.when("/login",{templateUrl:"modules/login/login.html",controller:"LoginCtrl"})}]).controller("LoginCtrl",e),e.$inject=["$scope","$state","toastr","AuthFctry","$auth","$timeout","transLogFctry"]}();
!function(){"use strict";function s(s,o,r,e){s.detail={},s.forgotpass=function(){r.forgotPassword({email:s.detail.email}).then(function(s){if(200==s.statusCode&&s.response.success)e.success(s.response.msg,"Success"),o.reload();else{if(400!==s.statusCode||s.response.success||!_.isArray(s.response.result))return void e.error(s.response.msg,"Error");_.each(s.response.result,function(s){e.warning(s.msg,"Warning")})}})}}angular.module("POS17").config(["$stateProvider",function(s){s.state("forgot",{url:"/forgotpassword",templateUrl:"modules/forgotpassword/forgotpassword.html",controller:"ForgotPasswordCtrl"})}]).controller("ForgotPasswordCtrl",s),s.$inject=["$scope","$state","AuthFctry","toastr"]}();
!function(){"use strict";function e(e,s,r,o,n){console.log("VerifyCtrl: ",s.hash),e.isVerified=function(){e.response={},o.isVerifiedContact(s.hash).then(function(t){void 0===t?n.go("login"):t.response.success===!0?(r.warning(t.response.msg,"Warning"),e.response=t.response):t.response.success===!1&&o.verifyContact(s.hash).then(function(s){console.log("resp2",s.response),s.response.success&&(e.response=s.response,console.log("$scope.response ",e.response))})})}}function s(e){}angular.module("POS17").config(["$stateProvider",function(e){e.state("verify",{url:"/verify/:hash",templateUrl:"modules/verify/verify.html",controller:"VerifyCtrl"}).state("recovery",{url:"/recovery",templateUrl:"modules/verify/verify.recovery.html"})}]).controller("VerifyCtrl",e).controller("RecoveryCtrl",s),e.$inject=["$scope","$stateParams","toastr","AuthFctry","$state"],s.$inject=["$scope"]}();
!function(){"use strict";function e(e,s,r,n){e.detail={},e.resendVerification=function(){r.resendVerification({email:e.detail.email}).then(function(s){if(200==s.statusCode&&s.response.success)n.success(s.response.msg,"Success"),e.detail.email="";else{if(400!==s.statusCode||s.response.success||!_.isArray(s.response.result))return void n.error(s.response.msg,"Error");_.each(s.response.result,function(e){n.warning(e.msg,"Warning")})}})}}angular.module("POS17").config(["$stateProvider",function(e){e.state("resend",{url:"/resend",templateUrl:"modules/resend_verify/resend.html",controller:"ResendCtrl"})}]).controller("ResendCtrl",e),e.$inject=["$scope","$state","AuthFctry","toastr"]}();
!function(){"use strict";function e(e,r,s,o,n){console.log("VerifyRecoveryCtrl: ",r.hash),e.verifying=!0,e.hasError=!1,e.isVerified=function(){e.response={},o.isVerifiedEmailRecovery(r.hash).then(function(i){_.isUndefined(i)?n.go("login"):i.response.success?(console.log("true: "),e.verifying=!1,e.hasError=!0,s.warning(i.response.msg,"Warning"),e.response=i.response):i.response.success||(console.log("false: "),o.verifyEmailRecovery(r.hash).then(function(r){r.response.success&&(e.response=r.response,console.log("$scope.response ",e.response),e.verifying=!1,e.hasError=!1)}))})}}angular.module("POS17").config(["$stateProvider",function(e){e.state("verifyrecovery",{url:"/verifyrecovery/:hash",templateUrl:"modules/verifyrecovery/recovery.html",controller:"VerifyRecoveryCtrl"}).state("verifyrecovered",{url:"/verifyrecovered",templateUrl:"modules/verifyrecovery/recovered.html"})}]).controller("VerifyRecoveryCtrl",e),e.$inject=["$scope","$stateParams","toastr","AuthFctry","$state"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,r){r.state("main.products",{url:"/products/overview",templateUrl:"modules/products/products.html",controller:"productsController"}).state("main.products-add",{url:"/products/:p_id",templateUrl:"modules/products/product.details.html",controller:"productsAEController"}).state("main.products-bundles",{url:"/product-bundles/overview",templateUrl:"modules/products/product-bundles.html",controller:"productBundlesController"}).state("main.products-bundle-add",{url:"/products-bundle/:pb_id",templateUrl:"modules/products/product.bundle.html",controller:"productsBundleController"})}])}();
!function(){"use strict";function e(e,s,t,o,r,n,a,i,d,c,l,u,p,g,m,h,f,v,y,T,b){e.loading1=!1,e.saveText="Save Entry",e.ptypes=[],e.attributes=[],e.tags=[],e.tagsArr=[],e.product_image=[],e.details={},e.details.tags=[],e.details.start_date=new Date,e.details.end_date=new Date,e.details.is_published=!1,e.details.is_archived=!1,e.stockTrack=!1,e._stores={},e._stores.list=[],e._stores.selected=[],e._store={},e._store.selected={},e.inv={},e.inv.stockTrackQty=[],e.inv.stockTrackLevel=[],e.inv.unit={},e.inv.unit.selected={},e.inv.unit.list=[],e.inv_stockTrackDets=[],e.isEnabledstockTrack=!1,e.selectedUnit="",e.isImageNew=!1,e.tabprod={product:!0,media:!0,store:!0,price:!0,category:!0,attribute:!0,variation:!0,ratings:!0,related:!0},e.barcodeoptions={width:2,height:100,quite:10,displayValue:!0,font:"monospace",textAlign:"center",fontSize:12,backgroundColor:"",lineColor:"#000"},e.barcodesType=[{type:"ean",code:"EAN"},{type:"upc",code:"UPC"},{type:"code39",code:"Code39"},{type:"code128b",code:"Code128B"},{type:"code128c",code:"Code128c"},{type:"itf",code:"ITF"},{type:"itf14",code:"ITF14"}],e.mycode={},e.mycode.type="code128b",e.producttagsSettings={showCheckAll:!0,showUncheckAll:!0,enableSearch:!0,scrollable:!0};var C=JSON.parse(T.get("user"));r.p_id?b.logTransaction("View Product Details","PRODUCTS",r.p_id,"User:="+C.username+" View products details: ="+r.p_id):b.logTransaction("Add New Product","PRODUCTS","N/A","User:="+C.username+" Add new product entry"),l.getAllTags().then(function(s){s&&200==s.statusCode&&s.response.success?e.tagsArr=s.response.result:o.error(s.response.msg,"Error")}),d.getAllStore().then(function(s){s&&200==s.statusCode&&s.response.success&&s&&s.response&&s.response.result&&_.each(s.response.result,function(s){e._stores.list.push({id:s.store_id,label:s.name,_id:s._id,address:s.address,isChecked:!1})})}),e.changeBarcodeType=function(s){y(function(){e.$apply(function(){e.mycode.type=s})},10)},_.isEmpty(r.p_id)?(e.showPublish=!1,e.showArchive=!1,e.tabprod={product:!0,media:!1,store:!1,price:!1,category:!1,attribute:!1,variation:!1,ratings:!1,related:!1},a.getAllProdType().then(function(s){s&&200==s.statusCode&&s.response.success&&(e.ptypes=s.response.result)})):async.waterfall([function(s){a.getAllProdType().then(function(t){t&&200==t.statusCode&&t.response.success?(e.ptypes=t.response.result,s()):o.error(t&&t.response&&t.response.msg?t.response.msg:"Error","Error")})},function(s){n.getProductDetails(r.p_id).then(function(s){s&&200==s.statusCode&&s.response.success&&(e.details=s.response.result,e.showPublish=1!=e.details.is_published,e.showArchive=0==e.details.is_archived,e.tabprod={product:!0,media:!0,store:!0,price:!0,category:!0,attribute:!0,variation:!0,ratings:!0,related:!0},e.product_image=e.details.product_images,e.details.start_date=new Date(e.details.start_date),e.details.end_date=new Date(e.details.end_date),e.details.ptype_id=s.response.result.productType_id,e.details.is_published=e.IntToBoolean(e.details.is_published),e.details.is_archived=e.IntToBoolean(e.details.is_archived),l.getAllProductTags(r.p_id).then(function(s){200==s.statusCode&&s.response.success&&(e.details.tags=s.response.result)}))})}]),e.tagTransform=function(e){return{tags:e}},e.clearInput=function(e){e.search=""},e.IntToBoolean=function(e){return 1===e},e.BooleanToInt=function(e){return e===!0?1:0},e.removethumb=function(){e.details.img_default=null},e.upload=function(s){e.isImageNew=!0},e.archiveProduct=function(e){n.archiveProduct(e).then(function(e){e&&200==e.statusCode&&e.response.success?(o.success(e.response.msg,"Success"),s.go(s.current,null,{reload:!0})):o.error(e.response.msg,"Error")})},e.publishProduct=function(e){n.publishProduct(e).then(function(e){e&&200==e.statusCode&&e.response.success?(o.success(e.response.msg,"Success"),s.go(s.current,null,{reload:!0})):o.error(e.response.msg,"Error")})},e.deleteProductTags=function(e){r.p_id&&l.deleteProductTag(r.p_id,e.tags_id).then(function(e){return e&&200==e.statusCode&&e.response.success?void o.success(e.response.msg,"Success"):void o.error(e.response.msg,"Error")})},e.openUploader=function(){var e=m.open({animation:!0,templateUrl:"./modules/products/details/product.upload.modal.html",controller:"productUploaderModalCtrl",size:"lg",resolve:{product_id:function(){return r.p_id}}});e.result.then(function(e){s.reload()})},e.openLightboxModal=function(e){var s=[];s.push({url:e.image_path,thumbUrl:e.image_path}),h.openModal(s,0)},e.copyURLLink=function(e){return f.supported?(console.log("files.media_path: ",e.image_path),void f.copyText(e.image_path)):void o.warning("Sorry, copy to clipboard is not supported","Warning")},e.setAsThumbNail=function(t){console.log("files: ",t),e.modal={title:"Set as product thumbnail",message:"Are you sure to set this image?"},v.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){n.setProductImage(r.p_id,t._id).then(function(e){200==e.statusCode&&e.response.success?(o.success(e.response.msg,"Success"),s.reload()):o.warning(e.response.msg,"Warning")})})},e.deleteAllMedia=function(){v.openConfirm({templateUrl:"modules/dialog/deleteAllDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){r.p_id&&n.deleteAllProductImage(r.p_id).then(function(e){return e&&200==e.statusCode&&e.response.success?(o.success(e.response.msg,"Success"),void s.reload()):void o.error(e.response.msg,"Error")})})},e.deleteSelected=function(t){v.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){r.p_id&&n.deleteProductImageFile(r.p_id,t._id).then(function(e){return e&&200==e.statusCode&&e.response.success?(o.success(e.response.msg,"Success"),void s.reload()):void o.error(e.response.msg,"Error")})})},e.pushToStockTrack=function(s,t,o,n,a){var i={store_id:t,stock_qty:o||0,stock_level:n||0,p_id:r.p_id,stock_unit:a};e.inv_stockTrackDets[s]=i},e.addProduct=function(){var t=e.inv.unit.selected._id;e.loading1=!0,e.saveText="Saving..",e.validate=[],e.details.item_description="",e.details.selectedUnit=e.selectedUnit,e.details.sales_unit_id=t,e.details.purchase_unit_id=null,e.details.qty_convert=null,e.details.inv_id=e.inv.inv_id,async.waterfall([function(s){r.p_id?n.updateProduct(r.p_id,e.details).then(function(t){t&&200==t.statusCode&&t.response.success?(o.success(t.response.msg,"Success"),e.loading1=!1,e.saveText="Save Entry",s(null,r.p_id)):(e.validate=t.response.result,_.each(e.validate,function(e){o.warning(t.response.msg,"Error - "+e.msg)}),e.loading1=!1,e.saveText="Save Entry")}):n.saveProduct(e.details).then(function(t){t&&200==t.statusCode&&t.response.success?(o.success(t.response.msg,"Success"),console.log("data:",t),s(null,t.response.result.productid),e.loading1=!1,e.saveText="Save Entry"):(e.validate=t.response.result,_.each(e.validate,function(e){o.warning(t.response.msg,"Error - "+e.msg)}),e.loading1=!1,e.saveText="Save Entry")})},function(s,t){var r=1;e.details.tags.length>0?async.eachSeries(e.details.tags,function(n,a){n.isTag?l.saveTags(n).then(function(e){return e&&200==e.statusCode&&e.response.success?void l.saveProductTags(s,{tags_id:e.response.result}).then(function(e){return 200==e.statusCode&&e.response.success?(r++,void a()):void o.error(e.response.msg,"Error")}):void o.error(e.response.msg,"Error")}):l.saveProductTags(s,{tags_id:n.tags_id}).then(function(e){return e&&200==e.statusCode&&e.response.success?(r++,void a()):void o.error(e.response.msg,"Error")}),r>=e.details.tags.length&&t(null,s)}):t(null,s)},function(e,t){s.go(s.current,{p_id:e},{reload:!0})}])}}angular.module("POS17").controller("productsAEController",e),e.$inject=["$scope","$state","$filter","toastr","$stateParams","productFactory","ptypeFactory","supplierFctry","storeFactory","priceHistoryFactory","tagsFactory","API_URL","API_VERSION","Upload","$uibModal","Lightbox","clipboard","ngDialog","$timeout","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,t,s,r,o,n,i,c){function a(t){return!(null!=e.stockTrackQty[t]&&void 0!=e.stockTrackQty[t]&&""!=e.stockTrackQty[t]&&!isNaN(e.stockTrackQty[t]))}function l(t){return!(null!=e.stockTrackLevel[t]&&void 0!=e.stockTrackLevel[t]&&""!=e.stockTrackLevel[t]&&!isNaN(e.stockTrackLevel[t]))}e.prodStores=[],e.selectedStores=[],e.inv.unit={},e.inv.unit.selected={},e.inv.unit.list=[],e.applicationStatus="",e.isloadingstores=!1,e.istrackingloader=!1,e.isStoreloader=!1,e.isRefreshloader1=!1,e.isClickable="not-allowed",e.getAllStore=function(){e.isRefreshloader1=!0,e.stores=[],e.storesCopy=[],e.stockTrackQty=[],e.stockTrackLevel=[],e.stockTrackUnit=[],e.inv_stockTrackDets=[],async.waterfall([function(t){n.getAllStore().then(function(s){200==s.statusCode&&s.response.success?(e.stores=s.response.result,e.storesCopy=angular.copy(e.stores),t(null,e.stores)):r.error(s.response.msg,"Error")})},function(t,s){_.isEmpty(o.p_id)?(e.itemArray=angular.copy(t),e.isRefreshloader1=!1):i.getPriceHistory(o.p_id).then(function(s){200==s.statusCode&&s.response.success&&s.response.result.length>0?(e.prodStore=s.response.result,_.each(e.storesCopy,function(t){var s=_.find(e.prodStore,function(e){return t.store_id===e.store_id});s&&(t.selected=!0,t.base_price=s.base_price,t.regular_price=s.regular_price,t.rrp=s.rrp,t.sale_price=s.sale_price,t.sale_percent=s.sale_percent,t.fk_product_id=o.p_id,e.selectedStores.push(t))}),e.itemArray=angular.copy(e.storesCopy),e.isRefreshloader1=!1):200==s.statusCode&&s.response.success&&0===s.response.result.length?(e.itemArray=angular.copy(t),e.isRefreshloader1=!1):(r.error(s.response.msg,"Error"),e.isRefreshloader1=!1)})}])},e.getAllStoresByProduct=function(){_.isEmpty(o.p_id)||c.getProductAndStores(o.p_id).then(function(t){t&&t.response&&t.response.result&&(e.stockTrack=t.response.result[0]&&t.response.result[0].is_enable_tracking?t.response.result[0].is_enable_tracking:0,_.each(t.response.result,function(s,r){var o=t.response.result[r];e.inv_id=o?o.inv_id:null,e.copy_of_inv_id=angular.copy(e.inv_id),e.stockTrackQty[r]=o?o.stock_onhand:0,e.stockTrackLevel[r]=o?o.reorder_level:0;var n={selected:{_id:s.sales_unit_id,label:s.sales_unit}};e.stockTrackUnit[r]=n,t.response.result.length-1==r?e.isloadingstores=!1:e.isloadingstores=!0}),e.isloadingstores=!1)})},e._getAllProductUnits=function(){e.inv.unit.list=[],c.getAllProductUnits().then(function(t){if(t&&200==t.statusCode&&t.response.success){if(t&&t.response&&t.response.result)for(var s=t.response.result.length,r=0;r<s;r++){var o={_id:t.response.result[r].iu_id,label:t.response.result[r].unit_name,unit_symbol:t.response.result[r].unit_symbol,selected:!1};e.inv.unit.list.push(o)}}else console.log("at else ",t)})},e.getUnitsByProduct=function(){_.isEmpty(o.p_id)||c.getAllProductUnitsByPID(o.p_id).then(function(e){e&&e.response&&e.response.result?console.log("getUnitsByProduct ar if"):console.log("getUnitsByProduct at else")})},e.paginate=function(){$("#tblStore").trigger("footable_redraw")},e.updateStatus=function(t){e.applicationStatus=t,""===t?e.itemArray=angular.copy(e.storesCopy):(e.itemArray.splice(0,e.itemArray.length),_.each(e.storesCopy,function(t){_.find(e.selectedStores,function(e){return t.store_id===e.store_id})&&e.itemArray.push(t)}))},e.searchStore=function(){if(e.txtSearch){e.itemArray.splice(0,e.itemArray.length);var t=s("filter")(e.storesCopy,e.txtSearch);e.itemArray=angular.copy(t)}},e.searchStatus=function(){""===e.txtSearch&&(e.itemArray.splice(0,e.itemArray.length),e.itemArray=angular.copy(e.storesCopy))},e.changeSelectDeselectAll=function(){_.each(e.itemArray,function(t){t.selected=e.selectDeselectAll,e.checkStoresChanges(t)})},e.checkStoresChanges=function(t){if(t.selected){var s=_.find(e.selectedStores,function(e){return e.store_id===t.store_id});s||(t.base_price=0,t.regular_price=0,t.rrp=0,t.sale_price=0,t.sale_percent=0,t.fk_product_id=o.p_id,e.selectedStores.push(t))}else e.selectedStores=_.filter(e.selectedStores,function(e){return e.store_id!==t.store_id})},e.saveStore=function(s){return e.isStoreloader=!0,o.p_id?void i.saveSP(o.p_id,e.selectedStores).then(function(s){200===s.statusCode&&s.response.success?(r.success(s.response.msg,"Success"),e.isStoreloader=!1,t.go(t.current,{},{reload:!0}),e.init()):(r.error(s.response.msg,"Error"),e.isStoreloader=!1,t.go(t.current,{},{reload:!0}),e.init())}):(r.warning("WARNING: Unable to save.. no available products","WARNING"),e.isStoreloader=!1,void e.init())},e.changestockTrack=function(t){e.stockTrack=t,_.each(e.inv_stockTrackDets,function(s,r){e.inv_stockTrackDets[r].stockTrack=t})},e._pushToStockTrack=function(t,s,r,n,i){if(a(t))e.stockTrackQty[t]="",l(t)&&(e.stockTrackLevel[t]="");else{l(t)&&(e.stockTrackLevel[t]="");var c={store_id:s,stockTrackQty:r||0,stockTrackLevel:n||0,p_id:o.p_id,sales_unit_id:i?i.selected._id:null,purchase_unit_id:null,qty_convert:null,inv_id:e.copy_of_inv_id,stockTrack:e.stockTrack};e.inv_stockTrackDets[t]=c}},e.trackThisProduct=function(){e.istrackingloader=!0,c.assignStore(o.p_id,e.inv_stockTrackDets).then(function(t){t&&200===t.statusCode&&t.response.success?(e.istrackingloader=!1,r.success("Success","Success")):(r.warning("Please hit refresh and review your inputs again, then click save","Warning"),e.istrackingloader=!1)})},e.init=function(){console.log("initializing.."),e.isloadingstores=!0,e.getAllStore(),e._getAllProductUnits(),e.getAllStoresByProduct(),e.getUnitsByProduct(),e.istrackingloader=!1},e.init()}angular.module("POS17").controller("productStoreCtrl",e),e.$inject=["$scope","$state","$filter","toastr","$stateParams","storeFactory","priceHistoryFactory","productFactory"]}();
!function(){"use strict";function e(e,t,r,s,a,o,c,n,i){e.categ={repeatSelect:null,availableOptions:[]},e.categories=[],e.prodCategories=[],e.itemArray=[],e.selectedCategory=[],e.store={},e.applicationStatus="",e.getAllCategory=function(){async.waterfall([function(t){n.getAllCategory().then(function(r){200==r.statusCode&&r.response.success?(e.categ.availableOptions=r.response.result,e.categories=angular.copy(e.categ.availableOptions),t(null,e.categories)):c.error(r.response.msg,"Error")})},function(t,r){a.p_id?i.getProductsCategory(a.p_id).then(function(r){200==r.statusCode&&r.response.success&&r.response.result.length>0?(e.prodCategories=r.response.result,_.each(e.categories,function(t){var r=_.find(e.prodCategories,function(e){return t.c_id===e.fk_category_id});r&&(t.selected=!0,t.fk_category_id=r.fk_category_id,t.fk_product_id=a.p_id,e.selectedCategory.push(t))}),e.itemArray=angular.copy(e.categories)):200==r.statusCode&&r.response.success&&0===r.response.result.length?e.itemArray=angular.copy(t):c.error(r.response.msg,"Error")}):e.itemArray=angular.copy(t)}])},e.getAllCategory(),e.paginate=function(){$("#tblCategory").trigger("footable_redraw")},e.changeSelectDeselectAll=function(){_.each(e.itemArray,function(t){t.selected=e.selectDeselectAll,e.checkStoresChanges(t)})},e.checkStoresChanges=function(t){if(t.selected){var r=_.find(e.selectedCategory,function(e){return e.c_id===t.c_id});_.isUndefined(r)&&(t.fk_category_id=t.c_id,t.fk_product_id=a.p_id,e.selectedCategory.push(t))}else e.selectedCategory=_.filter(e.selectedCategory,function(e){return e.c_id!==t.c_id})},e.updateStatus=function(t){e.applicationStatus=t,""===t?e.itemArray=angular.copy(e.categories):(e.itemArray.splice(0,e.itemArray.length),_.each(e.categories,function(t){_.find(e.selectedCategory,function(e){return t.c_id===e.fk_category_id})&&e.itemArray.push(t)}))},e.searchStore=function(){if(e.txtSearch){e.itemArray.splice(0,e.itemArray.length);var t=o("filter")(e.categories,e.txtSearch);e.itemArray=angular.copy(t)}},e.searchStatus=function(){""===e.txtSearch&&(e.itemArray.splice(0,e.itemArray.length),e.itemArray=angular.copy(e.categories))},e.saveCategory=function(){var t=0;a.p_id&&async.waterfall([function(e){i.deleteProductCategory(a.p_id).then(function(t){200==t.statusCode&&t.response.success?e(null,t.response.result):e(t.response.msg,null)})},function(r,o){_.each(e.selectedCategory,function(r){console.log("selectedCategory: ",r),i.saveProductsCategory(a.p_id,{category_id:r.c_id}).then(function(a){200===a.statusCode&&a.response.success?(c.success(r.name+" - "+a.response.msg,"Success"),t++,t===e.selectedCategory.length&&s.reload()):c.error(a.response.msg,"Error")})})}])}}angular.module("POS17").controller("productCategoryCtrl",e),e.$inject=["$scope","$rootScope","$timeout","$state","$stateParams","$filter","toastr","categoryFactory","productFactory"]}();
!function(){"use strict";function e(e,t,s,i,o,r,u,n,a,l,c,d){console.log("productStoreCtrl"),e.attributes=[],e.attribute_values=[],e.getAllProductAttributes=function(){e.details.doc=d.get("visibility"),async.waterfall([function(t){l.getAttributeMapping(e.details.ptype_id).then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;t(null,s)}else i.error(e.response.msg,"Error")})},function(e,t){n.getProductAttributes(r.p_id).then(function(s){if(200==s.statusCode&&s.response.success){var o=s.response.result;t(null,e,o)}else i.error(s.response.msg,"Error")})},function(e,t,s){c.getAllCategory().then(function(o){if(200==o.statusCode&&o.response.success){var r=o.response.result;s(null,e,t,r)}else i.error(o.response.msg,"Error")})},function(e,t,s,o){n.getProductsCategory(r.p_id).then(function(r){if(200==r.statusCode&&r.response.success){var u=r.response.result,n=[];_.each(s,function(e){var t=_.find(u,function(t){return e.c_id===t.fk_category_id});t&&n.push(e)}),o(null,e,t,n)}else i.error(r.response.msg,"Error")})},function(t,s,i,o){var r=[];if(_.each(t,function(e){var t=_.filter(i,{c_id:e.fk_c_id});t&&t.length>0&&r.push(e)}),r&&r.length>0){var u=_.map(r,function(e){return e.attributes});_.each(u,function(e){var t=_.find(s.attribute_values,{att_id:e.att_id}),i=_.find(s.attribute_value_list,{att_id:e.att_id});t?(e.unique_id=t._id,e.value=t.value):(e.value=null,e.unique_id=null),i?e.attribute_list_value=i.attribute_list:e.attribute_list_value=[]}),e.attributes=u}else{var u=_.map(t,function(e){return e.attributes});_.each(u,function(e){var t=_.find(s.attribute_values,{att_id:e.att_id}),i=_.find(s.attribute_value_list,{att_id:e.att_id});t?(e.unique_id=t._id,e.value=t.value):(e.value=null,e.unique_id=null),i?e.attribute_list_value=i.attribute_list:e.attribute_list_value=[]}),e.attributes=u}console.log("$scope.attributes:",e.attributes),_.each(e.attributes,function(e){"Checkbox"==e.attribute_type&&(console.log("row:",e),"1"==e.value?e.checked=!0:e.checked=!1)})}])},_.isEmpty(r.p_id)||e.getAllProductAttributes(),e.deleteAttributeValue=function(s){console.log("attribute: ",s),_.isUndefined(s.value)?i.warning("Unable to save no attribute value","Warning"):u.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){console.log("Delete"),a.deleteAttributeValues(s.att_id,s.unique_id).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.reload()):i.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},e.saveShow=function(){if(e.details.doc){var s={product_id:r.p_id,is_show:1};d.set("visibility",!0),a.updateAttributeVisibility(s).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.reload()):i.error(e.response.msg,"Error")})}else{var o={product_id:r.p_id,is_show:0};d.set("visibility",!1),a.updateAttributeVisibility(o).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.reload()):i.error(e.response.msg,"Error")})}},e.saveAttributeValue=function(s){if(console.log("attribute: ",s),e.modal={title:"Confirm attribute",message:"Are you sure to save attribute?"},"Checkbox"==s.attribute_type){console.log("diri:",s.checked);var o={product_id:r.p_id,bundle_id:null,attribute_id:s.att_id,article_id:null,value:s.checked,value_image:null,name:s.name,description:"",is_single:0,is_image:0,is_video:0,is_audio:0}}else{console.log("diri:");var o={product_id:r.p_id,bundle_id:null,attribute_id:s.att_id,article_id:null,value:s.value,value_image:null,name:s.name,description:"",is_single:0,is_image:0,is_video:0,is_audio:0}}_.isUndefined(s.value)?i.warning("Unable to save no attribute value","Warning"):u.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){_.isNull(s.unique_id)?(console.log("Save New"),console.log("value1s",o),a.saveAttributeValues(s.att_id,o).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.reload()):i.error(e.response.msg,"Error")})):(console.log("Updated"),console.log("values",o),a.updateAttributeValues(s.att_id,s.unique_id,o).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.reload()):i.error(e.response.msg,"Error")}))},function(e){console.log("Modal promise close: ")})}}angular.module("POS17").controller("productAttributeCtrl",e),e.$inject=["$scope","$state","$filter","toastr","$timeout","$stateParams","ngDialog","productFactory","attributeFactory","ptypeFactory","categoryFactory","localStorageService"]}();
!function(){"use strict";function t(t,e,n,i,o,r,u,l,s){t.attributes=[],t.attributevalues=[],s.getAllAttribute().then(function(e){if(200==e.statusCode&&e.response.success){var n=[];n=e.response.result,o(function(){t.$apply(function(){t.attributes=n})},100)}}),t.openAttributeModal=function(){var e=u.open({animation:!0,templateUrl:"./modules/products/details/product.variants.modal.html",controller:"productVariantsModalCtrl",size:"md",resolve:{attributes:function(){return t.attributes},attributevalues:function(){return t.attributevalues}}});e.result.then(function(e){t.selected=e},function(){console.info("Modal dismissed at: "+new Date)})}}function e(t,e,n,i){t.attributes=n,t.attributevalues=i,t.infiniteScrollContacts={},t.infiniteScrollContacts.numToAdd=10,t.infiniteScrollContacts.currentItems=10,t.infiniteScrollAttributes={},t.infiniteScrollAttributes.numToAdd=10,t.infiniteScrollAttributes.currentItems=10,t.resetInfScroll=function(){t.infiniteScrollContacts.currentItems=t.infiniteScrollContacts.numToAdd},t.addMoreItems=function(){t.infiniteScrollContacts.currentItems+=t.infiniteScrollContacts.numToAdd},t.removethumb=function(){t.attrib.value_image=null},t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}angular.module("POS17").controller("productVariantsCtrl",t).controller("productVariantsModalCtrl",e),t.$inject=["$scope","$state","$filter","toastr","$timeout","$stateParams","$uibModal","productFactory","attributeFactory"],e.inject=["$scope","$uibModalInstance","attributes","attributevalues"]}();
!function(){"use strict";function t(t,o,e,a,n,r){t.rating1=5,t.isReadonly=!0,t.dtFrom=new Date;var d=new Date;t.dtTo=d.setMonth(d.getMonth()+1),t.openDate=function(){var o=r.open({animation:!0,templateUrl:"./modules/dialog/datepicker.modal.html",controller:"ModalInstanceCtrl",size:"sm",resolve:{dateValue:function(){return{dateFrom:t.dtFrom,dateTo:t.dtTo}}}});o.result.then(function(o){t.dtFrom=o.dateFrom,t.dtTo=o.dateTo;var e=moment(t.dtFrom).format("YYYY-MM-DD"),a=moment(t.dtTo).format("YYYY-MM-DD");populateGraph(e,a)})}}angular.module("POS17").controller("productRatingCtrl",t),t.$inject=["$scope","$state","$filter","toastr","$stateParams","$uibModal"]}();
!function(){"use strict";function e(e,t,s,o,n,r,l,a,i){e.selectDeselectAllRelation=!1,e.selectedDatas=[],e.products=[],e.productCopy=[],e.relatedProducts=[],s.getAllProduct().then(function(t){200==t.statusCode&&t.response.success&&(e.products=t.response.result,e.productCopy=angular.copy(e.products))}),e.getAllRelatedProducts=function(){e.relatedProducts=[],r.p_id&&o.getAllRelatedProduct(r.p_id).then(function(t){200==t.statusCode&&t.response.success&&(e.relatedProducts=t.response.result,console.log("getAllRelatedProducts: ",e.relatedProducts))})},e.getAllRelatedProducts(),e.changeSelectDeselectAllRelated=function(){_.each(e.relatedProducts,function(t){t.selected=e.selectDeselectAllRelation,e.checkRelationChanges(t)})},e.checkRelationChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.rel_id===t.rel_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.rel_id!==t.rel_id}),e.deleteSomeData=e.selectedDatas.length>0},e.addNewEntry=function(){var s=l.open({animation:!0,templateUrl:"./modules/products/details/related.product.modal.html",controller:"productRelatedModalCtrl",size:"lg",resolve:{products:function(){return e.products},product:function(){return r.p_id}}});s.result.then(function(e){t.reload()})},e.openRelationType=function(){var e=l.open({animation:!0,templateUrl:"./modules/products/relation.type.modal.html",controller:"relationTypeCtrl",size:"lg"});e.result.then(function(e){t.reload()})},e.deleteSelectedRelated=function(){e.modal={title:"Archive Product?",message:"Are you sure to archive this selected products?"},a.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var s=1;e.selectedDatas.length>0&&async.eachSeries(e.selectedDatas,function(l,a){l.selected&&o.deleteRelatedProduct(r.p_id,l.rel_id).then(function(e){return 200==e.statusCode&&e.response.success?(n.success(e.response.msg,"Success"),s++,a(),void 0):void n.error(e.response.msg,"Error")}),s==e.selectedDatas.length&&t.reload()})})},e.deleteSelected=function(s){e.modal={title:"Delete Product Relation?",message:"Are you sure to delete this selected product relation?"},a.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){o.deleteRelatedProduct(r.p_id,s).then(function(e){return 200==e.statusCode&&e.response.success?(n.success(e.response.msg,"Success"),void i(function(){t.reload()},300)):void n.error(e.response.msg,"Error")})})}}function t(e,t,s,o,n,r,l,a){e.relation={},e.relationtypes=[],e.relatedProducts=[],e.infiniteScrollContacts={},e.infiniteScrollContacts.numToAdd=10,e.infiniteScrollContacts.currentItems=10,n.getAllRelationType().then(function(t){200==t.statusCode&&t.response.success?e.relationtypes=t.response.result:s.error(t.response.msg,"Error")}),_.isUndefined(l)||(e.relation={},e.selected={},e.relatedProducts=[],e.relatedProducts=_.filter(r,function(e){return e.p_id!==l}),e.relation.product_id=l),e.resetInfScroll=function(){e.infiniteScrollContacts.currentItems=e.infiniteScrollContacts.numToAdd},e.addMoreItems=function(){e.infiniteScrollContacts.currentItems+=e.infiniteScrollContacts.numToAdd},e.saveEntry=function(){return e.relation.ref_id=e.relation.product.p_id,_.isUndefined(e.relation.ref_id)?void s.warning("Unable to saved related products. Please provide Product and Relation Type","Warning"):void n.saveRelatedProduct(l,e.relation).then(function(e){if(200==e.statusCode&&e.response.success)s.success(e.response.msg,"Success"),a(function(){t.close()},600);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void s.error(e.response.msg,"Error");_.each(e.response.result,function(e){s.warning(e.msg,"Warning")})}})},e.cancel=function(){t.dismiss("cancel")}}function s(e,t,s,o,n){e.relationtypes=[],e.relation={},e.relation.disablename=!0,e.relation.disablelabel=!0,e.relation.disabledesc=!0,e.relation.disabletype=!0,e.relation.disablenewbutton=!1,e.relation.disablesavebutton=!0,e.state="add",o.getAllRelationType().then(function(s){200==s.statusCode&&s.response.success?e.relationtypes=s.response.result:t.error(s.response.msg,"Error")}),e.refreshData=function(){e.relationtypes=[],o.getAllRelationType().then(function(s){200==s.statusCode&&s.response.success?(e.relationtypes=s.response.result,console.log("$scope.relationtypes: ",e.relationtypes)):t.error(s.response.msg,"Error")})},e.newEntry=function(){e.relation={},e.relation.disablename=!1,e.relation.disablelabel=!1,e.relation.disabledesc=!1,e.relation.disabletype=!1,e.relation.disablenewbutton=!0,e.relation.disablesavebutton=!1,e.state="add"},e.cancelEntry=function(){e.relation={},e.relation.disablename=!0,e.relation.disablelabel=!0,e.relation.disabledesc=!0,e.relation.disabletype=!0,e.relation.disablenewbutton=!1,e.relation.disablesavebutton=!0,e.state="add"},e.getSelected=function(s){o.getRelationType(s.rel_type_id).then(function(s){200==s.statusCode&&s.response.success?(e.state="update",e.relation=s.response.result,e.relation.disablename=!1,e.relation.disablelabel=!1,e.relation.disabledesc=!1,e.relation.disabletype=!1,e.relation.disablenewbutton=!0,e.relation.disablesavebutton=!1):t.error(s.response.msg,"Error")})},e.deleteSelected=function(s){e.modal={title:"Delete Relation Type?",message:"Are you sure to delete this selected product relation?"},n.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){o.deleteRelationType(s).then(function(s){return 200==s.statusCode&&s.response.success?(t.success(s.response.msg,"Success"),void e.refreshData()):void t.error(s.response.msg,"Error")})})},e.saveEntry=function(){"add"==e.state?(console.log("add relation: ",e.relation),o.saveRelationType(e.relation).then(function(s){if(200==s.statusCode&&s.response.success)e.cancelEntry(),e.refreshData(),t.success(s.response.msg,"Success");else{if(400!==s.statusCode||s.response.success||!_.isArray(s.response.result))return void t.error(s.response.msg,"Error");_.each(s.response.result,function(e){t.warning(e.msg,"Warning")})}})):(console.log("update relation: ",e.relation),o.updateRelationType(e.relation.rel_type_id,e.relation).then(function(s){if(200==s.statusCode&&s.response.success)e.cancelEntry(),e.refreshData(),t.success(s.response.msg,"Success");else{if(400!==s.statusCode||s.response.success||!_.isArray(s.response.result))return void t.error(s.response.msg,"Error");_.each(s.response.result,function(e){t.warning(e.msg,"Warning")})}}))},e.cancel=function(){s.dismiss("cancel")}}angular.module("POS17").controller("productRelatedCtrl",e).controller("productRelatedModalCtrl",t).controller("relationTypeCtrl",s),e.$inject=["$scope","$state","productFactory","relatedProductFactory","toastr","$stateParams","$uibModal","ngDialog","$timeout"],t.$inject=["$scope","$uibModalInstance","toastr","productFactory","relatedProductFactory","products","product","$timeout"],s.$inject=["$scope","toastr","$uibModalInstance","relatedProductFactory","ngDialog"]}();
!function(){"use strict";function e(e,o,t,l,c,r,a,n,i,u,s){console.log("productUploaderModalCtrl"),e.item={};var p=JSON.parse(i.get("user")),d=e.uploader=new t({url:l+c+"product/"+r+"/upload-batch-image",method:"PUT",headers:{Authorization:"Bearer "+n.getUserToken(),accesskey:p.subscriptionKey}});console.log("uploader:",d),d.filters.push({name:"imageFilter",fn:function(e,o){var t="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return"|jpg|png|jpeg|bmp|gif|".indexOf(t)!==-1}}),d.onBeforeUploadItem=function(e){e.alias="product_img"},d.onCompleteAll=function(e){s.success("Media / File upload complete","Success"),u(function(){o.close(r)},1300)},e.cancel=function(){o.dismiss("cancel")}}angular.module("POS17").controller("productUploaderModalCtrl",e),e.$inject=["$scope","$uibModalInstance","FileUploader","API_URL","API_VERSION","product_id","Upload","AuthFctry","localStorageService","$timeout","toastr"]}();
!function(){"use strict";function e(e,t,s,r,o,c,a,i,l,d,n,u,p,f){function h(){i.getAllCategory().then(function(t){if(200==t.statusCode&&t.response.success){var s=t.response.result;_.each(s,function(t){var r=t.label,o=t.name,c=t.description,a=t.parent_id,i=t.c_id,l=_.filter(s,{parent_id:i.toString()});_.isNull(a)&&e.categoryData.push({parentid:a,description:c,label:r,name:o,c_id:i,item:{parentid:a,description:c,label:r,name:o,c_id:i},items:l})}),e.categoryDataCopy=angular.copy(e.categoryData)}})}e.search={},e.currentNode={},e.currentPage=1,e.entryLimit=5,e.selectDeselectAll=!1,e.applicationStatus="All",e.displayModel="List",e.filterStatus="Relevance",e.txtSearch="",e.isList=!1,e.viewby=25,e.pageSize=e.viewby,e.currentPage=1,e.itemsPerPage=20,e.totalUsers=0,e.categories=[],e.selectedDatas=[],e.selectedPublishedDatas=[],e.selectedDraftedDatas=[],e.selectedArchivedDatas=[],e.categoryData=[],e.categoryDataCopy=[],e.productsToFilter=[],e.tagsArr=[],e.tagsFilter=[],e.example8settings={showCheckAll:!1,showUncheckAll:!1,enableSearch:!0,scrollableHeight:"300px",scrollable:!0};e.side=!1;var g=JSON.parse(n.get("user"));u.logTransaction("View Products","PRODUCTS","ALL","User:="+g.username+" View ALL List of products");var m=function(){e.productTable=new l({page:1,count:20},{counts:[20,45,60,100],getData:function(t,r){e.productIsLoading=!0,e.products=[],e.productscopy=[],a.getAllProduct().then(function(o){if(200==o.statusCode&&o.response.success){var a=o.response.result;if(e.totalItems=a.length,e.productscopy=angular.copy(o.response.result),e.txtSearch&&"All"==e.applicationStatus&&_.isEmpty(e.currentNode))console.log("1"),e.products=s("filter")(a,e.txtSearch);else if(e.txtSearch&&"Publish"==e.applicationStatus&&_.isEmpty(e.currentNode))console.log("2"),e.products=s("filter")(a,{is_published:1}),e.products=s("filter")(e.products,e.txtSearch);else if(e.txtSearch&&"Archived"==e.applicationStatus&&_.isEmpty(e.currentNode))console.log("3"),e.products=s("filter")(a,{is_archived:1}),e.products=s("filter")(e.products,e.txtSearch);else if(e.txtSearch&&"Draft"==e.applicationStatus&&_.isEmpty(e.currentNode))console.log("4"),e.products=s("filter")(a,{is_published:0}),e.products=s("filter")(e.products,e.txtSearch);else if(_.isEmpty(e.txtSearch)&&"All"==e.applicationStatus)_.isEmpty(e.currentNode)?e.products=a:_.each(e.productsToFilter,function(t){var s=_.find(a,{p_id:t.p_id});s&&e.products.push(s)});else if(_.isEmpty(e.txtSearch)&&"Publish"==e.applicationStatus)if(console.log("6"),_.isEmpty(e.currentNode))e.products=s("filter")(a,{is_published:1});else{var i=s("filter")(a,{is_published:1});_.each(e.productsToFilter,function(t){var s=_.find(i,{p_id:t.p_id});s&&e.products.push(s)})}else if(_.isEmpty(e.txtSearch)&&"Archived"==e.applicationStatus)if(console.log("7"),_.isEmpty(e.currentNode))e.products=s("filter")(a,{is_archived:1});else{var i=s("filter")(a,{is_archived:1});_.each(e.productsToFilter,function(t){var s=_.find(i,{p_id:t.p_id});s&&e.products.push(s)})}else if(_.isEmpty(e.txtSearch)&&"Draft"==e.applicationStatus)if(console.log("8"),_.isEmpty(e.currentNode))e.products=s("filter")(a,{is_published:0});else{var i=s("filter")(a,{is_published:0});_.each(e.productsToFilter,function(t){var s=_.find(i,{p_id:t.p_id});s&&e.products.push(s)})}else e.products=a;if("Most Viewed"==e.filterStatus?(e.products=s("orderBy")(e.products,"product_views",!0),e.products=_.filter(e.products,function(e){return parseInt(e.product_views)>0})):"Price: High to Low"==e.filterStatus?e.products=s("orderBy")(e.products,"sell_price",!0):"Price: Low to High"==e.filterStatus&&(e.products=s("orderBy")(e.products,"sell_price",!1)),e.tagsFilter&&e.tagsFilter.length>0){var l=[];_.each(e.tagsFilter,function(t){_.each(e.products,function(e){var s=_.find(e.tags,{tags_id:t.id});s&&l.push(e)})}),e.products=l}r.total(e.products.length);var d=e.products.slice((r.page()-1)*r.count(),r.page()*r.count());t.resolve(d),e.productIsLoading=!1}else e.productIsLoading=!1,c.error(o.response.msg,"Error")})}})};f.getAllTags().then(function(t){if(200==t.statusCode&&t.response.success){var s=t.response.result;_.each(s,function(t){e.tagsArr.push({id:t.tags_id,label:t.tags,_id:t._id})})}else c.error(t.response.msg,"Error")}),e.selectEvents={onItemSelect:function(t){e.productTable.reload()},onItemDeselect:function(t){e.productTable.reload()}},e.changeDisplay=function(){e.isList=!e.isList},e.filterByCategory=function(t){var s=[],r={},o={},c=[];if(e.currentNode=t,e.currentNode&&angular.isObject(e.currentNode)){var a=_.find(e.categoryDataCopy,{parentid:t.c_id});if(_.isUndefined(a)){var i=_.map(e.productscopy,function(t){var s=_.filter(t.product_category,{category_id:e.currentNode.c_id});if(s.length>0)return _.find(s,function(e){return e})});o=_.filter(i,function(e){if(!_.isUndefined(e))return e}),r=_.map(_.uniqBy(o,"product_id"),function(e){return e.product_id}),_.forEach(r,function(t){s.push(_.find(e.productscopy,{p_id:t}))})}else{var l=_.map(a.items,function(e){return{c_id:e.item.c_id}});_.each(e.productscopy,function(e){_.each(l,function(t){var s=_.filter(e.product_category,{category_id:t.c_id});s&&s.length>0&&c.push(s[0])})});var d=_.map(_.uniqBy(c,"product_id"),function(e){return e.product_id});_.forEach(d,function(t){s.push(_.find(e.productscopy,{p_id:t}))})}}e.productsToFilter=s,e.productTable.reload()},h(),m(),i.getAllCategory().then(function(t){200==t.statusCode&&t.response.success&&(e.categories=t.response.result)}),e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage=t,e.currentPage=1},e.edit=function(e){r.go("main.products-add",{p_id:e})},e.searchData=function(){e.productTable.reload()},e.refresh=function(){e.productIsLoading=!0,e.productTable.reload()},e.updateStatus=function(t){e.applicationStatus=t,e.productTable.reload()},e.updateFilterStatus=function(t){e.filterStatus=t,e.productTable.reload()},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.products,function(t){t.selected=e.selectDeselectAll,e.checkDataChanges(t)})},e.checkDataChanges=function(t){console.log("product:",t),t.selected?_.find(e.selectedDatas,{p_id:t.p_id})||(e.selectedDatas.push(t),1==t.is_published&&0==t.is_archived&&e.selectedPublishedDatas.push(t),0==t.is_published&&0==t.is_archived&&e.selectedDraftedDatas.push(t),1==t.is_archived&&0==t.is_published&&e.selectedArchivedDatas.push(t)):(e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.p_id!==t.p_id}),e.selectedPublishedDatas=_.filter(e.selectedPublishedDatas,function(e){return e.p_id!==t.p_id}),e.selectedDraftedDatas=_.filter(e.selectedDraftedDatas,function(e){return e.p_id!==t.p_id}),e.selectedArchivedDatas=_.filter(e.selectedArchivedDatas,function(e){return e.p_id!==t.p_id})),console.log("$scope.selectedDatas:",e.selectedDatas),e.deleteSomeData=e.selectedDatas.length>0},e.updateHistory=function(e){p.open({animation:!0,backdrop:"static",templateUrl:"./modules/products/product.auditlog.modal.html",controller:"productAuditLogModalCtrl",size:"md",resolve:{product_id:function(){return e}}})},e.toggleModal=function(t){d.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){a.archiveProduct(t).then(function(e){return 200==e.statusCode&&e.response.success?(c.success(e.response.msg,"Success"),void r.reload()):void c.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},e.deleteSelected=function(){e.modal={title:"Archive Product?",message:"Are you sure to archive this selected products?"},d.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=1,s=e.selectedDraftedDatas.concat(e.selectedPublishedDatas);s.length>0&&async.eachSeries(e.selectedPublishedDatas,function(e,o){e.selected&&a.archiveProduct(e.p_id).then(function(e){return 200==e.statusCode&&e.response.success?(c.success(e.response.msg,"Success"),t++,o(),void 0):void c.error(e.response.msg,"Error")}),t==s.length&&r.reload()})})},e.draftSelected=function(){e.modal={title:"Draft Product?",message:"Are you sure to Draft this selected products?"},d.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=1;e.selectedDatas.length>0&&async.eachSeries(e.selectedDatas,function(s,o){s.selected&&a.draftProduct(s.p_id).then(function(e){return 200==e.statusCode&&e.response.success?(c.success(e.response.msg,"Success"),t++,o(),void 0):void c.error(e.response.msg,"Error")}),t==e.selectedDatas.length&&r.reload()})})},e.publishSelected=function(t){e.modal={title:"Publish Product?",message:"Are you sure to Publish this selected products?"},d.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=1,s=e.selectedDraftedDatas.concat(e.selectedArchivedDatas);s.length>0&&async.eachSeries(s,function(e,o){e.selected&&a.publishProduct(e.p_id).then(function(e){return 200==e.statusCode&&e.response.success?(c.success(e.response.msg,"Success"),t++,o(),void 0):void c.error(e.response.msg,"Error")}),t==s.length&&r.reload()})})}}angular.module("POS17").controller("productsController",e),e.$inject=["$scope","$http","$filter","$state","$timeout","toastr","productFactory","categoryFactory","ngTableParams","ngDialog","localStorageService","transLogFctry","$uibModal","tagsFactory"]}();
!function(){"use strict";function t(t,e,i,a,n){t.paginateNumber=0,t.pagination={currentPage:1,limitWithPage:10,totalPages:0,sumOfPages:0},t.auditlogs=[],t.generateActivityLogs=function(e){a.getProductAuditLog(e,{startWith:t.paginateNumber,limit:t.pagination.limitWithPage}).then(function(e){200==e.statusCode&&e.response.success&&(t.auditlogs=e.response.result,t.pagination.totalPages=e.response.pagination.results,t.pagination.sumOfPages=e.response.pagination.pages)})},n&&t.generateActivityLogs(n),t.addMoreItems=function(){t.paginateNumber=t.pagination.currentPage-1,n&&t.generateActivityLogs(n)},t.filterDate=function(){},t.cancel=function(){i.dismiss("cancel")}}angular.module("POS17").controller("productAuditLogModalCtrl",t),t.$inject=["$scope","$state","$uibModalInstance","productFactory","product_id"]}();
!function(){"use strict";function e(e,t,s,l,a,r,n,c,d,i,o,u,p,h){e.search={},e.currentPage=1,e.entryLimit=5,e.selectDeselectAll=!1,e.applicationStatus="All",e.filterStatus="Relevance",e.txtSearch="",e.selectedDatas=[],e.selectedPublishedDatas=[],e.selectedDraftedDatas=[],e.selectedArchivedDatas=[],e.viewby=25,e.pageSize=e.viewby,e.currentPage=1,e.itemsPerPage=20,e.totalUsers=0,e.tagsArr=[],e.tagsFilter=[],e.example8settings={showCheckAll:!1,showUncheckAll:!1,enableSearch:!0,scrollableHeight:"300px",scrollable:!0};var f=JSON.parse(u.get("user"));o.logTransaction("View Product Bundles","PRODUCT BUNDLES","ALL","User:="+f.username+" View ALL List of product bundles");var b=function(){e.productIsLoading=!0,e.bundles=[],e.bundlecopy=[],e.productBundleTable=new i({page:1,count:10},{counts:[10,25,50,100],getData:function(t,l){n.getAllProductBundle().then(function(a){if(200==a.statusCode&&a.response.success){var n=a.response.result;if(_.each(n,function(e){e.date_created=moment(e.date_created).format("YYYY-MM-DD")}),e.bundlecopy=angular.copy(n),e.txtSearch&&"All"==e.applicationStatus?e.bundles=s("filter")(n,e.txtSearch):e.txtSearch&&"Publish"==e.applicationStatus?(e.bundles=s("filter")(n,{is_published:1}),e.bundles=s("filter")(e.bundles,e.txtSearch)):e.txtSearch&&"Archived"==e.applicationStatus?(e.bundles=s("filter")(n,{is_archived:1}),e.bundles=s("filter")(e.bundles,e.txtSearch)):e.txtSearch&&"Draft"==e.applicationStatus?(e.bundles=s("filter")(n,{is_published:0}),e.bundles=s("filter")(e.bundles,e.txtSearch)):_.isUndefined(e.txtSearch)&&"All"==e.applicationStatus?e.bundles=n:_.isUndefined(e.txtSearch)&&"Publish"==e.applicationStatus?e.bundles=s("filter")(n,{is_published:1}):_.isUndefined(e.txtSearch)&&"Archived"==e.applicationStatus?e.bundles=s("filter")(n,{is_archived:1}):_.isUndefined(e.txtSearch)&&"Draft"==e.applicationStatus?e.bundles=s("filter")(n,{is_published:0}):e.bundles=n,"Most Viewed"==e.filterStatus?(e.bundles=s("orderBy")(e.bundles,"product_bundle_views",!0),e.bundles=_.filter(e.bundles,function(e){return parseInt(e.product_bundle_views)>0})):"Price: High to Low"==e.filterStatus?e.bundles=s("orderBy")(e.bundles,"sell_price",!0):"Price: Low to High"==e.filterStatus&&(e.bundles=s("orderBy")(e.bundles,"sell_price",!1)),e.tagsFilter&&e.tagsFilter.length>0){var c=[];_.each(e.tagsFilter,function(t){_.each(e.bundles,function(e){var s=_.find(e.tags,{tags_id:t.id});s&&c.push(e)})}),e.bundles=c}l.total(e.bundles.length);var d=e.bundles.slice((l.page()-1)*l.count(),l.page()*l.count());t.resolve(d),e.productIsLoading=!1}else e.productIsLoading=!1,r.error(a.response.msg,"Error")})}})};h.getAllTags().then(function(t){if(200==t.statusCode&&t.response.success){var s=t.response.result;_.each(s,function(t){e.tagsArr.push({id:t.tags_id,label:t.tags,_id:t._id})})}else r.error(t.response.msg,"Error")}),e.selectEvents={onItemSelect:function(t){e.productBundleTable.reload()},onItemDeselect:function(t){e.productBundleTable.reload()}},e.edit=function(e){l.go("main.products-add",{p_id:e})},e.searchData=function(){e.productBundleTable.reload()},e.refresh=function(){e.productIsLoading=!0,e.productBundleTable.reload()},e.updateStatus=function(t){e.applicationStatus=t,e.productBundleTable.reload()},e.updateFilterStatus=function(t){e.filterStatus=t,e.productBundleTable.reload()},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.bundles,function(t){t.selected=e.selectDeselectAll,e.selectSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.checkDataChanges=function(t){console.log(t),t.selected?_.find(e.selectedDatas,{pb_id:t.pb_id})||(e.selectedDatas.push(t),1==t.is_published&&0==t.is_archived&&e.selectedPublishedDatas.push(t),0==t.is_published&&0==t.is_archived&&e.selectedDraftedDatas.push(t),1==t.is_archived&&0==t.is_published&&e.selectedArchivedDatas.push(t)):(e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.pb_id!==t.pb_id}),e.selectedPublishedDatas=_.filter(e.selectedPublishedDatas,function(e){return e.pb_id!==product.pb_id}),e.selectedDraftedDatas=_.filter(e.selectedDraftedDatas,function(e){return e.pb_id!==product.pb_id}),e.selectedArchivedDatas=_.filter(e.selectedArchivedDatas,function(e){return e.pb_id!==product.pb_id})),e.deleteSomeData=e.selectedDatas.length>0},e.updateHistory=function(e){p.open({animation:!0,backdrop:"static",templateUrl:"./modules/products/bundles/bundle.auditlog.modal.html",controller:"productBundleAuditLogModalCtrl",size:"md",resolve:{pb_id:function(){return e}}})},e.toggleModal=function(t){d.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){n.archiveBundle(t).then(function(e){return 200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),void l.reload()):void r.error(e.response.msg,"Error")})})},e.archiveSelected=function(){d.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=1,s=e.selectedDraftedDatas.concat(e.selectedPublishedDatas);return s.length>0?void async.each(s,function(e,a){e.selected&&n.archiveBundle(e.pb_id).then(function(e){return 200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),t++,a(),void 0):void r.error(e.response.msg,"Error")}),t==s.length&&l.reload()}):void r.warning("Unable to Archive selected Bundle..Selected bundle are either archived","Warning")})},e.draftSelected=function(){e.modal={title:"Draft Product?",message:"Are you sure to Draft this selected bundle?"},d.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=1;e.selectedDatas.length>0&&async.eachSeries(e.selectedDatas,function(s,a){s.selected&&n.draftBundle(s.pb_id).then(function(e){return 200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),t++,a(),void 0):void r.error(e.response.msg,"Error")}),t==e.selectedDatas.length&&l.reload()})})},e.publishSelected=function(t){e.modal={title:"Publish Product?",message:"Are you sure to Publish this selected bundle?"},d.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=1,s=e.selectedDraftedDatas.concat(e.selectedArchivedDatas);s.length>0&&async.eachSeries(s,function(e,a){e.selected&&n.publishBundle(e.pb_id).then(function(e){return 200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),t++,a(),void 0):void r.error(e.response.msg,"Error")}),t==s.length&&l.reload()})})},b()}angular.module("POS17").controller("productBundlesController",e),e.$inject=["$scope","$http","$filter","$state","$timeout","toastr","productFactory","supplierFctry","ngDialog","ngTableParams","transLogFctry","localStorageService","$uibModal","tagsFactory"]}();
!function(){"use strict";function e(e,t,s,n,o,i,r,d,a,c,u,l,p,g,m,f){function h(t){_.each(e.list2,function(e){e.p_id==t.p_id&&(e.quantity=t.quantity)})}e.details={},e.ptypes={},e["package"]={},e.items={},e.list1=[],e.list2=[],e.productCopy=[],e.getSel=[],e.attributes=[],e.product_image=[],e.tags=[],e.tagsArr=[],e.details.tags=[],e.details.start_date=new Date,e.details.end_date=new Date,e.details.is_published=!1,e.details.is_archived=!1,e.isImageNew=!1,e.add=!1,e.displayComposite=!1,e.displayImage=!1,e.image=[],e.txtSearch="",e.myInterval=3e3,e.noWrapSlides=!1,e.activeSlide=0,e.thumbnailSize=5,e.thumbnailPage=1,e.slides=[],e.barcodeoptions={width:2,height:100,quite:10,displayValue:!0,font:"monospace",textAlign:"center",fontSize:12,backgroundColor:"",lineColor:"#000"},e.barcodesType=[{type:"ean",code:"EAN"},{type:"upc",code:"UPC"},{type:"code39",code:"Code39"},{type:"code128b",code:"Code128B"},{type:"code128c",code:"Code128c"},{type:"itf",code:"ITF"},{type:"itf14",code:"ITF14"}],e.mycode={},e.mycode.type="code128b";var y=JSON.parse(m.get("user"));o.pb_id?f.logTransaction("View Product Bundle Details","PRODUCT BUNDLES",o.pb_id,"User:="+y.username+" View product bundle details: ="+o.pb_id):f.logTransaction("Add New Product Bundle","PRODUCTS BUNDLES","N/A","User:="+y.username+" Add new product bundle entry");var b=function(){r.getAllProduct().then(function(t){200==t.statusCode&&t.response.success&&(e.productCopy=t.response.result,_.each(e.productCopy,function(t){t.selected=!1,0==t.is_archived&&e.list1.push(t)})),e.models=[{listName:"Package",items:e.list2,dragging:!1},{listName:"Products",items:e.list1,dragging:!1}]})};e.changeBarcodeType=function(t){g(function(){e.$apply(function(){e.mycode.type=t})},10)},e.refresh=function(){b()},e.searchData=function(t){e.list1=s("filter")(e.productCopy,t)},d.getAllProdType().then(function(t){200==t.statusCode&&t.response.success?e.ptypes=t.response.result:n.error(t.response.msg,"Error")}),l.getAllTags().then(function(t){200==t.statusCode&&t.response.success?e.tagsArr=t.response.result:n.error(t.response.msg,"Error")}),_.isEmpty(o.pb_id)?(e.showPublish=!1,e.showArchive=!1):(e.displayComposite=!0,e.displayImage=!0,r.getProductBundleDetails(o.pb_id).then(function(t){if(200==t.statusCode&&t.response.success){var s=0;e.details=t.response.result,e.items=t.response.result,e.product_image=e.details.product_images,_.each(e.product_image,function(t){e.slides.push({image:t.image_path,index:s}),s++}),_.each(e.details.products,function(t){var s=t.product_detail;s.quantity=_.isNull(t.quantity)?0:t.quantity,1!==s.is_archived&&e.list2.push(s)}),e.showPublish=1!=e.details.is_published,e.showArchive=0==e.details.is_archived,e.details.start_date=new Date(e.details.start_date),e.details.end_date=new Date(e.details.end_date),e.details.ptype_id=t.response.result.productType_id,e.details.is_published=e.IntToBoolean(e.details.is_published),e.details.is_archived=e.IntToBoolean(e.details.is_archived),l.getAllProductBundleTags(o.pb_id).then(function(t){200==t.statusCode&&t.response.success&&(e.details.tags=t.response.result)})}})),e.$watch("list2",function(t){e.list2=t,e.models=[{listName:"Package",items:e.list2,dragging:!1},{listName:"Products",items:e.list1,dragging:!1}]},!0),e.$watch("list1",function(t){e.list1=t,e.models=[{listName:"Package",items:e.list2,dragging:!1},{listName:"Products",items:e.list1,dragging:!1}]},!0),e.$watch("models",function(t){e.modelAsJson=t},!0),e.tagTransform=function(e){return{tags:e}},e.clearInput=function(e){e.search=""},e.deleteProductTags=function(e){console.log("deleteProductBundleTag: ",e),o.pb_id&&l.deleteProductBundleTag(o.pb_id,e.tags_id).then(function(e){return 200==e.statusCode&&e.response.success?void n.success(e.response.msg,"Success"):void n.error(e.response.msg,"Error")})},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.store_id===t.store_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.store_id!==t.store_id}),e.deleteSomeData=e.selectedDatas.length>0},e.remove=function(e,t){var s=_.findIndex(e.items,function(e){return e.p_id==t.p_id});return e.items.splice(s,1)},e.removeAll=function(e,t){_.each(e.items,function(t){return e.items.splice(e.items,1)})},e.openUploader=function(){var e=p.open({animation:!0,templateUrl:"./modules/products/bundles/product-bundle.upload.modal.html",controller:"productBundleUploaderModalCtrl",size:"lg",resolve:{product_bundle_id:function(){return o.pb_id}}});e.result.then(function(e){t.reload()})},e.IntToBoolean=function(e){return 1===e},e.BooleanToInt=function(e){return e===!0?1:0},e.archiveProduct=function(e){r.archiveBundle(e).then(function(e){200==e.statusCode&&e.response.success?(n.success(e.response.msg,"Success"),t.go(t.current,null,{reload:!0})):n.error(e.response.msg,"Error")})},e.publishProduct=function(e){r.publishBundle(e).then(function(e){200==e.statusCode&&e.response.success?(n.success(e.response.msg,"Success"),t.go(t.current,null,{reload:!0})):n.error(e.response.msg,"Error")})},e.addProductBundle=function(){o.pb_id&&(_.isUndefined(e.modelAsJson)||(e.items.products=_.map(e.modelAsJson[0].items,function(e){return{product_id:e.p_id,quantity:e.quantity}})),console.log(e.items),r.updateProductBundle(o.pb_id,e.items).then(function(e){200==e.statusCode&&e.response.success&&(n.success(e.response.msg,"Success"),t.go(t.current,{pb_id:o.pb_id},{reload:!0}))}))},e.addProduct=function(){async.waterfall([function(t){o.pb_id?r.updateProductBundle(o.pb_id,e.details).then(function(s){200==s.statusCode&&s.response.success?(n.success(s.response.msg,"Success"),e.items=e.details,t(null,o.pb_id)):(e.validate=s.response.result,_.each(e.validate,function(e){n.warning(s.response.msg,"Error - "+e.msg)}))}):r.saveProductBundle(e.details).then(function(s){200==s.statusCode&&s.response.success?(e.items=e.details,n.success(s.response.msg,"Success"),t(null,s.response.result)):(e.validate=s.response.result,_.each(e.validate,function(e){n.warning(s.response.msg,"Error - "+e.msg)}))})},function(t,s){var o=0;e.details.tags.length>0?async.eachSeries(e.details.tags,function(i,r){i.isTag?l.saveTags(i).then(function(e){return 200==e.statusCode&&e.response.success?(console.log("saveProductGroupTags bundle_id: ",t),void l.saveProductGroupTags(t,{tags_id:e.response.result}).then(function(e){return 200==e.statusCode&&e.response.success?(o++,void r()):void n.error(e.response.msg,"Error")})):void n.error(e.response.msg,"Error")}):l.saveProductGroupTags(t,{tags_id:i.tags_id}).then(function(e){return 200==e.statusCode&&e.response.success?(o++,void r()):void n.error(e.response.msg,"Error")}),o>=e.details.tags.length&&s(null,t)}):s(null,t)},function(e,s){g(function(){t.go(t.current,{pb_id:e},{reload:!0})},1e3)}])},e.getSelectedItemsIncluding=function(e,t){return t.selected=!0,e.items.filter(function(e){return e.selected})},e.onDrop=function(t,s,n){return _.each(s,function(s){s.selected=!1;var n=_.find(t.items,{p_id:s.p_id});if(_.isEmpty(n))s.quantity=1,e.$apply(function(){e.list2.push(s)});else{var o=_.indexOf(t.items,n);s.quantity=parseInt(n.quantity)+1,e.$apply(function(){t.items.splice(o,1,s)})}}),_.each(e.list1,function(e){e.selected=!1}),t.items=t.items.slice(0,n).concat(s).concat(t.items.slice(n)),!0},e.callMyFunction=function(e,t){if("Products"==t)return e.selected=!e.selected},e.onMoved=function(e){e.items=e.items.filter(function(e){return!e.selected})},e.onDragstart=function(e,t){if(e.dragging=!0,t.dataTransfer.setDragImage){new Image}},e.dropCallback=function(e,t,s){},e.deleteAllMedia=function(){i.openConfirm({templateUrl:"modules/dialog/deleteAllDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){o.pb_id&&r.deleteAllProductBundleImage(o.pb_id).then(function(e){return 200==e.statusCode&&e.response.success?(n.success(e.response.msg,"Success"),void t.reload()):void n.error(e.response.msg,"Error")})})},e.deleteSelected=function(s){i.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){console.log("media: ",s),o.pb_id&&r.deleteProductBundleImageFile(o.pb_id,s._id).then(function(e){return 200==e.statusCode&&e.response.success?(n.success(e.response.msg,"Success"),void t.reload()):void n.error(e.response.msg,"Error")})})},e.minusbutton=function(e){e.quantity<1?(e.quantity=0,h(e)):(e.quantity--,h(e))},e.addbutton=function(e){e.quantity++,h(e)},e.refresh()}angular.module("POS17").controller("productsBundleController",e),e.$inject=["$scope","$state","$filter","toastr","$stateParams","ngDialog","productFactory","ptypeFactory","storeFactory","priceHistoryFactory","supplierFctry","tagsFactory","$uibModal","$timeout","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,o,l,t,a,n,r,c,s,i,u,d,p){console.log("productBundleUploaderModalCtrl"),console.log("$stateParams:",i.pb_id),e.item={};var m=JSON.parse(u.get("user")),g=e.uploader=new l({url:t+a+"product-bundle/"+n+"/upload-image",method:"PUT",headers:{Authorization:"Bearer "+c.getUserToken(),accesskey:m.subscriptionKey}});console.log("uploader:",g),g.filters.push({name:"imageFilter",fn:function(e,o){var l="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return"|jpg|png|jpeg|bmp|gif|".indexOf(l)!==-1}}),g.onBeforeUploadItem=function(e){e.alias="pb_image"},g.onCompleteAll=function(e){p.success("Media / File upload complete","Success"),d(function(){o.close(n)},1300)},e.cancel=function(){o.dismiss("cancel")}}angular.module("POS17").controller("productBundleUploaderModalCtrl",e),e.$inject=["$scope","$uibModalInstance","FileUploader","API_URL","API_VERSION","product_bundle_id","Upload","AuthFctry","jwtHelper","$stateParams","localStorageService","$timeout","toastr"]}();
!function(){"use strict";function e(e,t,r,o,s,a,c,n,l){e.categ={repeatSelect:null,availableOptions:[]},e.categories=[],e.prodBundleCategories=[],e.itemArray=[],e.selectedCategory=[],e.store={},e.applicationStatus="",e.getAllCategory=function(){async.waterfall([function(t){n.getAllCategory().then(function(r){200==r.statusCode&&r.response.success?(e.categ.availableOptions=r.response.result,e.categories=angular.copy(e.categ.availableOptions),t(null,e.categories)):c.error(r.response.msg,"Error")})},function(t,r){s.pb_id?l.getProductBundleCategory(s.pb_id).then(function(r){200==r.statusCode&&r.response.success&&r.response.result.length>0?(e.prodBundleCategories=r.response.result,_.each(e.categories,function(t){var r=_.find(e.prodBundleCategories,function(e){return t.c_id===e.fk_bundle_category_id});r&&(t.selected=!0,t.fk_bundle_category_id=r.fk_bundle_category_id,t.fk_product_bundle_id=s.pb_id,e.selectedCategory.push(t))}),e.itemArray=angular.copy(e.categories)):200==r.statusCode&&r.response.success&&0===r.response.result.length?e.itemArray=angular.copy(t):c.error(r.response.msg,"Error")}):e.itemArray=angular.copy(t)}])},e.getAllCategory(),e.paginate=function(){$("#tblCategory").trigger("footable_redraw")},e.changeSelectDeselectAll=function(){_.each(e.itemArray,function(t){t.selected=e.selectDeselectAll,e.checkStoresChanges(t)})},e.checkStoresChanges=function(t){if(t.selected){var r=_.find(e.selectedCategory,function(e){return e.c_id===t.c_id});_.isUndefined(r)&&(t.fk_bundle_category_id=t.c_id,t.fk_product_bundle_id=s.p_id,e.selectedCategory.push(t)),console.log("$scope.selectedCategory:",e.selectedCategory)}else e.selectedCategory=_.filter(e.selectedCategory,function(e){return e.c_id!==t.c_id})},e.updateStatus=function(t){e.applicationStatus=t,""===t?e.itemArray=angular.copy(e.categories):(e.itemArray.splice(0,e.itemArray.length),_.each(e.categories,function(t){_.find(e.selectedCategory,function(e){return t.c_id===e.fk_bundle_category_id})&&e.itemArray.push(t)}))},e.searchStore=function(){if(e.txtSearch){e.itemArray.splice(0,e.itemArray.length);var t=a("filter")(e.categories,e.txtSearch);e.itemArray=angular.copy(t)}},e.searchStatus=function(){""===e.txtSearch&&(e.itemArray.splice(0,e.itemArray.length),e.itemArray=angular.copy(e.categories))},e.saveproductBundleCategory=function(){var t=0;s.pb_id&&(console.log("$stateParams.pb_id:",s.pb_id),async.waterfall([function(e){l.deleteProductBundleCategory(s.pb_id).then(function(t){200==t.statusCode&&t.response.success?(console.log("Na delete"),e(null,t.response.result)):e(t.response.msg,null)})},function(r,a){_.each(e.selectedCategory,function(r){console.log("selectedCategory: ",r),l.saveProductBundleCategory(s.pb_id,{category_id:r.c_id}).then(function(s){200===s.statusCode&&s.response.success?(c.success(r.name+" - "+s.response.msg,"Success"),t++,t===e.selectedCategory.length&&o.reload()):c.error(s.response.msg,"Error")})})}]))}}angular.module("POS17").controller("productBundleCategoryCtrl",e),e.$inject=["$scope","$rootScope","$timeout","$state","$stateParams","$filter","toastr","categoryFactory","productFactory"]}();
!function(){"use strict";function e(e,t,n,s,o,l,r,c,d){e.selectDeselectAllRelation=!1,e.selectedDatas=[],e.probundles=[],e.probundlesCopy=[],e.relatedProducts=[],n.getAllProductBundle().then(function(t){200==t.statusCode&&t.response.success&&(e.probundles=t.response.result,e.probundlesCopy=angular.copy(e.probundles))}),e.getAllRelatedBundles=function(){e.relatedProducts=[],l.pb_id&&s.getAllRelatedBundle(l.pb_id).then(function(t){200==t.statusCode&&t.response.success&&(e.relatedProducts=t.response.result)})},e.getAllRelatedBundles(),e.changeSelectDeselectAllRelated=function(){_.each(e.relatedProducts,function(t){t.selected=e.selectDeselectAllRelation,e.checkRelationChanges(t)})},e.checkRelationChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.rel_id===t.rel_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.rel_id!==t.rel_id}),e.deleteSomeData=e.selectedDatas.length>0},e.addNewEntry=function(){var n=r.open({animation:!0,templateUrl:"./modules/products/related.bundle.modal.html",controller:"productBundleRelatedModalCtrl",size:"lg",resolve:{products:function(){return e.probundles},product:function(){return l.pb_id}}});n.result.then(function(e){t.reload()})},e.openRelationType=function(){var e=r.open({animation:!0,templateUrl:"./modules/products/relation.type.modal.html",controller:"relationTypeCtrl",size:"lg"});e.result.then(function(e){t.reload()})},e.deleteSelectedRelated=function(){e.modal={title:"Archive Product?",message:"Are you sure to archive this selected products?"},c.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var n=1;e.selectedDatas.length>0&&async.eachSeries(e.selectedDatas,function(r,c){r.selected&&s.deleteRelatedBundle(l.pb_id,r.rel_id).then(function(e){return 200==e.statusCode&&e.response.success?(o.success(e.response.msg,"Success"),n++,c(),void 0):void o.error(e.response.msg,"Error")}),n==e.selectedDatas.length&&t.reload()})})},e.deleteSelected=function(n){e.modal={title:"Delete Product Relation?",message:"Are you sure to delete this selected product relation?"},c.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){s.deleteRelatedBundle(l.pb_id,n).then(function(e){return 200==e.statusCode&&e.response.success?(o.success(e.response.msg,"Success"),void d(function(){t.reload()},300)):void o.error(e.response.msg,"Error")})})}}function t(e,t,n,s,o,l,r,c){e.relation={},e.relationtypes=[],e.relatedProducts=[],e.infiniteScrollContacts={},e.infiniteScrollContacts.numToAdd=10,e.infiniteScrollContacts.currentItems=10,o.getAllRelationType().then(function(t){200==t.statusCode&&t.response.success?e.relationtypes=t.response.result:n.error(t.response.msg,"Error")}),_.isUndefined(r)||(e.relation={},e.selected={},e.relatedProducts=[],e.relatedProducts=l,e.relation.product_id=r),e.resetInfScroll=function(){e.infiniteScrollContacts.currentItems=e.infiniteScrollContacts.numToAdd},e.addMoreItems=function(){e.infiniteScrollContacts.currentItems+=e.infiniteScrollContacts.numToAdd},e.saveEntry=function(){return e.relation.ref_id=e.relation.bundle.pb_id,_.isUndefined(e.relation.ref_id)?void n.warning("Unable to saved related bundles. Please provide Bundle and Relation Type","Warning"):void o.saveRelatedBundle(r,e.relation).then(function(e){if(200==e.statusCode&&e.response.success)n.success(e.response.msg,"Success"),c(function(){t.close()},600);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void n.error(e.response.msg,"Error");_.each(e.response.result,function(e){n.warning(e.msg,"Warning")})}})},e.cancel=function(){t.dismiss("cancel")}}angular.module("POS17").controller("productBundleRelatedCtrl",e).controller("productBundleRelatedModalCtrl",t),e.$inject=["$scope","$state","productFactory","relatedProductFactory","toastr","$stateParams","$uibModal","ngDialog","$timeout"],t.$inject=["$scope","$uibModalInstance","toastr","productFactory","relatedProductFactory","products","product","$timeout"]}();
!function(){"use strict";function e(e,t,s,i,u,r,o,n,a,l,c,d){e.attributes=[],e.attribute_values=[],e.$watch(function(){return e.details},function(t){e.getAllProductAttributes()}),e.getAllProductAttributes=function(){e.details.doc=d.get("visibility"),async.waterfall([function(t){l.getAttributeMapping(e.details.product_type_id).then(function(e){if(200==e.statusCode&&e.response.success){var s=e.response.result;t(null,s)}else i.error(e.response.msg,"Error")})},function(e,t){n.getProductBundleAttributes(r.pb_id).then(function(s){if(200==s.statusCode&&s.response.success){var u=s.response.result;t(null,e,u)}else i.error(s.response.msg,"Error")})},function(e,t,s){c.getAllCategory().then(function(u){if(200==u.statusCode&&u.response.success){var r=u.response.result;s(null,e,t,r)}else i.error(u.response.msg,"Error")})},function(e,t,s,u){n.getProductBundleCategory(r.pb_id).then(function(r){if(200==r.statusCode&&r.response.success){var o=r.response.result,n=[];_.each(s,function(e){var t=_.find(o,function(t){return e.c_id===t.fk_category_id});t&&n.push(e)}),u(null,e,t,n)}else i.error(r.response.msg,"Error")})},function(t,s,i,u){var r=[];if(_.each(t,function(e){var t=_.filter(i,{c_id:e.fk_c_id});t&&t.length>0&&r.push(e)}),r&&r.length>0){var o=_.map(r,function(e){return e.attributes});_.each(o,function(e){var t=_.find(s.attribute_values,{att_id:e.att_id}),i=_.find(s.attribute_value_list,{att_id:e.att_id});t?(e.unique_id=t._id,e.value=t.value):(e.value=null,e.unique_id=null),i?e.attribute_list_value=i.attribute_list:e.attribute_list_value=[]}),e.attributes=o}else{var o=_.map(t,function(e){return e.attributes});_.each(o,function(e){var t=_.find(s.attribute_values,{att_id:e.att_id}),i=_.find(s.attribute_value_list,{att_id:e.att_id});t?(e.unique_id=t._id,e.value=t.value):(e.value=null,e.unique_id=null),i?e.attribute_list_value=i.attribute_list:e.attribute_list_value=[]}),e.attributes=o}_.each(e.attributes,function(e){"Checkbox"==e.attribute_type&&(console.log("row:",e),"1"==e.value?e.checked=!0:e.checked=!1)})}])},e.deleteAttributeValue=function(s){console.log("attribute: ",s),_.isUndefined(s.value)?i.warning("Unable to save no attribute value","Warning"):o.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){console.log("Delete"),a.deleteAttributeValues(s.att_id,s.unique_id).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.reload()):i.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},e.saveShow=function(){if(e.details.doc){var s={product_id:r.p_id,is_show:1};d.set("visibility",!0),a.updateAttributeVisibility(s).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.reload()):i.error(e.response.msg,"Error")})}else{var u={product_id:r.p_id,is_show:0};d.set("visibility",!1),a.updateAttributeVisibility(u).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.reload()):i.error(e.response.msg,"Error")})}},e.saveAttributeValue=function(s){if(console.log("attribute: ",s),e.modal={title:"Confirm attribute",message:"Are you sure to save attribute?"},"Checkbox"==s.attribute_type){console.log("diri:",s.checked);var u={product_id:null,bundle_id:r.pb_id,attribute_id:s.att_id,article_id:null,value:s.checked,value_image:null,name:s.name,description:"",is_single:0,is_image:0,is_video:0,is_audio:0}}else{console.log("diri:");var u={product_id:null,bundle_id:r.pb_id,attribute_id:s.att_id,article_id:null,value:s.value,value_image:null,name:s.name,description:"",is_single:0,is_image:0,is_video:0,is_audio:0}}_.isUndefined(s.value)?i.warning("Unable to save no attribute value","Warning"):o.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){_.isNull(s.unique_id)?(console.log("Save New"),console.log("value1s",u),a.saveAttributeValues(s.att_id,u).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.reload()):i.error(e.response.msg,"Error")})):(console.log("Updated"),console.log("values",u),a.updateAttributeValues(s.att_id,s.unique_id,u).then(function(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),t.reload()):i.error(e.response.msg,"Error")}))},function(e){console.log("Modal promise close: ")})}}angular.module("POS17").controller("productBundleAttributesCtrl",e),e.$inject=["$scope","$state","$filter","toastr","$timeout","$stateParams","ngDialog","productFactory","attributeFactory","ptypeFactory","categoryFactory","localStorageService"]}();
!function(){"use strict";function t(t,e,i,n,a){t.paginateNumber=0,t.pagination={currentPage:1,limitWithPage:10,totalPages:0,sumOfPages:0},t.auditlogs=[],t.generateActivityLogs=function(e){n.getProductBundleAuditLog(e,{startWith:t.paginateNumber,limit:t.pagination.limitWithPage}).then(function(e){200==e.statusCode&&e.response.success&&(t.auditlogs=e.response.result,t.pagination.totalPages=e.response.pagination.results,t.pagination.sumOfPages=e.response.pagination.pages)})},a&&t.generateActivityLogs(a),t.addMoreItems=function(){t.paginateNumber=t.pagination.currentPage-1,a&&t.generateActivityLogs(a)},t.filterDate=function(){},t.cancel=function(){i.dismiss("cancel")}}angular.module("POS17").controller("productBundleAuditLogModalCtrl",t),t.$inject=["$scope","$state","$uibModalInstance","productFactory","pb_id"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(a,t){t.state("main.analytics-overview",{url:"/analytics/overview",templateUrl:"modules/analytics/chartjs.html"}).state("main.analytics-appoverview",{url:"/analytics/appoverview",templateUrl:"modules/analytics/inline.html"}).state("main.analytics-behavior",{url:"/analytics/behavior",templateUrl:"modules/analytics/flot.html"}).state("main.analytics-audience",{url:"/analytics/audience",templateUrl:"modules/analytics/morris.html"})}])}();
!function(){"use strict";function t(t,a,o){t.$log=a,t.data=[],t.myChartOptions={grid:{borderColor:"#f3f3f3",borderWidth:1,tickColor:"#f3f3f3"},series:{shadowSize:0,color:"#3c8dbc"},lines:{fill:!0,color:"#3c8dbc"},yaxis:{min:0,max:100,show:!0},xaxis:{show:!0}},t.totalPoints=100,t.updateInterval=500,t.realtime=1,t.getRandomData=function(){for(t.data.length>0&&(t.data=t.data.slice(1));t.data.length<t.totalPoints;){var a=t.data.length>0?t.data[t.data.length-1]:50,o=a+10*Math.random()-5;o<0?o=0:o>100&&(o=100),t.data.push(o)}for(var e=[],r=0;r<t.data.length;++r)e.push([r,t.data[r]]);return e},t.update=function(){t.data=[t.getRandomData()],1==t.realtime&&setTimeout(t.update,t.updateInterval)}}function a(t){for(var a=[],o=[],e=0;e<14;e+=.5)a.push([e,Math.sin(e)]),o.push([e,Math.cos(e)]);var r={data:a,color:"#3c8dbc"},i={data:o,color:"#00c0ef"};t.myData=[r,i],t.myChartOptions={grid:{hoverable:!0,borderColor:"#f3f3f3",borderWidth:1,tickColor:"#f3f3f3"},series:{shadowSize:0,lines:{show:!0},points:{show:!0}},lines:{fill:!1,color:["#3c8dbc","#f56954"]},yaxis:{show:!0},xaxis:{show:!0}}}function o(t){var a=[[2,88],[3,93.3],[4,102],[5,108.5],[6,115.7],[7,115.6],[8,124.6],[9,130.3],[10,134.3],[11,141.4],[12,146.5],[13,151.7],[14,159.9],[15,165.4],[16,167.8],[17,168.7],[18,169.5],[19,168]];t.myData=[a],t.myChartOptions={grid:{borderWidth:0},series:{shadowSize:0,color:"#00c0ef"},lines:{fill:!0},yaxis:{show:!1},xaxis:{show:!1}}}function e(t){t.myData=[{data:[["January",10],["February",8],["March",4],["April",13],["May",17],["June",9]],color:"#3c8dbc"}],t.myChartOptions={grid:{borderWidth:1,borderColor:"#f3f3f3",tickColor:"#f3f3f3"},series:{bars:{show:!0,barWidth:.5,align:"center"}},xaxis:{mode:"categories",tickLength:0}}}function r(t){function a(t,a){return"<div style='font-size:13px; text-align:center; padding:2px; color: #fff; font-weight: 600;'>"+t+"<br/>"+Math.round(a.percent)+"%</div>"}t.myData=[{label:"Series2",data:30,color:"#3c8dbc"},{label:"Series3",data:20,color:"#0073b7"},{label:"Series4",data:50,color:"#00c0ef"}],t.myChartOptions={series:{pie:{show:!0,radius:1,innerRadius:.5,label:{show:!0,radius:2/3,formatter:a,threshold:.1}}},legend:{show:!1}}}angular.module("POS17").controller("FlotInteractive",t).controller("FlotLineChart",a).controller("FlotAreaChart",o).controller("FlotBarChart",e).controller("FlotDonutChart",r),t.$inject=["$scope","$log","$element"],a.$inject=["$scope"],o.$inject=["$scope"],e.$inject=["$scope"],r.$inject=["$scope"]}();
!function(){"use strict";function e(e,o){e.labels=["January","February","March","April","May","June","July"],e.series=["Series A","Series B"],e.data=[[65,59,80,81,56,55,40],[28,48,40,19,86,27,90]],e.onClick=function(e,o){console.log(e,o)},e.onHover=function(e){e.length>0?console.log("Point",e[0].value):console.log("No point")},o(function(){e.labels=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],e.data=[[28,48,40,19,86,27,90],[65,59,80,81,56,55,40]],e.series=["Series C","Series D"]},3e3)}function o(e,o){e.options={scaleShowVerticalLines:!1},e.labels=["2006","2007","2008","2009","2010","2011","2012"],e.series=["Series A","Series B"],e.data=[[65,59,80,81,56,55,40],[28,48,40,19,86,27,90]],o(function(){e.options={scaleShowVerticalLines:!0}},3e3)}function l(e,o){e.labels=["Download Sales","In-Store Sales","Mail-Order Sales"],e.data=[0,0,0],o(function(){e.data=[350,450,100]},500)}function a(e){e.labels=["Download Sales","In-Store Sales","Mail Sales"],e.data=[300,500,100]}function n(e){e.labels=["Download Sales","In-Store Sales","Mail Sales","Telesales","Corporate Sales"],e.data=[300,500,100,40,120]}angular.module("POS17").controller("LineCtrl",e).controller("BarCtrl",o).controller("DoughnutCtrl",l).controller("PieCtrl",a).controller("PolarAreaCtrl",n),e.$inject=["$scope","$timeout"],o.$inject=["$scope","$timeout"],l.$inject=["$scope","$timeout"],a.$inject=["$scope"],n.$inject=["$scope"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(l,m){m.state("main.mailbox",{url:"/mailbox/overview",templateUrl:"modules/mailbox/mailbox.html"}).state("main.mailbox-compose",{url:"/mailbox/compose",templateUrl:"modules/mailbox/compose.html"}).state("main.mailbox-read",{url:"/mailbox/read",templateUrl:"modules/mailbox/read-mail.html"})}])}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,e){e.state("main.settings-stores",{url:"/settings/stores",templateUrl:"modules/stores/stores.html",controller:"storesController"}).state("main.settings-stores-add",{url:"/settings/stores/:store_id",templateUrl:"modules/stores/store.detail.html",controller:"storesDetailController"})}])}();
!function(){"use strict";function e(e,t,s,o,r,l,n,c,a,i,u){e.selectDeselectAll=!1,e.selectedDatas=[];var d=JSON.parse(i.get("user"));u.logTransaction("View Store List","STORES","ALL","User:="+d.username+" View all list of Stores");var g=function(){e.storeisLoading=!0,e.stores=[],e.storescopy=[],e.storeTable=new a({page:1,count:10},{counts:[10,25,50,100],getData:function(t,o){n.getAllStore().then(function(l){if(200==l.statusCode&&l.response.success){var n=l.response.result;if(e.storescopy=angular.copy(e.stores),e.txtSearch){e.stores=s("filter")(n,e.txtSearch),o.total(e.stores.length);var c=e.stores.slice((o.page()-1)*o.count(),o.page()*o.count());t.resolve(c)}else{e.stores=n,o.total(e.stores.length);var c=e.stores.slice((o.page()-1)*o.count(),o.page()*o.count());t.resolve(c)}e.storeisLoading=!1}else e.storeisLoading=!1,r.error(l.response.msg,"Error")})}})};e.edit=function(e){o.go("main.settings-stores-add",{store_id:e})},e.searchData=function(){e.storeTable.reload()},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.stores,function(t){t.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.refresh=function(){e.storeTable.reload()},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.store_id===t.store_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.store_id!==t.store_id}),e.deleteSomeData=e.selectedDatas.length>0},e.toggleModal=function(t){l.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){n.deleteStore(t).then(function(e){return 200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),void o.reload()):void r.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},e.onDrop=function(e,t,s){return angular.forEach(t,function(e){e.selected=!1}),e.items=e.items.slice(0,s).concat(t).concat(e.items.slice(s)),!0},e.onMoved=function(e){e=e.items.filter(function(e){return!e.selected})},e.deleteSelected=function(){l.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=0;async.each(e.selectedDatas,function(s,l){s.selected&&(console.log("store: ",s),n.deleteStore(s.store_id).then(function(s){return console.log("data: ",s.response),200==s.statusCode&&s.response.success?(r.success(s.response.msg,"Success"),++t,t==e.selectedDatas.length&&o.reload(),l(),void 0):void r.error(s.response.msg,"Error")}))})})},g()}angular.module("POS17").controller("storesController",e),e.$inject=["$scope","$http","$filter","$state","toastr","ngDialog","storeFactory","$timeout","ngTableParams","localStorageService","transLogFctry"]}();
!function(){"use strict";function s(s,e,r,t,o,n,a,i,u,c,d){s.details={},s.details.tags=[],s.tagsArr=[];var l=JSON.parse(c.get("user"));t.store_id?d.logTransaction("View Store Details","STORES",t.store_id,"User:="+l.username+" View store details:="+t.store_id):d.logTransaction("Add New Store","STORES","N/A","User:="+l.username+" Add new store entry"),u.getAllTags().then(function(e){200==e.statusCode&&e.response.success?s.tagsArr=e.response.result:a.error(e.response.msg,"Error")}),t.store_id&&i.getStoreDetails(t.store_id).then(function(e){200==e.statusCode&&e.response.success&&(s.details=e.response.result,u.getAllStoreTags(t.store_id).then(function(e){200==e.statusCode&&e.response.success&&(s.details.tags=e.response.result)}))}),s.deleteProductTags=function(s){t.store_id&&u.deleteStoreTag(t.store_id,s.tags_id).then(function(s){return 200==s.statusCode&&s.response.success?void a.success(s.response.msg,"Success"):void a.error(s.response.msg,"Error")})},s.tagTransform=function(s){return{tags:s}},s.clearInput=function(s){s.search=""},s.saveStore=function(){async.waterfall([function(e){t.store_id?i.updateStore(t.store_id,s.details).then(function(s){if(200==s.statusCode&&s.response.success)a.success(s.response.msg,"Success"),e(null,t.store_id);else{if(400!==s.statusCode||s.response.success||!_.isArray(s.response.result))return void a.error(s.response.msg,"Error");_.each(s.response.result,function(s){a.warning(s.msg,"Warning")})}}):i.saveStore(s.details).then(function(s){if(console.log("data:",s),200==s.statusCode&&s.response.success)a.success(s.response.msg,"Success"),e(null,s.response.result);else{if(400!==s.statusCode||s.response.success||!_.isArray(s.response.result))return void a.error(s.response.msg,"Error");_.each(s.response.result,function(s){a.warning(s.msg,"Warning")})}})},function(e,r){var t=1;s.details.tags.length>0?async.eachSeries(s.details.tags,function(o,n){o.isTag?u.saveTags(o).then(function(s){return 200==s.statusCode&&s.response.success?void u.saveStoreTags(e,{tag_id:s.response.result}).then(function(s){return 200==s.statusCode&&s.response.success?(t++,void n()):void a.error(s.response.msg,"Error")}):void a.error(s.response.msg,"Error")}):u.saveStoreTags(e,{tag_id:o.tags_id}).then(function(s){return 200==s.statusCode&&s.response.success?(t++,void n()):void a.error(s.response.msg,"Error")}),t>=s.details.tags.length&&r(null,e)}):r(null,e)},function(s,e){o(function(){n.go(n.current,{store_id:s},{reload:!0})},300)}])}}angular.module("POS17").controller("storesDetailController",s),s.$inject=["$scope","$http","$filter","$stateParams","$timeout","$state","toastr","storeFactory","tagsFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,n){n.state("main.settings-banks",{url:"/settings/banks",templateUrl:"modules/banks/banks.html",controller:"banksController"}).state("main.settings-banks-add",{url:"/settings/banks/:bk_id",templateUrl:"modules/banks/bank.detail.html",controller:"bankDetailsController"})}])}();
!function(){"use strict";function e(e,t,a,s,n,l,c,o,r,i,d){e.selectDeselectAll=!1,e.selectedDatas=[];var u=JSON.parse(i.get("user"));d.logTransaction("View Banks","BANKS","ALL","User:="+u.username+" View all list of banks");var g=function(){e.bankisLoading=!0,e.banks={},e.bankscopy=[],e.bankTable=new r({page:1,count:10},{counts:[10,25,50,100],getData:function(t,s){c.getAllBanks().then(function(n){if(200==n.statusCode&&n.response.success){var c=n.response.result;if(e.bankscopy=angular.copy(e.banks),e.txtSearch){e.banks=a("filter")(c,e.txtSearch),s.total(e.banks.length);var o=e.banks.slice((s.page()-1)*s.count(),s.page()*s.count());t.resolve(o)}else{e.banks=c,s.total(e.banks.length);var o=e.banks.slice((s.page()-1)*s.count(),s.page()*s.count());t.resolve(o)}e.bankisLoading=!1}else e.bankisLoading=!1,l.error(n.response.msg,"Error")})}})};e.refresh=function(){e.bankTable.reload()},e.edit=function(e){s.go("main.settings-banks-add",{bk_id:e})},e.searchData=function(){e.bankTable.reload()},e.paginate=function(){$(".table").trigger("footable_redraw")},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.banks,function(t){t.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.bk_id===t.bk_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.bk_id!==t.bk_id}),e.deleteSomeData=e.selectedDatas.length>0},e.deleteSelected=function(){n.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=0;async.each(e.selectedDatas,function(a,n){a.selected&&(console.log("bank: ",a),c.deleteBank(a.bk_id).then(function(a){return console.log("data: ",a.response),200==a.statusCode&&a.response.success?(l.success(a.response.msg,"Success"),++t,t==e.selectedDatas.length&&s.reload(),n(),void 0):void l.error(a.response.msg,"Error")}))})})},g()}angular.module("POS17").controller("banksController",e),e.$inject=["$scope","$http","$filter","$state","ngDialog","toastr","bankFctry","$timeout","ngTableParams","localStorageService","transLogFctry"]}();
!function(){"use strict";function s(s,e,r,n,t,o,a,i,u,c){s.details={},s.details.tags=[],s.tagsArr=[];var d=JSON.parse(u.get("user"));r.bk_id?c.logTransaction("View Bank Details","BANKS",r.bk_id,"User:="+d.username+" View bank details:="+r.bk_id):c.logTransaction("Add New Bank","BANKS","N/A","User:="+d.username+" Add new bank entry"),i.getAllTags().then(function(e){200==e.statusCode&&e.response.success?s.tagsArr=e.response.result:o.error(e.response.msg,"Error")}),r.bk_id&&a.getBankDetails(r.bk_id).then(function(e){200==e.statusCode&&e.response.success&&(s.details=e.response.result,i.getAllBankTags(r.bk_id).then(function(e){200==e.statusCode&&e.response.success&&(s.details.tags=e.response.result)}))}),s.saveBank=function(){async.waterfall([function(e){r.bk_id?a.updateBank(r.bk_id,s.details).then(function(s){return 200==s.statusCode&&s.response.success?(o.success(s.response.msg,"Success"),void e(null,r.bk_id)):400===s.statusCode&&!s.response.success&&_.isArray(s.response.result)?void _.each(s.response.result,function(s){o.warning(s.msg,"Warning")}):void o.error(s.response.msg,"Error")}):a.saveBank(s.details).then(function(s){return 200==s.statusCode&&s.response.success?(o.success(s.response.msg,"Success"),void e(null,s.response.result)):400===s.statusCode&&!s.response.success&&_.isArray(s.response.result)?void _.each(s.response.result,function(s){o.warning(s.msg,"Warning")}):void o.error(s.response.msg,"Error")})},function(e,r){var n=0;async.eachSeries(s.details.tags,function(t,a){t.isTag?i.saveTags(t).then(function(s){return 200==s.statusCode&&s.response.success?void i.saveBankTags(e,{tag_id:s.response.result}).then(function(s){return 200==s.statusCode&&s.response.success?(n++,void a()):void o.error(s.response.msg,"Error")}):void o.error(s.response.msg,"Error")}):i.saveBankTags(e,{tag_id:t.tags_id}).then(function(s){return 200==s.statusCode&&s.response.success?(n++,void a()):void o.error(s.response.msg,"Error")}),n>=s.details.tags.length&&r(null,e)})},function(s,e){t(function(){n.go(n.current,{bk_id:s},{reload:!0})},300)}])},s.deleteProductTags=function(s){r.bk_id&&i.deleteBankTag(r.bk_id,s.tags_id).then(function(s){return 200==s.statusCode&&s.response.success?void o.success(s.response.msg,"Success"):void o.error(s.response.msg,"Error")})},s.tagTransform=function(s){return{tags:s}},s.clearInput=function(s){s.search=""}}angular.module("POS17").controller("bankDetailsController",s),s.$inject=["$scope","$http","$stateParams","$state","$timeout","toastr","bankFctry","tagsFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,e){e.state("main.settings-attributes",{url:"/settings/attributes",templateUrl:"modules/attributes/attributes.html",controller:"attributesController"}).state("main.settings-attributes-groups",{url:"/settings/attributegroups",templateUrl:"modules/attributes/attributes.groups.html",controller:"attributeGroups"}).state("main.settings-attributes-types",{url:"/settings/attributetypes",templateUrl:"modules/attributes/attributes.types.html",controller:"attributeTypes"}).state("main.settings-attributes-add",{url:"/settings/attributes/:att_id",templateUrl:"modules/attributes/attribute.detail.html",controller:"attributeDetailsController"})}])}();
!function(){"use strict";function e(e,t,a,s,o,l,n,r,c){e.selectDeselectAll=!1,e.selectedDatas=[];var i=function(){e.attribisLoading=!0,e.attribute=[],e.attributecopy=[],e.attributeTable=new c({page:1,count:25},{counts:[25,50,75,100],getData:function(t,s){n.getAllAttribute().then(function(o){if(200==o.statusCode&&o.response.success){var n=o.response.result;if(e.attributecopy=angular.copy(e.attribute),e.txtSearch){e.attribute=a("filter")(n,e.txtSearch),s.total(e.attribute.length);var r=e.attribute.slice((s.page()-1)*s.count(),s.page()*s.count());t.resolve(r)}else{e.attribute=n,s.total(e.attribute.length);var r=e.attribute.slice((s.page()-1)*s.count(),s.page()*s.count());t.resolve(r)}e.attribisLoading=!1}else e.attribisLoading=!1,l.error(o.response.msg,"Error")})}})};e.refresh=function(){e.attributeTable.reload()},e.edit=function(e){s.go("main.settings-attributes-add",{att_id:e})},e.searchData=function(){e.attributeTable.reload()},e.paginate=function(){$(".table").trigger("footable_redraw")},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.attribute,function(t){t.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.att_id===t.att_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.att_id!==t.att_id}),e.deleteSomeData=e.selectedDatas.length>0},e.toggleModal=function(t){o.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){n.deleteAttribute(t).then(function(e){return 200==e.statusCode&&e.response.success?(l.success(e.response.msg,"Success"),void s.reload()):void l.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},e.deleteSelected=function(){o.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=0;async.each(e.selectedDatas,function(a,o){a.selected&&(console.log("attribute: ",a),n.deleteAttribute(a.att_id).then(function(a){return console.log("data: ",a.response),200==a.statusCode&&a.response.success?(l.success(a.response.msg,"Success"),++t,t==e.selectedDatas.length&&s.reload(),o(),void 0):void l.error(a.response.msg,"Error")}))})})},i()}angular.module("POS17").controller("attributesController",e),e.$inject=["$scope","$http","$filter","$state","ngDialog","toastr","attributeFactory","$timeout","ngTableParams"]}();
!function(){"use strict";function t(t,e,i,a,s,r,n,u,l,p,o,c,d,b,f,y,g){e.productType=[],e.selectedDatas=[],e.attributeTypes=[],e.categories=[],e.articles=[],e.attribute_group=[],e.attributeMaps=[],e.attributeMapValues=[],e.selectDeselectAll=!1,e.showAttributeValues=!1,e.enableProductType=!1,e.enableGroup=!1,e.enableCategories=!1,e.enableArticles=!1,e.showMultiSelect=!1,e.showDropdownlist=!1,e.showCheckbox=!1,e.showAttachment=!1,e.map={},e.details={},e.attrib_type={},e.attrib_type.attribute_list_value=[],e.details.is_visible=1==e.details.is_visible,e.details.is_search=1==e.details.is_search,e.details.is_required=1==e.details.is_required,e.details.is_variation=1==e.details.is_variation,e.details.is_customizable=1==e.details.is_customizable,e.details.is_unique=1==e.details.is_unique,e.details.is_comparable=1==e.details.is_comparable,e.details.valuelist=[],e.changesCount=0,e.$watch(function(){return e.details},function(){e.changesCount++,t.changesOccur=e.changesCount}),n.getAllAttributeTypes().then(function(t){if(200==t.statusCode&&t.response.success){var i=[];i=t.response.result,u(function(){e.$apply(function(){e.attributeTypes=i})},100)}}),n.getAllAttributeGroup().then(function(t){if(200==t.statusCode&&t.response.success){var i=[];i=t.response.result,u(function(){e.$apply(function(){e.attribute_group=i})},100)}}),c.getAllCategory().then(function(t){if(200==t.statusCode&&t.response.success){var i=t.response.result;u(function(){e.$apply(function(){e.categories=i})},100)}}),d.getArticle().then(function(t){if(200==t.statusCode&&t.response.success){var i=t.response.result;u(function(){e.$apply(function(){e.articles=i})},100)}}),o.getAllProdType().then(function(t){200==t.statusCode&&t.response.success&&(e.productType=t.response.result,_.each(e.productType,function(t){t.selected=!1}))}),async.waterfall([function(t){n.getAllAttributeTypes().then(function(e){200==e.statusCode&&e.response.success&&t(null,e.response.result)})},function(t,i){e.types=t,s.att_id&&n.getAllAttributeDetails(s.att_id).then(function(t){200==t.statusCode&&t.response.success&&(e.details=t.response.result,e.details.is_visible=1==e.details.is_visible,e.details.is_search=1==e.details.is_search,e.details.is_required=1==e.details.is_required,e.details.is_variation=1==e.details.is_variation,e.details.is_customizable=1==e.details.is_customizable,e.details.is_unique=1==e.details.is_unique,e.details.is_comparable=1==e.details.is_comparable,e.generateAttributeValueList(s.att_id),e.getAllAttributeMapValues())})}]),e.generateAttributeValueList=function(t){n.getAttributeValueList(t).then(function(t){if(200==t.statusCode&&t.response.success){var i=t.response.result;e.details.attrib_type&&("Dropdownlist"==e.details.attrib_type.name||"Multiselect"==e.details.attrib_type.name||"Attachment"==e.details.attrib_type.name?(e.showAttributeValues=!0,e.attrib_type.attribute_list_value=[],e.showMultiSelect="Multiselect"==e.details.attrib_type.name,e.showDropdownlist="Dropdownlist"==e.details.attrib_type.name,e.showAttachment="Attachment"==e.details.attrib_type.name,_.each(i,function(t){e.attrib_type.attribute_list_value.push({att_id:s.att_id,name:t.name,value:t.value,description:t.description,contenttype:t.contenttype,sku:t.sku,value_image:t.value_image,_id:t._id,isEdit:!1})}),u(function(){e.$apply(function(){e.details.valuelist=i})},100)):"Checkbox"==e.details.attrib_type.name?(e.showAttributeValues=!0,e.showCheckbox="Checkbox"==e.details.attrib_type.name,console.log("Checkbox: ",e.showAttributeValues),i&&i.length>0&&(i=i[0],e.attrib_type.attrib_name=i.name,e.attrib_type.attrib_value=i.value,e.attrib_type.attrib_description=i.description,e.attrib_type.contenttype=i.contenttype,e.attrib_type.sku=i.sku,e.attrib_type._id=i._id,e.attrib_type.isEdit=!0)):i&&i.length>0&&(i=i[0],e.attrib_type.attrib_name=i.name,e.attrib_type.attrib_value=i.value,e.attrib_type.attrib_description=i.description,e.attrib_type.contenttype=i.contenttype,e.attrib_type.sku=i.sku,e.attrib_type._id=i._id,e.attrib_type.isEdit=!0))}})},e.getAllAttributeMapValues=function(){e.attributeMaps=[],e.attributeMapValues=[],n.getAttibuteMapping(s.att_id).then(function(t){if(200==t.statusCode&&t.response.success){e.attributeMaps=[],e.attributeMapValues=[];var i=t.response.result;_.each(i,function(t){e.attributeMaps.push({fk_ptype_id:t.fk_ptype_id||null,fk_att_id:t.fk_att_id,fk_attgrp_id:t.fk_attgrp_id||null,fk_c_id:t.fk_c_id||null,fk_article_id:t.fk_article_id||null});var i=_.find(e.productType,{ptype_id:t.fk_ptype_id}),a=_.find(e.attribute_group,{attgrp_id:t.fk_attgrp_id}),s=_.find(e.categories,{c_id:t.fk_c_id}),r=_.find(e.articles,{article_id:t.fk_article_id});e.attributeMapValues.push({fk_ptype:_.isEmpty(i)?null:i.name,fk_attgrp:_.isEmpty(a)?null:a.name,fk_category:_.isEmpty(s)?null:s.name,fk_article:_.isEmpty(r)?null:r.title})})}})},e.$watch(function(){return e.details.attrib_type_id},function(t){e.attrib_type.attrib_name="",e.attrib_type.attrib_value="",e.attrib_type.attrib_description="";var i=_.find(e.attributeTypes,{attrib_type_id:t});e.details.attrib_type=i,e.details.attrib_type&&("Dropdownlist"===e.details.attrib_type.name&&"Multiselect"===e.details.attrib_type.name&&"Attachment"===e.details.attrib_type.name&&"Checkbox"===e.details.attrib_type.name||(e.showAttributeValues=!1))}),e.$watch(function(){return e.attributeTypes},function(t){e.attrib_type.attrib_name="",e.attrib_type.attrib_value="",e.attrib_type.attrib_description="";var i=_.find(t,{attrib_type_id:e.details.attrib_type_id});e.details.attrib_type=i,e.generateAttributeValueList(s.att_id)}),e.$watch(function(){return e.productType},function(t){e.getAllAttributeMapValues()}),e.enableProductTypeEvent=function(t){console.log("newValue:",t),0==t&&(e.map.fk_ptype_id=void 0)},e.enableGroupEvent=function(t){0==t&&(e.map.fk_attgrp_id=void 0)},e.enableCategoriesEvent=function(t){0==t&&(e.map.fk_c_id=void 0)},e.enableArticlesEvent=function(t){0==t&&(e.map.fk_article_id=void 0)},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.productType,function(t){t.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.ptype_id===t.ptype_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.ptype_id!==t.ptype_id}),e.deleteSomeData=e.selectedDatas.length>0},e.removethumb=function(){e.attrib_type.value_image=null},e.addtoList=function(t){if(s.att_id){if(_.isEmpty(e.attrib_type.attrib_name))return void l.warning("Please enter attribute value name","Warning");if(_.isEmpty(e.attrib_type.attrib_value))return void l.warning("Please enter attribute value","Warning");n.saveAttributeValueList(s.att_id,{name:e.attrib_type.attrib_name,value:e.attrib_type.attrib_value,description:e.attrib_type.attrib_description,contenttype:e.attrib_type.contenttype,sku:e.attrib_type.sku,_id:e.attrib_type._id,isEdit:e.attrib_type.isEdit}).then(function(t){if(200==t.statusCode&&t.response.success)l.success(t.response.msg,"Success"),e.clearInput(),p.reload();else{if(400!==t.statusCode||t.response.success||!_.isArray(t.response.result))return void l.error(t.response.msg,"Error");_.each(t.response.result,function(t){l.warning(t.msg,"Warning")})}})}else l.warning("Please select attribute to update","Warning")},e.addtoList1=function(){if(s.att_id){if(_.isEmpty(e.attrib_type.attrib_name))return void l.warning("Please enter attribute value name","Warning");if(_.isEmpty(e.attrib_type.attrib_value))return void l.warning("Please enter attribute value","Warning");console.log("$scope.attrib_type: ",e.attrib_type),g.upload({url:f+y+"attributes/"+s.att_id+"/valuelist",data:{name:e.attrib_type.attrib_name,value:e.attrib_type.attrib_value,description:e.attrib_type.attrib_description,contenttype:e.attrib_type.contenttype,sku:e.attrib_type.sku,value_image:e.attrib_type.value_image,_id:e.attrib_type._id,isEdit:e.attrib_type.isEdit},method:"POST"}).then(function(t){if(200===t.data.statusCode&&t.data.response.success)l.success(t.data.response.msg,"Success"),p.reload();else{if(400!==t.data.statusCode||t.data.response.success||!_.isArray(t.data.response.result))return void l.error(t.data.response.msg,"Error");_.each(t.data.response.result,function(t){l.warning(t.msg,"Warning")})}},function(t){console.log("Error status: "+t.status)})}else l.warning("Please select attribute to update","Warning")},e.addtoMapping=function(t){if(_.isEmpty(t))return void l.warning("Please select some values to map attributes","Warning");var i={fk_ptype_id:null,fk_att_id:e.details.att_id,fk_attgrp_id:null,fk_c_id:null,fk_article_id:null},a={fk_ptype:null,fk_attgrp:null,fk_category:null,fk_article:null};if(_.isUndefined(t.fk_ptype_id))return void l.warning("Please select PRODUCT TYPE to map attributes","Warning");i.fk_ptype_id=t.fk_ptype_id.ptype_id,a.fk_ptype=t.fk_ptype_id.name,_.isUndefined(t.fk_attgrp_id)||(i.fk_attgrp_id=t.fk_attgrp_id.attgrp_id,a.fk_attgrp=t.fk_attgrp_id.name),_.isUndefined(t.fk_c_id)||(i.fk_c_id=t.fk_c_id.c_id,a.fk_category=t.fk_c_id.name),_.isUndefined(t.fk_article_id)||(i.fk_article_id=t.fk_article_id.article_id,a.fk_article=t.fk_article_id.title);var s=_.find(e.attributeMaps,{fk_ptype_id:i.fk_ptype_id,fk_att_id:e.details.att_id,fk_attgrp_id:i.fk_attgrp_id,fk_c_id:i.fk_c_id,fk_article_id:i.fk_article_id});return _.isEmpty(s)?(e.attributeMaps.push(i),e.attributeMapValues.push(a),e.enableProductType=!1,e.enableGroup=!1,e.enableCategories=!1,e.enableArticles=!1,e.map.fk_ptype_id=void 0,e.map.fk_attgrp_id=void 0,e.map.fk_c_id=void 0,void(e.map.fk_article_id=void 0)):void l.error("An attribute mapping already existed on the list","Warning")},e.removeFromMapping=function(t){e.attributeMaps.splice(t,1),e.attributeMapValues.splice(t,1)},e.clearMapping=function(){e.attributeMaps=[],e.attributeMapValues=[]},e.saveMapping=function(){var t=1;return e.attributeMaps.length>0?void(s.att_id&&async.waterfall([function(t){n.deleteAttributeMapping(s.att_id).then(function(e){200==e.statusCode&&e.response.success&&t(null,s.att_id)})},function(i,a){async.eachSeries(e.attributeMaps,function(i,a){n.saveAttributeMapping(s.att_id,i).then(function(e){return 200==e.statusCode&&e.response.success?(t++,void a()):void l.error(e.response.msg,"Error")}),t==e.attributeMaps.length&&(l.success("Record Successfully Saved","Success"),p.reload())})}])):void l.warning("Unable to save Attribute Mapping.. No list of mapping are available","Warning")},e.viewFromList=function(t){e.attrib_type.attrib_name=t.name,e.attrib_type.attrib_value=t.value,e.attrib_type.attrib_description=t.description,e.attrib_type.contenttype=t.contenttype,e.attrib_type.sku=t.sku,e.attrib_type.value_image=t.value_image,e.attrib_type._id=t._id,e.attrib_type.isEdit=!0},e.clearInput=function(){e.attrib_type.attrib_name="",e.attrib_type.attrib_value="",e.attrib_type.attrib_description="",e.attrib_type.contenttype="",e.attrib_type.sku="",e.attrib_type.value_image=null},e.deleteSelected=function(t){a.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){n.deleteAttributeValueList(t.att_id,t._id).then(function(t){return 200==t.statusCode&&t.response.success?(l.success(t.response.msg,"Success"),void p.reload()):void l.error(t.response.msg,"Error")})})},e.saveAttribute=function(){e.details.values=e.attrib_type,async.waterfall([function(t){s.att_id?n.updateAttribute(s.att_id,e.details).then(function(e){if(200==e.statusCode&&e.response.success)u(function(){l.success("Successfully Update","Success")},300),t(null,s.att_id);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void l.error(e.response.msg,"Error");_.each(e.response.result,function(t){l.warning(t.msg,"Warning")})}}):n.saveAttribute(e.details).then(function(e){if(200==e.statusCode&&e.response.success)u(function(){l.success("Successfully Added","Success")},300),t(null,e.response.result);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void l.error(e.response.msg,"Error");_.each(e.response.result,function(t){l.warning(t.msg,"Warning")})}})},function(t,e){p.go(p.current,{att_id:t},{reload:!0})}])}}angular.module("POS17").controller("attributeDetailsController",t),t.$inject=["$rootScope","$scope","$uibModal","ngDialog","$stateParams","localStorageService","attributeFactory","$timeout","toastr","$state","ptypeFactory","categoryFactory","articleFctry","AuthFctry","API_URL","API_VERSION","Upload"]}();
!function(){"use strict";function e(e,t,s,o,a,r,n,c,l,u){e.selectDeselectAll=!1,e.selectedDatas=[];var i=function(){e.attribisLoading=!0,e.groups=[],e.attributecopy=[],e.attributeGroupTable=new u({page:1,count:10},{counts:[10,25,50,100],getData:function(t,o){c.getAllAttributeGroup().then(function(a){if(200==a.statusCode&&a.response.success){var n=a.response.result;if(_.each(n,function(e){e.date_created=moment(e.date_created).format("YYYY-MM-DD")}),e.attributecopy=angular.copy(e.groups),e.txtSearch){e.groups=s("filter")(n,e.txtSearch),o.total(e.groups.length);var c=e.groups.slice((o.page()-1)*o.count(),o.page()*o.count());t.resolve(c)}else{e.groups=n,o.total(e.groups.length);var c=e.groups.slice((o.page()-1)*o.count(),o.page()*o.count());t.resolve(c)}e.attribisLoading=!1}else e.attribisLoading=!1,r.error(a.response.msg,"Error")})}})};e.refresh=function(){e.attribisLoading=!1,e.attributeGroupTable.reload()},e.searchData=function(){e.attributeGroupTable.reload()},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.groups,function(t){t.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.attgrp_id===t.attgrp_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.attgrp_id!==t.attgrp_id}),e.deleteSomeData=e.selectedDatas.length>0},e.toggleModal=function(t){a.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){c.deleteAttributeGroup(t).then(function(e){return 200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),void o.reload()):void r.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},e.deleteSelected=function(){a.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=0;async.each(e.selectedDatas,function(s,a){s.selected&&(console.log("groups: ",s),c.deleteAttributeGroup(s.attgrp_id).then(function(s){return console.log("data: ",s.response),200==s.statusCode&&s.response.success?(r.success(s.response.msg,"Success"),++t,t==e.selectedDatas.length&&o.reload(),a(),void 0):void r.error(s.response.msg,"Error")}))})})},e.addGroups=function(s){var o=t.open({animation:!0,templateUrl:"./modules/attributes/attribute.groups.modal.html",controller:"attributeModal",size:"md",resolve:{items:function(){return s}}});o.result.then(function(t){e.selected=t},function(){l.info("Modal dismissed at: "+new Date)})},i()}function t(e,t,s,o,a,r,n){e.items=o,e.group={},console.log("items:",e.items),e.items&&a.getAttributeGroupDetails(e.items).then(function(t){200==t.statusCode&&t.response.success&&(console.log("data:",t.response.result),e.group=t.response.result)}),e.saveGroup=function(){e.items?a.updateAttributeGroup(e.items,e.group).then(function(e){200==e.statusCode&&e.response.success&&(console.log("UPDATE"),n.success("Successfully Update","Success"),t.reload(),s.close(e.response.success))}):a.saveAttributeGroup(e.group).then(function(o){200==o.statusCode&&o.response.success&&r(function(){e.$apply(function(){n.success("Successfully Added","Success"),t.reload(),s.close(o.response.success)})},100)})},e.cancel=function(){s.dismiss("cancel"),t.reload()}}angular.module("POS17").controller("attributeGroups",e).controller("attributeModal",t),e.$inject=["$scope","$uibModal","$filter","$state","ngDialog","toastr","$timeout","attributeFactory","$log","ngTableParams"],t.$inject=["$scope","$state","$uibModalInstance","items","attributeFactory","$timeout","toastr"]}();
!function(){"use strict";function e(e,t,a,s,l,c){e.selectDeselectAll=!1,e.selectedDatas=[];var n=function(){e.attribisLoading=!0,e.types=[],e.typescopy=[],e.attributeTypesTable=new c({page:1,count:10},{counts:[10,25,50,100],getData:function(a,c){l.getAllAttributeTypes().then(function(l){if(200==l.statusCode&&l.response.success){var n=l.response.result;if(_.each(e.types,function(e){e.date_created=moment(e.date_created).format("YYYY-MM-DD")}),e.attributecopy=angular.copy(e.types),e.txtSearch){e.types=t("filter")(n,e.txtSearch),c.total(e.types.length);var o=e.types.slice((c.page()-1)*c.count(),c.page()*c.count());a.resolve(o)}else{e.types=n,c.total(e.types.length);var o=e.types.slice((c.page()-1)*c.count(),c.page()*c.count());a.resolve(o)}e.attribisLoading=!1}else e.attribisLoading=!1,s.error(l.response.msg,"Error")})}})};e.refresh=function(){e.attribisLoading=!1,e.attributeTypesTable.reload()},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.types,function(t){t.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.searchData=function(){e.attributeTypesTable.reload()},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.id===t.id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.id!==t.id}),e.deleteSomeData=e.selectedDatas.length>0},e.deleteSelected=function(){a.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){})},n()}angular.module("POS17").controller("attributeTypes",e),e.$inject=["$scope","$filter","ngDialog","toastr","attributeFactory","ngTableParams"]}();
!function(){"use strict";function t(t,e,a,i,r,u,n,l){t.attrib={},t.attrib.attribute_list_value=[],t.attrib.attribute_list_value2=[];var o=_.find(a.attributeTypes,{attrib_type_id:a.attrib_type_id});t.attrib.attrib_type=o;var s=JSON.parse(n.get("user")),b=t.uploader=new i({url:r+u+"/attributevalues/"+a.attribute_id,method:"PUT",headers:{Authorization:"Bearer "+l.getUserToken(),accesskey:s.subscriptionKey}});b.filters.push({name:"imageFilter",fn:function(t,e){var a="|"+t.type.slice(t.type.lastIndexOf("/")+1)+"|";return"|jpg|png|jpeg|bmp|gif|".indexOf(a)!==-1}}),b.onBeforeUploadItem=function(t){t.alias="pb_image"},t.removethumb=function(){t.attrib.value_image=null},t.addtoList=function(){t.attrib.attribute_list_value.push({name:t.attrib.name,value:t.attrib.value}),t.attrib.name="",t.attrib.value=""},t.addtoList2=function(){t.attrib.attribute_list_value2.push({name:t.attrib.name,value:t.attrib.value}),t.attrib.name="",t.attrib.value=""},t.ok=function(){e.close(t.selected.item)},t.cancel=function(){e.dismiss("cancel")}}angular.module("POS17").controller("producttypeAttributeModalCtrl",t),t.inject=["$scope","$uibModalInstance","attributes","FileUploader","API_URL","API_VERSION","localStorageService","AuthFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,e){e.state("main.settings-categories",{url:"/settings/categories",templateUrl:"modules/category/categories.html",controller:"categoryController"}).state("main.settings-categories-add",{url:"/settings/categories/:c_id",templateUrl:"modules/category/category.detail.html",controller:"categoryDetailsController"})}])}();
!function(){"use strict";function e(e,t,s,o,a,c,l,r,n,i,g){e.selectDeselectAll=!1,e.selectedDatas=[];var d=JSON.parse(i.get("user"));g.logTransaction("View Categories","CATEGORIES","ALL","User:="+d.username+" View all list of categories");var u=function(){e.categoryIsLoading=!0,e.categories=[],e.categoriescopy=[],e.categoryTable=new n({page:1,count:10},{counts:[10,25,50,100],getData:function(t,o){l.getAllCategory().then(function(a){if(200==a.statusCode&&a.response.success){var l=a.response.result;if(e.categoriescopy=angular.copy(e.categories),e.txtSearch){e.categories=s("filter")(l,e.txtSearch),o.total(e.categories.length);var r=e.categories.slice((o.page()-1)*o.count(),o.page()*o.count());t.resolve(r)}else{e.categories=l,o.total(e.categories.length);var r=e.categories.slice((o.page()-1)*o.count(),o.page()*o.count());t.resolve(r)}e.categoryIsLoading=!1}else e.categoryIsLoading=!1,c.error(a.response.msg,"Error")})}})};e.refresh=function(){e.categoryIsLoading=!0,e.categoryTable.reload()},e.edit=function(e){o.go("main.settings-categories-add",{c_id:e})},e.searchData=function(){e.categoryTable.reload()},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.categories,function(t){t.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.c_id===t.c_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.c_id!==t.c_id}),e.deleteSomeData=e.selectedDatas.length>0},e.toggleModal=function(t){a.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){l.deleteCategory(t).then(function(e){return 200==e.statusCode&&e.response.success?(c.success(e.response.msg,"Success"),void o.reload()):void c.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},e.deleteSelected=function(){a.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=0;async.each(e.selectedDatas,function(s,a){s.selected&&(console.log("category: ",s),l.deleteCategory(s.c_id).then(function(s){return console.log("data: ",s.response),200==s.statusCode&&s.response.success?(c.success(s.response.msg,"Success"),++t,t==e.selectedDatas.length&&o.reload(),a(),void 0):void c.error(s.response.msg,"Error")}))})})},u()}angular.module("POS17").controller("categoryController",e),e.$inject=["$scope","$http","$filter","$state","ngDialog","toastr","categoryFactory","$timeout","ngTableParams","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,s,t,r,n,a,o,c,i,u,d){e.details={},e.details.tags=[],e.tagsArr=[],e.newImage=!1;var l=[],g=[],p=JSON.parse(u.get("user"));t.article_id?d.logTransaction("View Category Details","CATEGORIES",t.c_id,"User:="+p.username+" View category details:="+t.c_id):d.logTransaction("Add New Category","CATEGORIES","N/A","User:="+p.username+" Add new category entry"),i.getAllTags().then(function(s){200==s.statusCode&&s.response.success?e.tagsArr=s.response.result:c.error(s.response.msg,"Error")}),e.generateCategory=function(){r.getAllCategory().then(function(s){if(200==s.statusCode&&s.response.success){for(var t=s.response.result,r=0;r<t.length;r++){var n=t[r],a=n.name,o=n.parent_id,c=n.c_id;g[o]?(n={parentid:o,label:a,item:n},null!=n&&(g[o].items||(g[o].items=[]),g[o].items[g[o].items.length]=n,g[c]=n)):(g[c]={parentid:o,label:a,item:n},l[c]=g[c])}e.categoryData=_(l).omit(_.isUndefined).omit(_.isNull).value()}})},e.generateCategory(),t.c_id&&r.getCategoryDetails(t.c_id).then(function(s){200==s.statusCode&&s.response.success&&(e.details=s.response.result,i.getAllCategoryTags(t.c_id).then(function(s){200==s.statusCode&&s.response.success&&(e.details.tags=s.response.result)}))}),e.deleteProductTags=function(e){t.c_id&&i.deleteCategoryTag(t.c_id,e.tags_id).then(function(e){return 200==e.statusCode&&e.response.success?void c.success(e.response.msg,"Success"):void c.error(e.response.msg,"Error")})},e.tagTransform=function(e){return{tags:e}},e.clearInput=function(e){e.search=""},e.toplevelCategory=function(){e.TPchecked?e.mytree.currentNode={}:e.generateCategory()},e.changeItem=function(s){e.selectedItem=s},e.removethumb=function(){e.details.c_image=null,e.newImage=!1},e.upload=function(s){e.newImage=!0},e.saveCategory=function(){e.mytree&&angular.isObject(e.mytree.currentNode)&&!_.isEmpty(e.mytree.currentNode)?e.details.parent_id=e.mytree.currentNode.item.c_id:e.details.parent_id=null,async.waterfall([function(s){t.c_id?r.updateCategory(t.c_id,e.details).then(function(e){if(200==e.statusCode&&e.response.success)c.success(e.response.msg,"Success"),s(null,t.c_id);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void c.error(e.response.msg,"Error");_.each(e.response.result,function(e){c.warning(e.msg,"Warning")})}}):r.saveCategory(e.details).then(function(e){if(200==e.statusCode&&e.response.success)c.success(e.response.msg,"Success"),s(null,e.response.result);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void c.error(e.response.msg,"Error");_.each(e.response.result,function(e){c.warning(e.msg,"Warning")})}})},function(s,t){var r=1;e.details.tags.length>0?async.eachSeries(e.details.tags,function(n,a){n.isTag?i.saveTags(n).then(function(e){return 200==e.statusCode&&e.response.success?void i.saveCategoryTags(s,{tag_id:e.response.result}).then(function(e){return 200==e.statusCode&&e.response.success?(r++,void a()):void c.error(e.response.msg,"Error")}):void c.error(e.response.msg,"Error")}):i.saveCategoryTags(s,{tag_id:n.tags_id}).then(function(e){return 200==e.statusCode&&e.response.success?(r++,void a()):void c.error(e.response.msg,"Error")}),r>=e.details.tags.length&&t(null,s)}):t(null,s)},function(t,r){e.newImage&&e.details.c_image?n.upload({url:a+o+"categories/"+t+"/upload-image",data:{c_image:e.details.c_image},method:"PUT"}).then(function(e){if(200===e.data.statusCode&&e.data.response.success)c.success("Image successfully uploaded","Success"),s.go(s.current,{c_id:t},{reload:!0});else{if(400!==e.data.statusCode||e.data.response.success||!_.isArray(e.data.response.result))return void c.error(e.data.response.msg,"Error");_.each(e.data.response.result,function(e){c.warning(e.msg,"Warning")})}},function(e){console.log("Error status: "+e.status)},function(e){parseInt(100*e.loaded/e.total)}):s.go(s.current,{c_id:t},{reload:!0})}])}}angular.module("POS17").controller("categoryDetailsController",e),e.$inject=["$scope","$state","$stateParams","categoryFactory","Upload","API_URL","API_VERSION","toastr","tagsFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(e,r){r.state("main.settings-currencies",{url:"/settings/currencies",templateUrl:"modules/currencies/currencies.html",controller:"currenciesController"})}])}();
!function(){"use strict";function e(e,r,c,n,s,t,o,a){var i=JSON.parse(o.get("user"));a.logTransaction("View Currencies","CURRENCIES","ALL","User:="+i.username+" View all list of currencies");var u=function(){e.currencyisLoading=!0,e.currencies=[],e.currenciescopy=[],e.currenciesTable=new s({page:1,count:10},{counts:[10,25,50,100],getData:function(c,s){n.getAllCurrencies().then(function(n){if(200==n.statusCode&&n.response.success){var o=n.response.result;if(e.currenciescopy=angular.copy(e.currencies),e.txtSearch){e.currencies=r("filter")(o,e.txtSearch),s.total(e.currencies.length);var a=e.currencies.slice((s.page()-1)*s.count(),s.page()*s.count());c.resolve(a)}else{e.currencies=o,s.total(e.currencies.length);var a=e.currencies.slice((s.page()-1)*s.count(),s.page()*s.count());c.resolve(a)}e.currencyisLoading=!1}else e.currencyisLoading=!1,t.error(n.response.msg,"Error")})}})};e.searchData=function(){e.currenciesTable.reload()},e.refresh=function(){e.currencyisLoading=!0,e.currenciesTable.reload()},u()}angular.module("POS17").controller("currenciesController",e),e.$inject=["$scope","$filter","$timeout","currencyFactory","ngTableParams","toastr","localStorageService","transLogFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,e){e.state("main.settings-producttype",{url:"/settings/producttype",templateUrl:"modules/producttype/productTypes.html",controller:"productTypeController"}).state("main.settings-producttype-add",{url:"/settings/producttype/:ptype_id",templateUrl:"modules/producttype/productType.detail.html",controller:"producttypeDetailController"})}])}();
!function(){"use strict";function e(e,t,s,o,c,l,a,n,r,p,d){e.typeisLoading=!0,e.selectDeselectAll=!1,e.selectedDatas=[];var u=JSON.parse(p.get("user"));d.logTransaction("View Product Types","PRODUCT TYPES","ALL","User:="+u.username+" View all list of product types");var i=function(){e.typeisLoading=!0,e.producttypes=[],e.producttypescopy=[],e.productTypeTable=new r({page:1,count:10},{counts:[10,25,50,100],getData:function(t,s){a.getAllProdType().then(function(c){if(200==c.statusCode&&c.response.success){var a=c.response.result;if(e.producttypescopy=angular.copy(e.producttypes),e.txtSearch){e.producttypes=o("filter")(a,e.txtSearch),s.total(e.producttypes.length);var n=e.producttypes.slice((s.page()-1)*s.count(),s.page()*s.count());t.resolve(n)}else{e.producttypes=a,s.total(e.producttypes.length);var n=e.producttypes.slice((s.page()-1)*s.count(),s.page()*s.count());t.resolve(n)}e.typeisLoading=!1}else e.typeisLoading=!1,l.error(c.response.msg,"Error")})}})};e.refresh=function(){e.typeisLoading=!0,e.productTypeTable.reload()},e.edit=function(e){s.go("main.settings-producttype-add",{ptype_id:e})},e.searchData=function(){e.productTypeTable.reload()},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.producttypes,function(t){t.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.ptype_id===t.ptype_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.ptype_id!==t.ptype_id}),e.deleteSomeData=e.selectedDatas.length>0},e.toggleModal=function(t){c.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){a.deleteProductType(t).then(function(e){return 200==e.statusCode&&e.response.success?(l.success(e.response.msg,"Success"),void s.reload()):void l.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},e.deleteSelected=function(){c.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=0;async.each(e.selectedDatas,function(o,c){o.selected&&(console.log("producttype: ",o),a.deleteProductType(o.ptype_id).then(function(o){return console.log("data: ",o.response),200==o.statusCode&&o.response.success?(l.success(o.response.msg,"Success"),++t,t==e.selectedDatas.length&&s.reload(),c(),void 0):void l.error(o.response.msg,"Error")}))})})},i()}angular.module("POS17").controller("productTypeController",e),e.$inject=["$scope","$http","$state","$filter","ngDialog","toastr","ptypeFactory","$timeout","ngTableParams","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,s,t,r,o,n,a,u,c,d,i,p){s.details={},s.details.tags=[],s.tags=[],s.tagsArr=[],s.newImage=!1;var l=JSON.parse(i.get("user"));r.ptype_id?p.logTransaction("View Product Type Details","PRODUCT TYPES",r.ptype_id,"User:="+l.username+" View product type details:="+r.ptype_id):p.logTransaction("Add New Product Type","PRODUCT TYPES","N/A","User:="+l.username+" Add new product type entry"),d.getAllTags().then(function(e){200==e.statusCode&&e.response.success?s.tagsArr=e.response.result:a.error(e.response.msg,"Error")}),r.ptype_id&&o.getAllProdTypeDetails(r.ptype_id).then(function(e){200==e.statusCode&&e.response.success&&(s.details=e.response.result,d.getAllProductTypeTags(r.ptype_id).then(function(e){200==e.statusCode&&e.response.success&&(s.details.tags=e.response.result)}))}),s.removethumb=function(){s.details.c_image=null,s.newImage=!1},s.upload=function(e){s.newImage=!0},s.tagTransform=function(e){return{tags:e}},s.clearInput=function(e){e.search=""},s.deleteProductTags=function(e){console.log("deleteProductBundleTag: ",e),r.ptype_id&&d.deleteProductTypeTag(r.ptype_id,e.tags_id).then(function(e){return 200==e.statusCode&&e.response.success?void a.success(e.response.msg,"Success"):void a.error(e.response.msg,"Error")})},s.saveProductType=function(){async.waterfall([function(t){r.ptype_id?o.updateProductType(r.ptype_id,s.details).then(function(e){if(200==e.statusCode&&e.response.success)a.success(e.response.msg,"Success"),t(null,r.ptype_id);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void a.error(e.response.msg,"Error");_.each(e.response.result,function(e){a.warning(e.msg,"Warning")})}}):o.saveProductType(s.details).then(function(s){if(200==s.statusCode&&s.response.success)a.success(s.response.msg,"Success"),t(null,s.response.result),e.go("main.settings-producttype-add",{ptype_id:s.response.result},{reload:!0});else{if(400!==s.statusCode||s.response.success||!_.isArray(s.response.result))return void a.error(s.response.msg,"Error");_.each(s.response.result,function(e){a.warning(e.msg,"Warning")})}})},function(e,t){var r=1;s.details.tags.length>0?async.eachSeries(s.details.tags,function(o,n){o.isTag?d.saveTags(o).then(function(s){return 200==s.statusCode&&s.response.success?void d.saveProductTypeTags(e,{tag_id:s.response.result}).then(function(e){return 200==e.statusCode&&e.response.success?(r++,void n()):void a.error(e.response.msg,"Error")}):void a.error(s.response.msg,"Error")}):d.saveProductTypeTags(e,{tag_id:o.tags_id}).then(function(e){return 200==e.statusCode&&e.response.success?(r++,void n()):void a.error(e.response.msg,"Error")}),r>=s.details.tags.length&&t(null,e)}):t(null,e)},function(t,r){s.newImage&&s.details.ptype_image?n.upload({url:u+c+"producttype/"+t+"/upload-image",data:{ptype_image:s.details.ptype_image},method:"PUT"}).then(function(r){if(200===r.data.statusCode&&r.data.response.success)s.newImage&&a.success("Image successfully uploaded","Success"),e.go(e.current,{ptype_id:t},{reload:!0});else{if(400!==r.data.statusCode||r.data.response.success||!_.isArray(r.data.response.result))return void a.error(r.data.response.msg,"Error");_.each(r.data.response.result,function(e){a.warning(e.msg,"Warning")})}},function(e){console.log("Error status: "+e.status)},function(e){parseInt(100*e.loaded/e.total)}):e.go(e.current,{ptype_id:t},{reload:!0})}])}}angular.module("POS17").controller("producttypeDetailController",e),e.$inject=["$state","$scope","$http","$stateParams","ptypeFactory","Upload","toastr","API_URL","API_VERSION","tagsFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(s,e){e.state("main.settings-suppliers",{url:"/settings/suppliers",templateUrl:"modules/suppliers/suppliers.html",controller:"suppliersController"}).state("main.settings-suppliers-add",{url:"/settings/suppliers/:s_id",templateUrl:"modules/suppliers/supplier.detail.html",controller:"suppliersDetailsController"})}])}();
!function(){"use strict";function e(e,s,t,l,o,r,n,a,c,i,p){e.selectDeselectAll=!1,e.selectedDatas=[];var u=JSON.parse(i.get("user"));p.logTransaction("View Suppliers","SUPPLIERS","ALL","User:="+u.username+" View all list of suppliers");var d=function(){e.supplierisLoading=!0,e.suppliers=[],e.supplierscopy=[],e.supplierTable=new c({page:1,count:10},{counts:[10,25,50,100],getData:function(s,l){r.getAllSuppliers().then(function(o){if(200==o.statusCode&&o.response.success){var r=o.response.result;if(e.supplierscopy=angular.copy(e.suppliers),e.txtSearch){e.suppliers=t("filter")(r,e.txtSearch),l.total(e.suppliers.length);var n=e.suppliers.slice((l.page()-1)*l.count(),l.page()*l.count());s.resolve(n)}else{e.suppliers=r,l.total(e.suppliers.length);var n=e.suppliers.slice((l.page()-1)*l.count(),l.page()*l.count());s.resolve(n)}e.supplierisLoading=!1}else e.supplierisLoading=!1,a.error(o.response.msg,"Error")})}})};e.refresh=function(){e.supplierisLoading=!0,e.supplierTable.reload()},e.edit=function(e){l.go("main.settings-suppliers-add",{s_id:e})},e.searchData=function(){e.supplierTable.reload()},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.suppliers,function(s){s.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(s)})},e.checkDataChanges=function(s){s.selected?_.find(e.selectedDatas,function(e){return e.s_id===s.s_id})||e.selectedDatas.push(s):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.s_id!==s.s_id}),e.deleteSomeData=e.selectedDatas.length>0},e.toggleModal=function(s){o.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){r.deleteSupplier(s).then(function(e){return 200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),void l.reload()):void a.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},e.deleteSelected=function(){o.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var s=0;async.each(e.selectedDatas,function(t,o){t.selected&&(console.log("supplier: ",t),r.deleteSupplier(t.s_id).then(function(t){return console.log("data: ",t.response),200==t.statusCode&&t.response.success?(a.success(t.response.msg,"Success"),++s,s==e.selectedDatas.length&&l.reload(),o(),void 0):void a.error(t.response.msg,"Error")}))})})},d()}angular.module("POS17").controller("suppliersController",e),e.$inject=["$scope","$http","$filter","$state","ngDialog","supplierFctry","$timeout","toastr","ngTableParams","localStorageService","transLogFctry"]}();
!function(){"use strict";function s(s,e,r,t,n,o,i,u,a,c){s.details={},s.details.tags=[],s.tagsArr=[];var l=JSON.parse(a.get("user"));r.s_id?c.logTransaction("View Supplier Details","SUPPLIERS",r.s_id,"User:="+l.username+" View supplier details:="+r.s_id):c.logTransaction("Add New Supplier","SUPPLIERS","N/A","User:="+l.username+" Add new supplier entry"),u.getAllTags().then(function(e){200==e.statusCode&&e.response.success?s.tagsArr=e.response.result:n.error(e.response.msg,"Error")}),r.s_id&&t.getAllSuppliersDetails(r.s_id).then(function(e){200==e.statusCode&&e.response.success&&(s.details=e.response.result,u.getAllSupplierTags(r.s_id).then(function(e){200==e.statusCode&&e.response.success&&(s.details.tags=e.response.result)}))}),s.deleteProductTags=function(s){r.s_id&&u.deleteSupplierTag(r.s_id,s.tags_id).then(function(s){return 200==s.statusCode&&s.response.success?void n.success(s.response.msg,"Success"):void n.error(s.response.msg,"Error")})},s.tagTransform=function(s){return{tags:s}},s.clearInput=function(s){s.search=""},s.saveSupplier=function(){async.waterfall([function(e){r.s_id?t.updateSupplier(r.s_id,s.details).then(function(s){if(200==s.statusCode&&s.response.success)n.success(s.response.msg,"Success"),e(null,r.s_id);else{if(400!==s.statusCode||s.response.success||!_.isArray(s.response.result))return void n.error(s.response.msg,"Error");_.each(s.response.result,function(s){n.warning(s.msg,"Warning")})}}):t.saveSupplier(s.details).then(function(s){if(200==s.statusCode&&s.response.success)n.success(s.response.msg,"Success"),e(null,s.response.result);else{if(400!==s.statusCode||s.response.success||!_.isArray(s.response.result))return void n.error(s.response.msg,"Error");_.each(s.response.result,function(s){n.warning(s.msg,"Warning")})}})},function(e,r){console.log("s_id: ",e);var t=1;s.details.tags.length>0?async.eachSeries(s.details.tags,function(o,i){o.isTag?u.saveTags(o).then(function(s){return 200==s.statusCode&&s.response.success?void u.saveSupplierTags(e,{tag_id:s.response.result}).then(function(s){return 200==s.statusCode&&s.response.success?(t++,void i()):void n.error(s.response.msg,"Error")}):void n.error(s.response.msg,"Error")}):u.saveSupplierTags(e,{tag_id:o.tags_id}).then(function(s){return 200==s.statusCode&&s.response.success?(t++,void i()):void n.error(s.response.msg,"Error")}),t>=s.details.tags.length&&r(null,e)}):r(null,e)},function(s,e){console.log("callback s_id: ",s),o.go("main.settings-suppliers-add",{s_id:s},{reload:!0})}])}}angular.module("POS17").controller("suppliersDetailsController",s),s.$inject=["$scope","$http","$stateParams","supplierFctry","toastr","$state","$timeout","tagsFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(r,a){a.state("main.calendars",{url:"/calendars",templateUrl:"modules/calendar/calendar.html",controller:"calendarCtrl"})}])}();
!function(){"use strict";function e(e){$(function(){function e(e){e.each(function(){var e={title:$.trim($(this).text())};$(this).data("eventObject",e)})}e($("#external-events div.external-event"));var t=new Date,o=t.getDate(),r=t.getMonth(),a=t.getFullYear();$("#calendar").fullCalendar({header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},buttonText:{today:"today",month:"month",week:"week",day:"day"},events:[{title:"All Day Event",start:new Date(a,r,1),backgroundColor:"#f56954",borderColor:"#f56954"},{title:"Long Event",start:new Date(a,r,o-5),end:new Date(a,r,o-2),backgroundColor:"#f39c12",borderColor:"#f39c12"},{title:"Meeting",start:new Date(a,r,o,10,30),allDay:!1,backgroundColor:"#0073b7",borderColor:"#0073b7"},{title:"Lunch",start:new Date(a,r,o,12,0),end:new Date(a,r,o,14,0),allDay:!1,backgroundColor:"#00c0ef",borderColor:"#00c0ef"},{title:"Birthday Party",start:new Date(a,r,o+1,19,0),end:new Date(a,r,o+1,22,30),allDay:!1,backgroundColor:"#00a65a",borderColor:"#00a65a"},{title:"Click for Google",start:new Date(a,r,28),end:new Date(a,r,29),url:"http://google.com/",backgroundColor:"#3c8dbc",borderColor:"#3c8dbc"}],editable:!0,droppable:!0,drop:function(e,t){var o=$(this).data("eventObject"),r=$.extend({},o);r.start=e,r.allDay=t,r.backgroundColor=$(this).css("background-color"),r.borderColor=$(this).css("border-color"),$("#calendar").fullCalendar("renderEvent",r,!0),$("#drop-remove").is(":checked")&&$(this).remove()}});var n="#3c8dbc";$("#color-chooser-btn");$("#color-chooser > li > a").click(function(e){e.preventDefault(),n=$(this).css("color"),$("#add-new-event").css({"background-color":n,"border-color":n})}),$("#add-new-event").click(function(t){t.preventDefault();var o=$("#new-event").val();if(0!=o.length){var r=$("<div />");r.css({"background-color":n,"border-color":n,color:"#fff"}).addClass("external-event"),r.html(o),$("#external-events").prepend(r),e(r),$("#new-event").val("")}})})}angular.module("POS17").controller("calendarCtrl",e),e.$inject=["$scope"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(e,r){r.state("main.settings-humanresource",{url:"/settings/humanresource",templateUrl:"modules/humanresource/humanresource.html",controller:"personController"}).state("main.settings-humanresource-detail",{url:"/settings/humanresource/:person_id",templateUrl:"modules/humanresource/humanresource.detail.html",controller:"personDetailController"}).state("main.settings-customergroup",{url:"/settings/customergroup",templateUrl:"modules/humanresource/customer.groups.html",controller:"customerGroupController"})}])}();
!function(){"use strict";function e(e,s,t,o,n,r,l,a,c,i,p,d){e.selectDeselectAll=!1,e.applicationStatus="All",e.displayModel="List",e.selectedDatas=[];var u=function(){e.personisLoading=!0,e.persons=[],e.personscopy=[],e.personsTable=new i({page:1,count:10},{counts:[10,25,50,100],getData:function(s,t){l.getAllPerson().then(function(n){if(200==n.statusCode&&n.response.success){var r=n.response.result;e.personscopy=angular.copy(e.persons),_.each(r,function(e){if(_.isNull(e.date_end))e.isActiveAcnt=!0;else{var s=new Date,t=new Date(e.date_end),o=moment(s),n=moment(t),r=moment.duration(o.diff(n)),l=r.asDays();l>=1?e.isActiveAcnt=!1:e.isActiveAcnt=!0}}),e.txtSearch&&"All"==e.applicationStatus?e.persons=o("filter")(r,e.txtSearch):e.txtSearch&&"Employee"==e.applicationStatus?(e.persons=o("filter")(r,{per_type_id:1}),e.persons=o("filter")(e.persons,e.txtSearch)):e.txtSearch&&"Customer"==e.applicationStatus?(e.persons=o("filter")(r,{per_type_id:2}),e.persons=o("filter")(e.persons,e.txtSearch)):_.isUndefined(e.txtSearch)&&"All"==e.applicationStatus?e.persons=r:_.isUndefined(e.txtSearch)&&"Employee"==e.applicationStatus?e.persons=o("filter")(r,{per_type_id:1}):_.isUndefined(e.txtSearch)&&"Customer"==e.applicationStatus?e.persons=o("filter")(r,{per_type_id:2}):e.persons=r,e.persons=_.filter(e.persons,function(e){return"Employee"==e.person_type?e:1==e.isSubscriber?e:void 0}),console.log("persons: ",e.persons),t.total(e.persons.length);var l=e.persons.slice((t.page()-1)*t.count(),t.page()*t.count());s.resolve(l),e.personisLoading=!1}else e.personisLoading=!1,a.error(n.response.msg,"Error")})}})};u(),e.refresh=function(){e.personsTable.reload()},e.updateStatus=function(s){e.applicationStatus=s,e.personsTable.reload()},e.searchData=function(){e.personsTable.reload()},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.persons,function(s){s.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(s)})},e.checkDataChanges=function(s){s.selected?_.find(e.selectedDatas,function(e){return e.person_id===s.person_id})||e.selectedDatas.push(s):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.person_id!==s.person_id}),e.deleteSomeData=e.selectedDatas.length>0},e.toggleModal=function(s){r.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){l.deletePersonel(s).then(function(e){return 200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),void n.reload()):void a.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},e.deleteSelected=function(){r.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var s=0;async.each(e.selectedDatas,function(t,o){t.selected&&(console.log("person: ",t),l.deletePersonel(t.person_id).then(function(t){return console.log("data: ",t.response),200==t.statusCode&&t.response.success?(a.success(t.response.msg,"Success"),++s,s==e.selectedDatas.length&&n.reload(),o(),void 0):void a.error(t.response.msg,"Error")}))})})}}angular.module("POS17").controller("personController",e),e.$inject=["$scope","$rootScope","$http","$filter","$state","ngDialog","humanFactory","toastr","$timeout","ngTableParams","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,s,n,t,o,r,a,i,l,u,c){console.log("$stateParams:",n.person_id),e.stores=[],e.persons=[],e.details={},e.enableEndTerm=!1,e.newImage=!1;var d=JSON.parse(u.get("user"));n.article_id?c.logTransaction("View Staff Details","STAFF MANAGEMENT",n.person_id,"User:="+d.username+" View staff details:="+n.person_id):c.logTransaction("Add New Staff","STAFF MANAGEMENT","N/A","User:="+d.username+" Add new staff entry"),t.getPersonType().then(function(s){200==s.statusCode&&s.response.success&&(e.persons=s.response.result)}),o.getAllCountries().then(function(s){200==s.statusCode&&s.response.success&&(e.countries=s.response.result)}),t.getTimeZone().then(function(s){200==s.statusCode&&s.response.success&&(e.timezone=s.response.result)}),n.person_id&&t.getAllPersonDetail(n.person_id).then(function(s){if(200==s.statusCode&&s.response.success)if(e.details=s.response.result,e.details.isActive=1==e.details.isActive,e.details.person_img=e.details.image,_.isNull(e.details.date_end))e.details.isActiveAcnt=!0;else{var n=new Date,t=new Date(e.details.date_end),o=moment(n),r=moment(t),a=moment.duration(o.diff(r)),i=a.asDays();i>=1?e.details.isActiveAcnt=!1:e.details.isActiveAcnt=!0}}),e.$watch("enableEndTerm",function(s){1==s?e.details.date_end=new Date:e.details.date_end=null}),e.removethumb=function(){e.details.person_img=null,e.newImage=!1},e.upload=function(s){e.newImage=!0},e.savePersonel=function(){async.waterfall([function(s){n.person_id?t.updatePersonel(n.person_id,e.details).then(function(e){if(200==e.statusCode&&e.response.success)l.success(e.response.msg,"Success"),s(null,n.person_id);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void l.error(e.response.msg,"Error");_.each(e.response.result,function(e){l.warning(e.msg,"Warning")})}}):t.savePersonel(e.details).then(function(e){if(200==e.statusCode&&e.response.success)l.success(e.response.msg,"Success"),s(null,e.response.result);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void l.error(e.response.msg,"Error");_.each(e.response.result,function(e){l.warning(e.msg,"Warning")})}})},function(s,n){console.log("$scope.newImage: ",e.newImage),e.newImage&&e.details.image?r.upload({url:a+i+"persons/"+s+"/upload-image",data:{person_img:e.details.image},method:"PUT"}).then(function(e){if(200===e.data.statusCode&&e.data.response.success)l.success("Image successfully uploaded","Success"),n(null,s);else{if(400!==e.data.statusCode||e.data.response.success||!_.isArray(e.data.response.result))return void l.error(e.data.response.msg,"Error");_.each(e.data.response.result,function(e){l.warning(e.msg,"Warning")})}},function(e){console.log("Error status: "+e.status)},function(e){parseInt(100*e.loaded/e.total)}):n(null,s)},function(e,n){console.log("personel: ",e),s.go(s.current,{person_id:e},{reload:!0})}])}}angular.module("POS17").controller("personDetailController",e),e.$inject=["$scope","$state","$stateParams","humanFactory","countryFactory","Upload","API_URL","API_VERSION","toastr","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,t,o,s,r,l,n,c,a,u,i,d){e.selectDeselectAll=!1,e.selectedDatas=[],e.txtSearch2="";var g=JSON.parse(i.get("user"));d.logTransaction("View Customer Groups","CUSTOMER GROUPS","ALL","User:="+g.username+" View all list of customer groups");var p=function(){e.groups=[],e.groupscopy=[],e.attributeGroupTable=new u({page:1,count:10},{counts:[10,25,50,100],getData:function(t,o){n.getCustomerGroup().then(function(r){if(200==r.statusCode&&r.response.success){var l=r.response.result;e.groupscopy=angular.copy(r.response.result),e.txtSearch?e.groups=s("filter")(l,e.txtSearch):e.groups=l,o.total(e.groups.length);var n=e.groups.slice((o.page()-1)*o.count(),o.page()*o.count());e.personisLoading=!1,t.resolve(n)}else e.personisLoading=!1,c.error(r.response.msg,"Error")})}})};p(),e.refresh=function(){console.log("refresh"),e.attributeGroupTable.reload()},e.searchData=function(){console.log("searchData"),e.attributeGroupTable.reload()},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.groups,function(t){t.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.addGroups=function(t){var s=o.open({animation:!0,templateUrl:"./modules/humanresource/groups/customer.groups.modal.html",controller:"customerGroupModalController",size:"md",resolve:{selected:function(){return t}}});s.result.then(function(t){e.selected=t},function(){console.info("Modal dismissed at: "+new Date)})},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.cg_id===t.cg_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.cg_id!==t.cg_id}),e.deleteSomeData=e.selectedDatas.length>0},e.toggleModal=function(t){l.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){n.deleteCustomerGroup(t).then(function(e){return 200==e.statusCode&&e.response.success?(c.success(e.response.msg,"Success"),void r.reload()):void c.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},e.deleteSelected=function(){l.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=0;async.each(e.selectedDatas,function(o,s){o.selected&&n.deleteCustomerGroup(o.cg_id).then(function(o){return 200==o.statusCode&&o.response.success?(c.success(o.response.msg,"Success"),++t,t==e.selectedDatas.length&&r.reload(),s(),void 0):void c.error(o.response.msg,"Error")})})})}}angular.module("POS17").controller("customerGroupController",e),e.$inject=["$scope","$rootScope","$uibModal","$filter","$state","ngDialog","humanFactory","toastr","$timeout","ngTableParams","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,r,t,s,o,n,a){e.selectedStores=[],e.originalSelected=[],e.selectDeselectAll=!1,e.applicationStatus="",e.getAllStore=function(){e.stores=[],e.storesCopy=[],async.waterfall([function(r){n.getAllStore().then(function(t){200==t.statusCode&&t.response.success?(e.stores=t.response.result,e.storesCopy=angular.copy(e.stores),r(null,e.stores)):s.error(t.response.msg,"Error")})},function(r,t){a.person_id?o.getAssignedStorePerson(a.person_id).then(function(t){200==t.statusCode&&t.response.success&&t.response.result.length>0?(e.prodStore=t.response.result,_.each(e.storesCopy,function(r){var t=_.find(e.prodStore,function(e){return r.store_id===e.store_id});t&&(r.selected=!0,e.selectedStores.push(r),e.originalSelected=angular.copy(e.selectedStores))}),e.itemArray=angular.copy(e.storesCopy)):200==t.statusCode&&t.response.success&&0===t.response.result.length?e.itemArray=angular.copy(r):s.error(t.response.msg,"Error")}):e.itemArray=angular.copy(r)}])},e.getAllStore(),e.paginate=function(){$("#tblStore").trigger("footable_redraw")},e.updateStatus=function(r){e.applicationStatus=r,""===r?e.itemArray=angular.copy(e.storesCopy):(e.itemArray.splice(0,e.itemArray.length),_.each(e.storesCopy,function(r){_.find(e.selectedStores,function(e){return r.store_id===e.store_id})&&e.itemArray.push(r)}))},e.searchStore=function(){if(e.txtSearch){e.itemArray.splice(0,e.itemArray.length);var t=r("filter")(e.storesCopy,e.txtSearch);e.itemArray=angular.copy(t)}},e.searchStatus=function(){""===e.txtSearch&&(e.itemArray.splice(0,e.itemArray.length),e.itemArray=angular.copy(e.storesCopy))},e.changeSelectDeselectAll=function(){_.each(e.itemArray,function(r){r.selected=e.selectDeselectAll,e.checkStoresChanges(r)})},e.checkStoresChanges=function(r){if(r.selected){var t=_.find(e.selectedStores,function(e){return e.store_id===r.store_id});t||e.selectedStores.push(r)}else e.selectedStores=_.filter(e.selectedStores,function(e){return e.store_id!==r.store_id})},e.refresh=function(){e.storeTable.reload()},e.saveStore=function(r){return a.person_id?(e.params={oldparams:e.originalSelected,newparams:e.selectedStores},void o.assignedStorePerson(a.person_id,e.params).then(function(r){200===r.statusCode&&r.response.success?(s.success(r.response.msg,"Success"),e.storeTable.reload(),e.originalSelected=angular.copy(e.selectedStores)):s.error(r.response.msg,"Error")})):void s.warning("WARNING: Unable to save.. no available products","WARNING")}}angular.module("POS17").controller("perStotreController",e),e.$inject=["$scope","$filter","$state","toastr","personFctry","storeFactory","$stateParams"]}();
!function(){"use strict";function e(e,s,t,o,r,n,c,a,u,l,i,p,g,d){e.groups=[],e.groupsCopy=[],e.selectDeselectAll=!1,e.selectedDatas=[];var f=JSON.parse(d.get("user"));g.logTransaction("View Customer Groupings","CUSTOMER GROUPINGS","ALL","User:="+f.username+" View all list of customer groupings"),e.refreshData=function(){console.log("refreshData"),async.waterfall([function(s){e.groups=[],e.groupsCopy=[],a.getCustomerGroup().then(function(t){if(200==t.statusCode&&t.response.success){var o=t.response.result;e.groups=o,s(null,o)}})},function(s,t){l.person_id&&c.getCustomerGroup(l.person_id).then(function(s){if(200==s.statusCode&&s.response.success){var t=s.response.result;_.each(e.groups,function(s){var o=_.find(t,{customer_group_id:s.cg_id});o?(s.selected=!0,e.checkDataChanges(s)):s.selected=!1}),e.groupsCopy=[],e.groupsCopy=angular.copy(e.groups)}})}])},e.refreshData(),e.addGroups=function(s){var t=p.open({animation:!0,templateUrl:"./modules/humanresource/groups/customer.groups.modal.html",controller:"customerGroupModalController",size:"md",resolve:{selected:function(){return s}}});t.result.then(function(s){e.refreshData()})},e.searchData=function(){e.txtSearch?e.groups=t("filter")(e.groupsCopy,e.txtSearch):e.groups=e.groupsCopy},e.changeSelectDeselectAll=function(){_.each(e.groups,function(s){s.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(s)})},e.checkDataChanges=function(s){s.selected?_.find(e.selectedDatas,function(e){return e.cg_id===s.cg_id})||e.selectedDatas.push(s):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.cg_id!==s.cg_id}),e.deleteSomeData=e.selectedDatas.length>0},e.saveCustomerGrouping=function(){if(l.person_id){if(!(e.selectedDatas.length>0))return void n.warning("Please select groups for customer grouping","WARNING");console.log("$scope.selectedDatas",e.selectedDatas),async.waterfall([function(e){c.deleteCustomerGroup(l.person_id).then(function(s){200==s.statusCode&&s.response.success&&e(null,l.person_id)})},function(s,t){var r=0;async.each(e.selectedDatas,function(s,t){s.selected&&c.saveCustomerGroup(l.person_id,{customer_group_id:s.cg_id}).then(function(s){return 200==s.statusCode&&s.response.success?(n.success(s.response.msg,"Success"),++r,r==e.selectedDatas.length&&o.reload(),t(),void 0):void n.error(s.response.msg,"Error")})})}])}}}angular.module("POS17").controller("customerGroupingsController",e),e.$inject=["$scope","$http","$filter","$state","$timeout","toastr","companyFactory","humanFactory","ngDialog","$stateParams","countryFactory","$uibModal","transLogFctry","localStorageService"]}();
!function(){"use strict";function s(s,e,r,o,t,n,c,u){console.log("selected:",n),s.details=n,s.stores=[],s.tagsArr=[],u.getAllStore().then(function(e){200==e.statusCode&&e.response.success&&(s.stores=e.response.result)}),s.saveGroup=function(){n?c.updateCustomerGroup(n.cg_id,s.details).then(function(s){return 200==s.statusCode&&s.response.success?(t.success(s.response.msg,"Success"),r.dismiss("cancel"),e.reload(),void 0):400===s.statusCode&&!s.response.success&&_.isArray(s.response.result)?void _.each(s.response.result,function(s){t.warning(s.msg,"Warning")}):void t.error(s.response.msg,"Error")}):c.saveCustomerGroup(s.details).then(function(s){return 200==s.statusCode&&s.response.success?(t.success(s.response.msg,"Success"),r.dismiss("cancel"),e.reload(),void 0):400===s.statusCode&&!s.response.success&&_.isArray(s.response.result)?void _.each(s.response.result,function(s){t.warning(s.msg,"Warning")}):void t.error(s.response.msg,"Error")})},s.cancel=function(){r.dismiss("cancel")}}angular.module("POS17").controller("customerGroupModalController",s),s.$inject=["$scope","$state","$uibModalInstance","$timeout","toastr","selected","humanFactory","storeFactory"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(s,e){e.state("main.settings-useraccounts",{url:"/settings/useraccounts",templateUrl:"modules/useraccess/useraccess.html",controller:"useraccountsCtrl"}).state("main.settings-permissions",{url:"/settings/permissions/:groupId",templateUrl:"modules/useraccess/permission.html",controller:"permissionCtrl"})}])}();
!function(){"use strict";function e(e,s,o,r,n,t,l,u,c,i,a){e.selectDeselectAll=!1,e.selectDeselectAll2=!1,e.usergroups=[];var p=JSON.parse(i.get("user"));a.logTransaction("View User Accounts","USER ACCOUNTS","ALL","User:="+p.username+" View all list of user accounts"),e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.users,function(s){s.selected=e.selectDeselectAll})},e.showUserRoles=function(s){e.useraccountRoles=_.map(e.usergroups,function(e){return e.role_id==s})},e.initialize=function(){console.log("initialize"),async.waterfall([function(s){e.usersGroupTable=new c({page:1,count:10},{counts:[10,25,50,100],getData:function(o,r){u.getAllUserGroups().then(function(t){if(200==t.statusCode&&t.response.success){var l=t.response.result;e.usersgroupcopy=angular.copy(t.response.result),e.txtSearch?e.usergroups=$filter("filter")(l,e.txtSearch):e.usergroups=l,r.total(e.usergroups.length);var u=e.usergroups.slice((r.page()-1)*r.count(),r.page()*r.count());o.resolve(u),s(null,u)}else n.error(t.response.msg,"Error"),s(null,"error")})}})},function(s,o){e.usersTable=new c({page:1,count:10},{counts:[10,25,50,100],getData:function(s,r){l.getAllUserAccounts().then(function(t){if(200==t.statusCode&&t.response.success){var l=t.response.result;console.log("users: ",l),_.each(l,function(s){s.role_id&&(s.userRoles=_.map(s.role_id.split(","),function(s){return _.find(e.usersgroupcopy,function(e){return e.role_id==s})}))}),e.txtSearch2?e.users=$filter("filter")(l,e.txtSearch2):e.users=l,r.total(e.users.length);var u=e.users.slice((r.page()-1)*r.count(),r.page()*r.count());s.resolve(u)}else n.error(t.response.msg,"Error"),$activityIndicator.stopAnimating(),o(null,"error")})}})}])},e.initialize(),e.newUserAccount=function(s,r){console.log("newUserAccount");var n=o.open({animation:!0,templateUrl:"modules/useraccess/users.modal.html",controller:"useraccountCtrl",backdrop:"static",size:"lg",resolve:{user:function(){return{userID:s,person_id:r}}}});n.result.then(function(){console.log("modalInstance"),e.initialize()},function(){console.info("Modal dismissed")})},e.newUserGroup=function(s){console.log("groupID: ",s);var r=o.open({animation:!0,templateUrl:"modules/useraccess/usergroups.modal.html",controller:"usergroupCtrl",backdrop:"static",size:"lg",resolve:{userGroup:function(){return s}}});r.result.then(function(s){console.log("response: ",s),"save"===s&&e.initialize()},function(){console.info("Modal dismissed")})},e.toggleModal=function(s,o,r){console.log(r),t.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){"users"===r?e.removeUser(s):e.removeUserGroup(s)},function(e){console.log("Modal promise close: ")})},e.removeUserGroup=function(s){console.log("id: ",s),u.deleteUserGroup(s).then(function(s){console.log("data: ",s),200==s.statusCode&&s.response.success?(n.success(s.response.msg,"Success"),r(function(){e.initialize()},300)):n.error(s.response.msg,"Error")})},e.removeUser=function(s){l.deleteUserAccount(s).then(function(s){200==s.statusCode&&s.response.success?(n.success(s.response.msg,"Success"),r(function(){e.initialize()},300)):n.error(s.response.msg,"Error")})},e.setUsersSubscription=function(e){var r=o.open({animation:!0,templateUrl:"modules/useraccess/subscription.modal.html",controller:"usersubscriptionCtrl",backdrop:"static",size:"sm",resolve:{user:function(){return e}}});r.result.then(function(){s.reload()},function(){console.info("Modal dismissed")})},e.refreshUser=function(){e.usersTable.reload()},e.refreshUserGroup=function(){e.usersGroupTable.reload()},e.searchData=function(){e.usersGroupTable.reload()},e.searchData2=function(){e.usersTable.reload()}}angular.module("POS17").controller("useraccountsCtrl",e),e.$inject=["$scope","$state","$uibModal","$timeout","toastr","ngDialog","useraccountsFctry","usergroupsFctry","ngTableParams","localStorageService","transLogFctry"]}();
!function(){"use strict";function s(s,e,r,o,n,u,t,c,a,i,p){s.inputType="password",s.inputType2="password",s.activeTab="info",s.users={},s.users.valid_until=new Date,s.employees=[],s.usergroups=[],s.popup1={opened:!1},s.showUsername=!1,s.showPassword=!1,s.showRecovery=!1,s.showPIN=!1,n.userID&&n.person_id?p.logTransaction("View User Account Info","USER ACCOUNTS","PERSON:="+n.person_id+" USER:="+n.userID,"User:="+n.username+" View user account information for PERSON:="+n.person_id+" USER:="+n.userID):p.logTransaction("Add New Account Info","USER ACCOUNTS","PERSON:="+n.person_id,"User:="+n.username+" Add new account information for PERSON:="+n.person_id),async.waterfall([function(e){u.getAllEmployees().then(function(r){200==r.statusCode&&r.response.success?(s.employees=r.response.result,s.employees=_.filter(s.employees,function(s){return"Employee"==s.person_type?s:1==s.isSubscriber?s:void 0}),e(null,s.employees)):e(null,"error")})},function(e,r){t.getAllUserGroups().then(function(o){200==o.statusCode&&o.response.success?(s.usergroups=o.response.result,r(null,e,s.usergroups)):r(null,"error")})},function(e,u,t){n.userID&&n.person_id&&o.getUserAccount(n.userID,n.person_id).then(function(e){if(200==e.statusCode&&e.response.success){s.users=e.response.result,s.showUsername=!0,s.showPassword=!0,s.showRecovery=!0,s.showPIN=!0;var o=_.isEmpty(s.users.role_id)?null:s.users.role_id.split(",");s.users.employee=s.users.profile,s.users.role=_.map(o,function(e){return _.find(s.usergroups,function(s){return s.role_id==e})}),s.users.valid_until=new Date(s.users.valid_until),t()}else r.error(e.response.msg,"Error")})},function(e){o.getUserEmailRecovery(n.userID).then(function(o){200==o.statusCode&&o.response.success?(s.users.recovery_email=o.response.result.recovery_email,e()):r.error(o.response.msg,"Error")})},function(e){o.getUserPIN(n.userID).then(function(o){200==o.statusCode&&o.response.success?(s.users.pos_pin=o.response.result.pos_pin,e()):r.error(o.response.msg,"Error")})}]),s.open1=function(){s.popup1.opened=!0},s.hideShowPassword=function(){"password"==s.inputType?s.inputType="text":s.inputType="password"},s.hideShowPassword2=function(){"password"==s.inputType2?s.inputType2="text":s.inputType2="password"},s.generatePassword=function(){var e=o.generatePasswordString(8);s.users.password=e},s.setDefaultUName=function(e){e&&(s.users.username=e.lastname.toUpperCase())},s.setActiveTab=function(e){s.activeTab=e,console.log("tab: ",e),console.log("activeTab: ",s.activeTab)},s.saveUser=function(){var u=[];s.users.person_id=s.users.employee.person_id,s.users.role&&s.users.role.length>0?(_.each(s.users.role,function(s){u.push(s.role_id)}),s.users.role_id=u.join()):s.users.role_id="",n&&n.userID?o.updateUserAccount(n.userID,s.users).then(function(s){200==s.statusCode&&s.response.success?(r.success(s.response.msg,"Success"),e.close("save")):400===s.statusCode&&!s.response.success&&_.isArray(s.response.result)?_.each(s.response.result,function(s){r.warning(s.msg,"Warning")}):r.error(s.response.msg,"Error")}):(s.users.username=s.users.username+moment(),o.saveUserAccount(s.users).then(function(s){200==s.statusCode&&s.response.success?(r.success(s.response.msg,"Success"),e.close("save")):400===s.statusCode&&!s.response.success&&_.isArray(s.response.result)?_.each(s.response.result,function(s){r.warning(s.msg,"Warning")}):r.error(s.response.msg,"Error")}))},s.saveUserName=function(){c.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:s,className:"ngdialog-theme-default"}).then(function(){n&&n.userID&&o.updateUserUsername(n.userID,{username:s.users.username}).then(function(s){if(200==s.statusCode&&s.response.success)r.success("Successfully Update","Success"),a(function(){e.dismiss("cancel"),i.reload()},1e3);else{if(400!==s.statusCode||s.response.success||!_.isArray(s.response.result))return void r.error(resp.data.response.msg,"Error");_.each(s.response.result,function(s){r.warning(s.msg,"Warning")})}})})},s.saveUserPassword=function(){c.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:s,className:"ngdialog-theme-default"}).then(function(){if(n&&n.userID){if(s.users.password!==s.users.confirm_password)return void r.warning("Password and Confirm Password do not match");o.updateUserPassword(n.userID,{password:s.users.password,confirm_password:s.users.confirm_password}).then(function(s){if(200==s.statusCode&&s.response.success)r.success("Successfully Update","Success"),a(function(){e.dismiss("cancel"),i.reload()},1e3);else{if(400!==s.statusCode||s.response.success||!_.isArray(s.response.result))return void r.error(resp.data.response.msg,"Error");_.each(s.response.result,function(s){r.warning(s.msg,"Warning")})}})}})},s.saveUserEmailRecovery=function(){c.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:s,className:"ngdialog-theme-default"}).then(function(){n&&n.userID&&o.updateUserEmailRecovery(n.userID,{email_recovery:s.users.recovery_email,person_id:s.users.employee.person_id}).then(function(s){if(200==s.statusCode&&s.response.success)r.success("Successfully Update","Success"),a(function(){e.dismiss("cancel"),i.reload()},1e3);else{if(400!==s.statusCode||s.response.success||!_.isArray(s.response.result))return void r.error(s.response.msg,"Error");_.each(s.response.result,function(s){r.warning(s.msg,"Warning")})}})})},s.saveUserPIN=function(){c.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:s,className:"ngdialog-theme-default"}).then(function(){n&&n.userID&&o.updateUserPIN(n.userID,{pin:s.users.pos_pin}).then(function(s){if(200==s.statusCode&&s.response.success)r.success("Successfully Update","Success"),a(function(){e.dismiss("cancel"),i.reload()},1e3);else{if(400!==s.statusCode||s.response.success||!_.isArray(s.response.result))return void r.error(s.response.msg,"Error");_.each(s.response.result,function(s){r.warning(s.msg,"Warning")})}})})},s.cancelUser=function(){e.dismiss("cancel")}}angular.module("POS17").controller("useraccountCtrl",s),s.$inject=["$scope","$uibModalInstance","toastr","useraccountsFctry","user","personFctry","usergroupsFctry","ngDialog","$timeout","$state","transLogFctry"]}();
!function(){"use strict";function s(s,e,r,o,u,n,c){var t=JSON.parse(n.get("user"));_.isUndefined(r)?c.logTransaction("Add New User Group","USER GROUPS","N/A","User:="+t.username+" Add new user group entry"):c.logTransaction("View User Group Details","USER GROUPS",r,"User:="+t.username+" View user group details:="+r),_.isUndefined(r)||u.getUserGroupById(r).then(function(e){200==e.statusCode&&e.response.success?_.isArray(e.response.result)&&(s.usergroup=e.response.result[0],console.log("$scope.usergroup: ",s.usergroup)):o.error(e.response.msg,"Error")}),s.saveUserGroup=function(){_.isUndefined(r)?u.createUserGroup(s.usergroup).then(function(s){200==s.statusCode&&s.response.success?(o.success(s.response.msg,"Success"),e.close("save")):o.error(s.response.msg,"Error")}):u.updateUserGroup(r,s.usergroup).then(function(s){console.log("data: ",s),200==s.statusCode&&s.response.success?(o.success(s.response.msg,"Success"),e.close("save")):o.error(s.response.msg,"Error")})},s.cancelUserGroup=function(){e.dismiss("cancel")}}angular.module("POS17").controller("usergroupCtrl",s),s.$inject=["$scope","$uibModalInstance","userGroup","toastr","usergroupsFctry","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,s,n,o,t,r,i,u,l,a){e.permissions=[],e.Groups=[],e.usergroups=[],e.isReset=!0,e.isUpdate=!0;var c=JSON.parse(l.get("user"));n.article_id&&a.logTransaction("View User Group Permission","USER GROUPS",n.groupId,"User:="+c.username+" View user group permission for GROUP:="+n.groupId),_.isUndefined(n.groupId)?(console.log("sadasda"),t.getAllModulesPermissions().then(function(s){if(200==s.statusCode&&s.response.success){var n=s.response.result;n.length>0&&(e.permissions=n,_.each(e.permissions,function(e){e.DefaultReadDisable=!0,e.DefaultWriteDisable=!0,e.DefaultDeleteDisable=!0,e.DefaultPrintDisable=!0}))}})):(console.log("sadasda 111"),async.waterfall([function(s){t.getAllModulesPermissions().then(function(n){if(200==n.statusCode&&n.response.success){var o=n.response.result;o.length>0?(e.permissions=o,s()):s()}})},function(s){console.log("sadasda"),r.getUserGroupById(n.groupId).then(function(n){if(200==n.statusCode&&n.response.success){var t=n.response.result;t&&t.length>0&&(e.usergroup=n.response.result[0],e.usergroupSelected=n.response.result[0],e.generateAccessPermission(e.usergroup.role_id),s())}else o.error(n.response.msg,"Error")})}])),e.generateAccessPermission=function(n){s(function(){_.isUndefined(n)?e.clear():t.generateAccessPermission(n).then(function(s){if(200==s.statusCode&&s.response.success){e.isUpdate=!1,e.isReset=!1;var n=s.response.result;n.length>0&&_.each(e.permissions,function(e){var s=_.find(n,{mf_id:e.mf_id});s&&(e.DefaultDelete=s.DefaultDelete,e.DefaultPrint=s.DefaultPrint,e.DefaultRead=s.DefaultRead,e.DefaultWrite=s.DefaultWrite)})}})},300)},e.clear=function(){e.isUpdate=!0,e.isReset=!0,e.usergroupSelected=void 0,e.permissions=[],t.getAllModulesPermissions().then(function(s){if(200==s.statusCode&&s.response.success){var n=s.response.result;n.length>0&&(e.permissions=n,_.each(e.permissions,function(e){e.DefaultRead=!1,e.DefaultReadDisable=!0,e.DefaultWrite=!1,e.DefaultWriteDisable=!0,e.DefaultDelete=!1,e.DefaultDeleteDisable=!0,e.DefaultPrint=!1,e.DefaultPrintDisable=!0}))}})},e.reloadData=function(){_.isUndefined(e.usergroup)?e.clear():e.generateAccessPermission(e.usergroup.role_id)},e.resetPermission=function(){i.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){async.waterfall([function(s){t.resetGroupPrivilege(e.usergroupSelected.role_id).then(function(e){200==e.statusCode&&e.response.success?(o.success(e.response.msg,"Success"),s()):o.error(e.response.msg,"Error")})},function(s){t.getAllModulesPermissions().then(function(s){if(200==s.statusCode&&s.response.success){var n=s.response.result;n.length>0&&(e.permissions=n)}})}])})},e.UpdatePermission=function(){i.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){e.newPermission=angular.copy(e.permissions),console.log("$scope.newPermission: ",e.newPermission),t.setGroupPrivilege(e.usergroupSelected.role_id,e.newPermission).then(function(e){200==e.statusCode&&e.response.success?(o.success(e.response.msg,"Success"),s(function(){u.reload()},1e3)):o.error(e.response.msg,"Error")})})},e.IntToBoolean=function(e){return 1==e},e.BooleanToInt=function(e){return e===!0?1:0},e.myFunction=function(){console.log("myFunction"),s(function(){angular.element(document).ready(function(){$("#myTable").each(function(){var e=1,s=null,n=1;$("tbody",this).find("tr").each(function(){var o=$(this).find("td:nth-child("+e+")");null==s?(s=o,n=1):o.text()==s.text()?(o.remove(),s.attr("rowspan",n+1),n+=1):(s=o,n=1)})})})},100)}}angular.module("POS17").controller("permissionCtrl",e),e.$inject=["$scope","$timeout","$stateParams","toastr","permissionFctry","usergroupsFctry","ngDialog","$state","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,s,c,t,n,l){e.selectDeselectAll=!1,e.selectedDatas=[],!_.isUndefined(t),e.changeSelectDeselectAll=function(){console.log("usersubscriptionCtrl"),_.each(s.profile.subscriptions,function(s){s.selected=e.selectDeselectAll})},e.saveUser=function(){!_.isUndefined(t)},e.cancelUser=function(){c.dismiss("cancel")}}angular.module("POS17").controller("usersubscriptionCtrl",e),e.$inject=["$scope","$rootScope","$uibModalInstance","user","toastr","useraccountsFctry"]}();
!function(){"use strict";function e(e,s,o,r,n){var t=JSON.parse(r.get("user"));n.logTransaction("View User Profile","USER PROFILE",t.username,"User:="+t.username+" View user profile information")}function s(e,s,o,r,n,t,a,i,l,u,c,p,d,f){var m=o.getCurrentUser(),g=JSON.parse(m);e.inputType="password",e.pw1="password",e.user=g,e.details={},e.social={},e.showFacebook=!0,e.showGoogle=!0,e.showTwitter=!0,e.showLinkedin=!0,e.showUpload=!1,e.timezone=[],e.newImage=!1,f.logTransaction("View User Profile","USER PROFILE",g.username,"User:="+g.username+" View user profile for modification"),g.person_id&&async.waterfall([function(s){t.getAllPersonDetail(g.person_id).then(function(o){200==o.statusCode&o.response.success&&(e.details=o.response.result,s())})},function(s){t.getUserSocial().then(function(o){200==o.statusCode&o.response.success&&(e.social=o.response.result,e.showFacebook=!_.isEmpty(e.social.facebook_uuid),e.showGoogle=!_.isEmpty(e.social.google_uuid),e.showTwitter=!_.isEmpty(e.social.twitter_uuid),e.showLinkedin=!_.isEmpty(e.social.linkedin_uuid),s())})},function(s){t.getUserPIN().then(function(o){200==o.statusCode&o.response.success&&(e.details.pos_pin=o.response.result.pos_pin,s())})}]),t.getTimeZone().then(function(s){200==s.statusCode&&s.response.success&&(e.timezone=s.response.result)}),e.hideShowPassword=function(){"password"==e.inputType?e.inputType="text":e.inputType="password"},e.upload=function(s){console.log("file",s),e.newImage=!0,e.showUpload=!0},e.removethumb=function(){e.showUpload=!1,e.details.image=null,e.newImage=!1},e.savePersonDetail=function(){async.waterfall([function(s){f.logTransaction("Update User Profile","USER PROFILE",JSON.stringify(e.details),"User:="+g.username+" Update user profile"),g.person_id?t.updatePersonel(g.person_id,e.details).then(function(e){if(200==e.statusCode&&e.response.success)a.success(e.response.msg,"Success"),s(null,g.person_id),r.reload();else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void a.error(e.response.msg,"Error");_.each(e.response.result,function(e){a.warning(e.msg,"Warning")})}}):t.savePersonel(e.details).then(function(e){if(200==e.statusCode&&e.response.success)a.success(e.response.msg,"Success"),s(null,e.response.result),r.reload();else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void a.error(e.response.msg,"Error");_.each(e.response.result,function(e){a.warning(e.msg,"Warning")})}})},function(s,o){console.log("user:",s),e.newImage&&e.details.image&&(f.logTransaction("Update User Profile: Image Upload","USER PROFILE",e.details.image,"User:="+g.username+" Update user profile - Upload Image"),i.upload({url:l+u+"persons/"+s+"/upload-image",data:{person_img:e.details.image},method:"PUT"}).then(function(e){if(200===e.data.statusCode&&e.data.response.success)a.success("Image successfully uploaded","Success"),r.reload();else{if(400!==e.data.statusCode||e.data.response.success||!_.isArray(e.data.response.result))return void a.error(e.data.response.msg,"Error");_.each(e.data.response.result,function(e){a.warning(e.msg,"Warning")})}},function(e){console.log("Error status: "+e.status)},function(e){parseInt(100*e.loaded/e.total)}))}])},e.saveUsername=function(){c.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:s,className:"ngdialog-theme-default"}).then(function(){f.logTransaction("Update User Profile: USERNAME","USER PROFILE",JSON.stringify(s.profile),"User:="+g.username+" Update user profile - USERNAME"),t.updateUsername(s.profile).then(function(e){if(200==e.statusCode&&e.response.success)a.success("Successfully Update","Success"),n(function(){r.reload()},1e3);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void a.error(resp.data.response.msg,"Error");_.each(e.response.result,function(e){a.warning(e.msg,"Warning")})}})})},e.savePassword=function(){c.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:s,className:"ngdialog-theme-default"}).then(function(){f.logTransaction("Update User Profile: USER PASSWORD","USER PROFILE",JSON.stringify(e.details),"User:="+g.username+" Update user profile - USER PASSWORD"),t.updatePassword(e.details).then(function(e){if(200==e.statusCode&&e.response.success)a.success("Successfully Update Password","Success"),n(function(){r.reload()},1e3);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void a.error(resp.data.response.msg,"Error");_.each(e.response.result,function(e){a.warning(e.msg,"Warning")})}})})},e.addRecoveryEmail=function(){c.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){f.logTransaction("Update User Profile: EMAIL RECOVERY","USER PROFILE",e.details.recovery_email,"User:="+g.username+" Update user profile - EMAIL RECOVERY"),t.addRecoveryPassword({email_recovery:e.details.recovery_email}).then(function(e){if(200==e.statusCode&&e.response.success)a.success("Successfully Update","Success"),n(function(){r.reload()},1e3);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void a.error(resp.data.response.msg,"Error");_.each(e.response.result,function(e){a.warning(e.msg,"Warning")})}})})},e.addPOSPIN=function(){c.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){f.logTransaction("Update User Profile: PERSONAL IDENTIFICATION NUMBER","USER PROFILE",e.details.pos_pin,"User:="+g.username+" Update user profile - PERSONAL IDENTIFICATION NUMBER"),t.addUserPIN({pin:e.details.pos_pin}).then(function(e){if(200==e.statusCode&&e.response.success)a.success(e.response.msg,"Success"),n(function(){r.reload()},1e3);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void a.error(e.response.msg,"Error");_.each(e.response.result,function(e){a.warning(e.msg,"Warning")})}})})},e.unlinkAccount=function(e){f.logTransaction("Update User Profile: SOCIAL MEDIA="+e,"USER PROFILE",e,"User:="+g.username+" Update user profile - SOCIAL MEDIA="+e),p.unlink(e,{method:"POST",url:l+"/auth/unlink"}).then(function(s){a.success("You have successfully unlinked "+e+" to your profile!"),n(function(){r.reload()},400)})["catch"](function(e){error.message?a.error(error.message):error.data?a.error(error.data.message,error.status):a.error(error)})},e.viewProfile=function(e,s){if(f.logTransaction("View Social Media Profile:="+e,"USER PROFILE",e,"User:="+g.username+" View social media profile:="+e),"facebook"==e){var o=d.open("https://www.facebook.com/app_scoped_user_id/"+s+"/","_blank");o.focus()}else if("google"==e){var o=d.open("https://plus.google.com/"+s,"_blank");o.focus()}else if("linkedin"==e){var o=d.open("http://www.linkedin.com/profile/view?id="+s,"_blank");o.focus()}else if("twitter"==e){var o=d.open("https://twitter.com/intent/user?user_id="+s,"_blank");o.focus()}},e.authenticate=function(e){f.logTransaction("Link Social Media Profile:="+e,"USER PROFILE",e,"User:="+g.username+" Link social media profile:="+e),p.link(e).then(function(s){a.success("You have successfully linked your profile with "+e+"!"),n(function(){r.reload()},400)})["catch"](function(e){e.message?a.error(e.message):e.data?a.error(e.data.message,e.status):a.error(e)})},e.init=function(){e.status=!0},e.changeStatus=function(){e.status=!e.status}}angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(e,s){s.state("main.settings-profile",{url:"/settings/profile",templateUrl:"modules/profile/profile.html",controller:"ProfileDetailCtrl"}).state("main.settings-profile-details",{url:"/settings/profile/details/",templateUrl:"modules/profile/profile.details.html",controller:"ProfileDetailCtrl"})}]).controller("ProfileCtrl",e).controller("ProfileDetailCtrl",s),e.$inject=["$scope","$state","AuthFctry","localStorageService","transLogFctry"],s.$inject=["$scope","$rootScope","AuthFctry","$state","$timeout","humanFactory","toastr","Upload","API_URL","API_VERSION","ngDialog","$auth","$window","transLogFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(r,e){e.state("main.reports-invoice",{url:"/reports/invoice",templateUrl:"modules/reports/invoice.html"}).state("main.reports-dashboard",{url:"/reports/dashboard",templateUrl:"modules/reports/reportdashboard.html",controller:"reportDashboardController"}).state("main.reports-inventory",{url:"/reports/inventory",templateUrl:"modules/reports/inventoryReport.html",controller:"reportDashboardController"}).state("main.reports-sales",{url:"/reports/sales",templateUrl:"modules/reports/salesReport.html",controller:"reportDashboardController"})}])}();
!function(){"use strict";function e(e,t,a,r,s,o,n,l,c,d,u,i){function p(){e.trace1=e.default_trace_format(),e.trace2=e.default_trace_format(),e.trace3=e.default_trace_format(),e.trace4=e.default_trace_format(),e.trace5=e.default_trace_format(),e.trace6=e.default_trace_format(),e.trace7=e.default_trace_format(),e.trace8=e.default_trace_format(),e.trace9={x:e.trace7.x,y:e.trace7.y,type:"bar",fill:"tonexty",mode:"lines+markers",marker:{color:"#247571"},showlegend:!0,name:"Discount"},e.trace10={x:e.trace1.x,y:e.trace1.y,type:"bar",fill:"tonexty",mode:"lines+markers",marker:{color:"#35aaa6"},showlegend:!0,name:"Revenue"},e.trace11={x:e.trace3.x,y:e.trace3.y,type:"line",fill:"tonexty",mode:"lines+markers",marker:{color:"#09211f"},showlegend:!0,name:"Item Sold"}}function m(){e.prod_sales_s1={x:[],y:[],name:"",type:""}}function y(){e.prod_user_1={x:[],y:[],showlegend:!0,name:"Users",type:"bar"},e.prod_user_sales={x:[],y:[],type:"line",fill:"tonexty",mode:"lines",marker:{color:"red"},showlegend:!0,name:"Sales"},e.prod_user_discount={x:[],y:[],type:"line",fill:"tonexty",mode:"lines",marker:{color:"red"},showlegend:!0,name:"Discount"},e.prod_user_itemsold={x:[],y:[],type:"line",fill:"tonexty",mode:"lines",marker:{color:"green"},showlegend:!0,name:"Item Sold"},e.prod_user_transaction={x:[],y:[],type:"line",fill:"tonexty",mode:"lines",marker:{color:"blue"},showlegend:!0,name:"Transactions"}}function g(){e.prod_performance=[{y:[],x:[],type:"bar",orientation:"h"}]}console.log("reportDashboardController.."),e.isloadingGraphs=!1,e.selectedParam1="User",e.selectedParam2="Revenue",e.selectedParam3="Stock On Hand",e.data2=[],e.sevenDaysPrev=moment().subtract(7,"days").format("YYYY-MM-DD"),e.prevDay=moment().subtract(1,"days").format("YYYY-MM-DD"),e.currDate=moment().format("YYYY-MM-DD");var h=JSON.parse(s.get("user")),f=(new Date).toString().match(/([-\+][0-9]+)\s/)[1];e.statsOfPrevDay={},e.statsOfCurrDay={},String.prototype.insert=function(e,t){return e>0?this.substring(0,e)+t+this.substring(e,this.length):t+this},e.date={startDate:moment().subtract(1,"days"),endDate:moment()},e.opts={locale:{applyClass:"btn-green",applyLabel:"Apply",fromLabel:"Start Date:",toLabel:"End Date:",cancelLabel:"Cancel",customRangeLabel:"Custom Range",firstDay:1},ranges:{Today:[moment().subtract("days"),moment()],Yesterday:[moment().subtract(1,"days"),moment()],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()]}},e.filterBy="day",e.sub_id=h.sub_id,e.dateFrom=e.sevenDaysPrev,e.dateTo=moment().format("YYYY-MM-DD"),e.timezone=f.insert(3,":"),e.arg=1,e.filterBy_2="user",e.sub_id_2=h.sub_id,e.dateFrom_2=e.sevenDaysPrev,e.dateTo_2=moment().format("YYYY-MM-DD"),e.timezone_2=f.insert(3,":"),e.arg_2=1,e.changeOf_revenue_Stat={},e.changeOf_items_sold_Stat={},e.changeOf_customers_Stat={},e.changeOf_discount_Stat={},e.changeOf_discount_percent_Stat={},e.changeOf_basket_value_Stat={},e.changeOf_basket_size_Stat={},e.changeOf_gross_profit_Stat={},e.checkFiltered=function(){return"day"==e.filterBy?(console.log("checkFiltered : day"),"date"):(console.log("checkFiltered : not day"),"linear")},e.checkKey=function(){return"day"==e.filterBy?(console.log("checkKey : day"),"x"):(console.log("checkKey : not day"),"_label")},e.pickAcolor=function(e){return Math.sign(e)==-1?"red":1==Math.sign(e)?"green":"dark-gray"},e.pickAnArrow=function(e){return Math.sign(e)==-1?"zmdi zmdi-trending-down":1==Math.sign(e)?"zmdi zmdi-trending-up":""},e.layout={autosize:!0,width:300,height:180,xaxis:{title:"",autorange:!0,showgrid:!1,zeroline:!1,showline:!1,autotick:!0,ticks:"",tickfont:{size:10,color:"gray"},nticks:5,showticklabels:!0},yaxis:{title:"",tickfont:{size:10,color:"gray"},autorange:!0,showgrid:!1,zeroline:!1,showline:!1,autotick:!0,ticks:"",showticklabels:!0},margin:{l:40,r:20,t:5,b:40,autoexpand:!0}},e.getDashboardReports=function(){e.isloadingGraphs=!0,e.paramobj={sub_id:e.sub_id,filterBy:e.filterBy,dateFrom:e.dateFrom,dateTo:e.dateTo,timezone:e.timezone,arg:1},u.getDashboardReport(e.paramobj).then(function(t){e.data1=t.response,e.getOverall_Revenue=e.data1&&e.data1[t.response.length-1]&&e.data1[t.response.length-1].revenue?e.data1[t.response.length-1].revenue:null,e.getOverall_Salecount=e.data1&&e.data1[t.response.length-1]&&e.data1[t.response.length-1].items_sold?e.data1[t.response.length-1].items_sold:null,e.getOverall_Customercount=e.data1&&e.data1[t.response.length-1]&&e.data1[t.response.length-1].customers?e.data1[t.response.length-1].customers:null,e.getOverall_Grossprofit=e.data1&&e.data1[t.response.length-1]&&e.data1[t.response.length-1].gross_profit?e.data1[t.response.length-1].gross_profit:null,e.getOverall_Discount=e.data1&&e.data1[t.response.length-1]&&e.data1[t.response.length-1].discount?e.data1[t.response.length-1].discount:null,e.getOverall_Discountpercent=e.data1&&e.data1[t.response.length-1]&&e.data1[t.response.length-1].discount_percent?e.data1[t.response.length-1].discount_percent:null,e.getOverall_Basketsize=e.data1&&e.data1[t.response.length-1]&&e.data1[t.response.length-1].basket_size?e.data1[t.response.length-1].basket_size:null,e.getOverall_Basketvalue=e.data1&&e.data1[t.response.length-1]&&e.data1[t.response.length-1].basket_value?e.data1[t.response.length-1].basket_value:null,_.each(t.response,function(a,r){e.trace1.x.push(a.label),e.trace1.y.push(a.revenue),e.trace2.x.push(a.label),e.trace2.y.push(a.gross_profit),e.trace3.x.push(a.label),e.trace3.y.push(a.items_sold),e.trace4.x.push(a.label),e.trace4.y.push(a.customers),e.trace5.x.push(a.label),e.trace5.y.push(a.basket_size),e.trace6.x.push(a.label),e.trace6.y.push(a.basket_value),e.trace7.x.push(a.label),e.trace7.y.push(a.discount),e.trace8.x.push(a.label),e.trace8.y.push(a.discount_percent),moment(a.transaction_date).format("YYYY-MM-DD")==e.data1[t.response.length-2].transaction_date&&(a.prev_revenue_Stat=a.revenue,a.prev_items_sold_Stat=a.items_sold,a.prev_customers_Stat=a.customers,a.prev_discount_Stat=a.discount,a.prev_discount_percent_Stat=a.discount_percent,a.prev_basket_value_Stat=a.basket_value,a.prev_basket_size_Stat=a.basket_size,a.prev_gross_profit_Stat=a.gross_profit,e.statsOfPrevDay=a),moment(a.transaction_date).format("YYYY-MM-DD")==e.data1[t.response.length-1].transaction_date&&(a.prev_revenue_Stat=e.statsOfPrevDay.revenue,a.prev_items_sold_Stat=e.statsOfPrevDay.items_sold,a.prev_customers_Stat=e.statsOfPrevDay.customers,a.prev_discount_Stat=e.statsOfPrevDay.discount,a.prev_discount_percent_Stat=e.statsOfPrevDay.discount_percent,a.prev_basket_value_Stat=e.statsOfPrevDay.basket_value,a.prev_basket_size_Stat=e.statsOfPrevDay.basket_size,a.prev_gross_profit_Stat=e.statsOfPrevDay.gross_profit,e.changeOf_revenue_Stat=(a.revenue-a.prev_revenue_Stat)/a.prev_revenue_Stat*100,e.changeOf_items_sold_Stat=(a.items_sold-a.prev_items_sold_Stat)/a.prev_items_sold_Stat*100,e.changeOf_customers_Stat=(a.customers-a.prev_customers_Stat)/a.prev_customers_Stat*100,e.changeOf_discount_Stat=(a.discount-a.prev_discount_Stat)/a.prev_discount_Stat*100,e.changeOf_discount_percent_Stat=(a.discount_percent-a.prev_discount_percent_Stat)/a.prev_discount_percent_Stat*100,e.changeOf_basket_value_Stat=(a.basket_value-a.prev_basket_value_Stat)/a.prev_basket_value_Stat*100,e.changeOf_basket_size_Stat=(a.basket_size-a.prev_basket_size_Stat)/a.prev_basket_size_Stat*100,e.changeOf_gross_profit_Stat=(a.gross_profit-a.prev_gross_profit_Stat)/a.prev_gross_profit_Stat*100)}),"main.reports-dashboard"==a.current.name&&(e.isloadingGraphs=!1,e.t1_data=[e.trace1],Plotly.newPlot("myDiv1",e.t1_data,e.layout),e.t2_data=[e.trace2],Plotly.newPlot("myDiv2",e.t2_data,e.layout),e.t3_data=[e.trace3],Plotly.newPlot("myDiv3",e.t3_data,e.layout),e.t4_data=[e.trace4],Plotly.newPlot("myDiv4",e.t4_data,e.layout),e.t5_data=[e.trace5],Plotly.newPlot("myDiv5",e.t5_data,e.layout),e.t6_data=[e.trace6],Plotly.newPlot("myDiv6",e.t6_data,e.layout),e.t7_data=[e.trace7],Plotly.newPlot("myDiv7",e.t7_data,e.layout),e.t8_data=[e.trace8],Plotly.newPlot("myDiv8",e.t8_data,e.layout),e.loadSummaryReports())})},e.getDashboardReportsByStore=function(){e.paramobj={sub_id:e.sub_id,filterBy:e.filterBy,dateFrom:e.dateFrom,dateTo:e.dateTo,timezone:e.timezone,arg:2},u.getDashboardReport(e.paramobj).then(function(t){e.data2=t.response,e.getOverall_Revenue_byStore=_.sumBy(e.data2,"revenue"),e.getOverall_Salecount_byStore=_.sumBy(e.data2,"items_sold"),e.getOverall_Customercount_byStore=_.sumBy(e.data2,"customers"),e.getOverall_Grossprofit_byStore=_.sumBy(e.data2,"gross_profit"),e.getOverall_Discount_byStore=_.sumBy(e.data2,"discount"),e.getOverall_Discountpercent_byStore=_.sumBy(e.data2,"discount_percent"),e.getOverall_Basketsize_byStore=_.sumBy(e.data2,"basket_size"),e.getOverall_Basketvalue_byStore=_.sumBy(e.data2,"basket_value"),_.each(e.data2,function(t,a){t.percent_revenue_by_store=t.revenue/e.getOverall_Revenue_byStore*100,t.percent_items_sold_by_store=t.items_sold/e.getOverall_Salecount_byStore*100,t.percent_customers_by_store=t.customers/e.getOverall_Customercount_byStore*100,t.percent_gross_profit_by_store=t.gross_profit/e.getOverall_Grossprofit_byStore*100,t.percent_discount_by_store=t.discount/e.getOverall_Discount_byStore*100,t.percent_discount_percent_by_store=t.discount_percent/e.getOverall_Discountpercent_byStore*100,t.percent_basket_size_by_store=t.basket_size/e.getOverall_Basketsize_byStore*100,t.percent_basket_value_by_store=t.basket_value/e.getOverall_Basketvalue_byStore*100})})},e.getDashboardSalesReports=function(t){e.paramobj2={sub_id:e.sub_id_2,filterBy:t,dateFrom:e.dateFrom_2,dateTo:e.dateTo_2,timezone:e.timezone_2,arg:1},u.getDashboardSalesAndInventoryReport(e.paramobj2).then(function(a){switch(t){case"product":e.productPerformance(a.response),e.productSalesByDate(a.response);break;case"customer":_.each(a.response,function(e,t){});break;case"user":e.getsatbsp_div(a.response),e.calculateUserStats(a.response);break;default:console.log("case not defined, return nothing")}})},e.getDashboardInventoryReports=function(){e.selectedParam3="Stock on hand",e.paramobj2={sub_id:e.sub_id_2,arg:2},u.getDashboardSalesAndInventoryReport(e.paramobj2).then(function(t){e.invProducts=t.response})},e.updateInventoryReportType=function(t){e.selectedParam3="Low in stocks",e.invProducts=_.filter(e.invProducts,function(e){return e.reorder_level>=e.stock_onhand})},e.productSalesByDate=function(t){e.arr=[];var r=_.groupBy(t,"transaction_date"),s=0;_.each(r,function(t,r){s++;var o={x:[],y:[],name:"",type:"bar"};_.each(t,function(e,t){o.x.push(r),o.y.push(e.total_sales),o.name=e.product_name}),e.arr.push(o),s==t.length-1&&(e.srlayout={height:200,margin:{l:40,r:20,t:5,b:40,autoexpand:!0},barmode:"stack",xaxis:{title:""}},"main.reports-dashboard"==a.current.name&&Plotly.newPlot("prodsalesdiv",e.arr,e.srlayout))})},e.productPerformance=function(t){e.productPerformance_data=i("limitTo")(_.orderBy(t,["quantity"],["desc"]),5),e.pp={height:500,margin:{l:200,r:0,t:5,b:40,autoexpand:!0},xaxis:{title:""}},_.each(t,function(r,s){e.prod_performance[0].y.push(r.product_name),e.prod_performance[0].x.push(r.total_sales),t.length-1==s&&"main.reports-dashboard"==a.current.name&&Plotly.newPlot("prodperformancediv",e.prod_performance,e.pp)})},e.getsatbsp_div=function(t){e.arr2=[],e.user_sblayout={height:220,margin:{l:40,r:20,t:5,b:40,autoexpand:!0},xaxis:{title:""}},_.each(t,function(r,s){e.prod_user_1.x.push(r.sales_person),e.prod_user_1.y.push(r.total_sales),e.prod_user_sales.x.push(r.sales_person),e.prod_user_sales.y.push(r.total_sales),e.prod_user_discount.x.push(r.sales_person),e.prod_user_discount.y.push(r.discount),e.prod_user_itemsold.x.push(r.sales_person),e.prod_user_itemsold.y.push(r.total_items),e.prod_user_transaction.x.push(r.sales_person),e.prod_user_transaction.y.push(r.transactions),e.arr2=[e.prod_user_1,e.prod_user_sales,e.prod_user_discount,e.prod_user_itemsold,e.prod_user_transaction],s==t.length-1&&"main.reports-dashboard"==a.current.name&&Plotly.newPlot("satbsp_div",e.arr2,e.user_sblayout)})},e.calculateUserStats=function(t){e.copyOfFilteredSalesPerson=[],e.groupedBy_sales_person=_.groupBy(t,"sales_person"),e.filteredSalesPerson=i("limitTo")(_.orderBy(e.groupedBy_sales_person,["total_sales"],["desc"]),5),_.each(e.filteredSalesPerson,function(t,a){var r={sales_person:t[a].sales_person,total_sales:_.sumBy(t,"total_sales")};e.copyOfFilteredSalesPerson.push(r)})},e.updateSalesSummary=function(t){e.paramobj2={sub_id:e.sub_id_2,filterBy:t,dateFrom:e.dateFrom_2,dateTo:e.dateTo_2,timezone:e.timezone_2,arg:1},u.getDashboardSalesAndInventoryReport(e.paramobj2).then(function(a){switch(t){case"product":e.filteredSalesRep=a.response,e.selectedParam1="Product";break;case"customer":e.filteredSalesRep=a.response,e.selectedParam1="Customer";break;case"user":e.filteredSalesRep=a.response,e.selectedParam1="User";break;default:console.log("case not defined, return nothing")}})},e.updateSalesMeasures=function(e){},e.getSalesReportsByStore=function(t,a,r){e.paramobj={sub_id:e.sub_id,filterBy:t,dateFrom:a,dateTo:r,timezone:e.timezone,arg:2},u.getDashboardReport(e.paramobj).then(function(e){})},e.default_trace_format=function(){return{x:[],y:[],type:"line",fill:"tonexty",mode:"lines+markers",marker:{color:"#34a8a5"}}};e.loadSummaryReports=function(){e.srlayout={height:200,margin:{l:40,r:20,t:5,b:40,autoexpand:!0},barmode:"stack",xaxis:{title:""}},e.summary_data=[e.trace9,e.trace10,e.trace11],Plotly.newPlot("myDivSummary",e.summary_data,e.srlayout)},e.refresh=function(){p(),m(),y(),g(),e.getDashboardReports(),e.getDashboardReportsByStore(),e.getDashboardSalesReports("product"),e.getDashboardSalesReports("user"),e.getDashboardSalesReports("customer")},e.setActive=function(t){e.filterBy="",e.filterBy=t,e.refresh()},e.init=function(){"main.reports-inventory"==a.current.name?e.getDashboardInventoryReports():"main.reports-sales"==a.current.name?e.updateSalesSummary(e.selectedParam1):e.refresh()},e.init()}angular.module("POS17").controller("reportDashboardController",e),e.$inject=["$scope","$timeout","$state","$stateParams","localStorageService","toastr","productFactory","humanFactory","useraccountsFctry","usergroupsFctry","dashboardReportsFctry","$filter"]}();
!function(){"use strict";function o(o){}angular.module("POS17").controller("SalesReportController",o),o.$inject=["$scope"]}();
!function(){"use strict";function t(t,e,s,o,r,n,u,c,a){t.currentPage=1,t.itemsPerPage=4,r.getAllProduct().then(function(s){if(t.products=[],200==s.statusCode&s.response.success){var o=s.response.result;e(function(){t.$apply(function(){t.products=o}),t.totalItems=t.products.length,e(function(){t.productIsLoading=!1},2e3)},100)}}),n.getAllPerson().then(function(s){if(t.persons=[],200==s.statusCode&&s.response.result){t.totalPersonel=s.response.result.length;var o=s.response.result;e(function(){t.$apply(function(){t.persons=o}),e(function(){t.productIsLoading=!1},2e3)},100)}}),async.waterfall([function(t){c.getAllUserGroups().then(function(e){200==e.statusCode&&e.response.success?t(null,e.response.result):(o.error(e.response.msg,"Error"),t(null,"error"))})},function(s,o){u.getAllUserAccounts().then(function(o){if(t.useraccounts=[],200==o.statusCode&&o.response.success){var r=o.response.result;_.each(r,function(t){t.role_id&&(t.userRoles=_.map(t.role_id.split(","),function(t){return _.find(s,function(e){return e.role_id==t})}))}),e(function(){t.$apply(function(){t.useraccounts=r}),e(function(){t.productIsLoading=!1},2e3)},100)}})}])}angular.module("POS17").config(["$stateProvider",function(t){t.state("main.dashboard",{url:"/dashboard",templateUrl:"modules/dashboard/dashboard1.html",controller:"DashboardCtrl"})}]).controller("DashboardCtrl",t),t.$inject=["$scope","$timeout","localStorageService","toastr","productFactory","humanFactory","useraccountsFctry","usergroupsFctry","dashboardReportsFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,e){e.state("main.quotes",{url:"/quotes",templateUrl:"modules/quotes/quotes.html",controller:"quotesController"}).state("main.quotes-detail",{url:"/quotes/:quote_id",templateUrl:"modules/quotes/quotes.detail.html",controller:"quotesDetailController"}).state("main.quotesprint",{url:"/quotesprint",templateUrl:"modules/quotes/quote.report.html",controller:"quotesPrintController"})}])}();
!function(){"use strict";function e(e,t,s,a,o,l,c,n,i,u,r,d){e.selectDeselectAll=!1,e.applicationStatus="All",e.selectedDatas=[];var f=JSON.parse(u.get("user"));r.logTransaction("View Quotes","QUOTES","ALL","User:="+f.username+" View all list of Quotes");var p=function(){e.quotes=[],e.quoteTable=new c({page:1,count:10},{counts:[10,25,50,100],getData:function(t,o){i.getAllQuotes().then(function(l){if(200==l.statusCode&&l.response.success){var c=l.response.result;e.txtSearch&&"All"==e.applicationStatus?e.quotes=s("filter")(c,e.txtSearch):e.txtSearch&&"Active"==e.applicationStatus?(e.quotes=s("filter")(c,{is_active:1}),e.quotes=s("filter")(e.quotes,e.txtSearch)):e.txtSearch&&"Inactive"==e.applicationStatus?(e.quotes=s("filter")(c,{is_active:0}),e.quotes=s("filter")(e.quotes,e.txtSearch)):_.isUndefined(e.txtSearch)&&"All"==e.applicationStatus?e.quotes=c:_.isUndefined(e.txtSearch)&&"Active"==e.applicationStatus?e.quotes=s("filter")(c,{is_active:1}):_.isUndefined(e.txtSearch)&&"Inactive"==e.applicationStatus?e.quotes=s("filter")(c,{is_active:0}):e.quotes=c,o.total(e.quotes.length);var n=e.quotes.slice((o.page()-1)*o.count(),o.page()*o.count());t.resolve(n)}else a.error(l.response.msg,"Error")})}})};p(),e.refresh=function(){e.quoteTable.reload()},e.edit=function(e){t.go("main.quotes-detail",{quote_id:e})},e.updateStatus=function(t){e.applicationStatus=t,e.quoteTable.reload()},e.searchData=function(){e.quoteTable.reload()},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.quotes,function(t){t.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.quote_id===t.quote_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.quote_id!==t.quote_id}),e.deleteSomeData=e.selectedDatas.length>0},e.deleteSelected=function(){n.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var s=0;async.each(e.selectedDatas,function(o,l){o.selected&&i.deleteQuoteInfo(o.quote_id).then(function(o){return 200==o.statusCode&&o.response.success?(a.success(o.response.msg,"Success"),++s,s==e.selectedDatas.length&&t.reload(),l(),void 0):void a.error(o.response.msg,"Error")})})})}}angular.module("POS17").controller("quotesController",e),e.$inject=["$scope","$state","$filter","toastr","$timeout","$stateParams","ngTableParams","ngDialog","quoteFactory","localStorageService","transLogFctry","$uibModal"]}();
!function(){"use strict";function e(e,t,s,o,i,r,a,u,d,n,l,c,p,g,m,f,h,y,q){console.log("quotesDetailController:"),e.persons=[],e.store=[],e.products=[],e.countries=[],e.currencies=[],e.productBundles=[],e.items={},e.tags=[],e.tagsArr=[],e.details={},e.details.subtotal=0,e.details.other_fee=0,e.details.tax=0,e.details.quoteproduct_list=[],e.details.tags=[],e.itemList=[],e.radioModel="product",e.billingAddress=!1,e.shippingAddress=!1;var b=JSON.parse(m.get("user"));r.quote_id?q.logTransaction("View Quotes","QUOTES",r.quote_id,"User:="+b.username+" View quote details:="+r.quote_id):q.logTransaction("Add New Quotes","QUOTES","N/A","User:="+b.username+" Add new quote entry"),y.getAllCountries().then(function(t){200==t.statusCode&&t.response.success&&(e.countries=t.response.result)}),h.getAllCurrencies().then(function(t){if(200==t.statusCode&&t.response.success){var s=t.response.result;e.currencies=s}else o.error(t.response.msg,"Error")}),n.getAllPerson().then(function(t){200==t.statusCode&&t.response.success?(e.persons=t.response.result,e.details.person_id=e.persons[0].person_id):o.error(t.response.msg,"Error")}),l.getAllStore().then(function(t){200==t.statusCode&&t.response.success?e.store=t.response.result:o.error(t.response.msg,"Error")}),c.getAllProduct().then(function(t){if(200==t.statusCode&&t.response.success){var s=t.response.result;_.each(s,function(t){0==t.is_archived&&e.products.push(t)})}}),c.getAllProductBundle().then(function(t){if(200==t.statusCode&&t.response.success){var s=t.response.result;_.each(s,function(t){1!==t.is_archived&&e.productBundles.push(t)})}}),f.getAllTags().then(function(t){200==t.statusCode&&t.response.success?e.tagsArr=t.response.result:o.error(t.response.msg,"Error")}),r.quote_id&&g.getDetailQuote(r.quote_id).then(function(t){if(200==t.statusCode&&t.response.success){e.details=t.response.result,e.detailcopy=angular.copy(t.response.result),e.details.customer=e.details.bill_qoute_info,e.details.quoteproduct_list=[];var s=e.details.quote_item_list;_.each(s,function(t){_.isNull(t.product_id)||e.details.quoteproduct_list.push({item_name:t.product_details.item_name,quantity:t.quantity,price:t.price,discount:t.discount,total:(t.price-t.discount)*t.quantity,product_id:t.product_id,bundle_id:null}),_.isNull(t.bundle_id)||e.details.quoteproduct_list.push({item_name:t.bundle_details.bundle_name,quantity:t.quantity,price:t.price,discount:t.discount,total:(t.price-t.discount)*t.quantity,product_id:null,bundle_id:t.bundle_id})}),console.log("$scope.details: ",e.details)}f.getAllQuoteTags(r.quote_id).then(function(t){200==t.statusCode&&t.response.success&&(e.details.tags=t.response.result)})}),e.changeData=function(t){e.radioModel=t},e.tagTransform=function(e){return{tags:e}},e.clearInput=function(e){e.search=""},e.addToList=function(t){console.log("$scope.radioModel:",e.radioModel),"product"==e.radioModel?_.isUndefined(t.product)||_.isEmpty(t.product)||(_.find(e.details.quoteproduct_list,{product_id:t.product.p_id})?o.warning("Product Item already existed","Warning"):e.details.quoteproduct_list.push({item_name:t.product.item_name,quantity:t.quantity,price:t.price,discount:t.discount,total:t.total,product_id:t.product.p_id,bundle_id:null})):"productgroup"==e.radioModel&&(console.log("SURE"),_.isUndefined(t.productgroup)||_.isEmpty(t.productgroup)||(_.find(e.details.quoteproduct_list,{product_id:t.productgroup.p_id})?o.warning("Bundle Item already existed","Warning"):e.details.quoteproduct_list.push({item_name:t.productgroup.bundle_name,quantity:t.quantity,price:t.price,discount:t.discount,total:t.total,product_id:null,bundle_id:t.productgroup.pb_id}))),t.product=null,t.productgroup=null,t.quantity=0,t.price=0,t.discount=0,t.total=0,console.log("$scope.details.quoteproduct_list: ",e.details.quoteproduct_list),e.calculateItems()},e.calculateItem=function(e){var t=0,s=0,o=e.price-e.discount;return s=o*e.quantity,t+=parseFloat(s),e.total=t,e.total},e.calculateItems=function(){var t=0,s=0;_.each(e.details.quoteproduct_list,function(e){var o=e.price-e.discount;t=o*e.quantity,s+=parseFloat(t)}),e.details.sub_total=s,e.calculateBilling()},e.calculateBilling=function(){e.details.total_fee=parseFloat(e.details.sub_total||0)+parseFloat(e.details.tax||0)+parseFloat(e.details.other_fee||0)},e.removeItem=function(t){e.details.quoteproduct_list.splice(t,1),e.calculateItems()},e.deleteQuoteTag=function(e){r.quote_id&&f.deleteQuoteTag(r.quote_id,e.tags_id).then(function(e){return 200==e.statusCode&&e.response.success?void o.success(e.response.msg,"Success"):void o.error(e.response.msg,"Error")})},e.useBillingAddress=function(t){t?(e.details.ship_to_name=e.details.bill_to_name,e.details.ship_to_address=e.details.bill_to_address,e.details.ship_to_state=e.details.bill_to_state,e.details.ship_to_zipcode=e.details.bill_to_zipcode,e.details.ship_to_country=e.details.bill_to_country):(e.details.ship_to_name=e.detailcopy.ship_to_name,e.details.ship_to_address=e.detailcopy.ship_to_address,e.details.ship_to_state=e.detailcopy.ship_to_state,e.details.ship_to_zipcode=e.detailcopy.ship_to_zipcode,e.details.ship_to_country=e.detailcopy.ship_to_country)},e.useCustomerAddress=function(t){t&&e.details.customer?(e.details.bill_to_address=e.details.customer.address,e.details.bill_to_state=e.details.customer.state,e.details.bill_to_zipcode=e.details.customer.zipcode,e.details.bill_to_country=e.details.customer.country):(e.details.bill_to_address="",e.details.bill_to_state="",e.details.bill_to_zipcode="",e.details.bill_to_country="")},e.saveQuoteInfo=function(){var s=JSON.parse(m.get("user"));e.details.staff_id=s.uc_id,e.details.store_id=e.details.store.store_id,e.details.customer_id=e.details.customer.person_id,e.details.ship_to=e.details.customer.person_id,e.details.currency_id=e.details.currency_id,e.details.quote_status="P",e.details.quote_date=new Date,console.log("$scope.details: ",e.details),async.waterfall([function(t){g.saveQuoteInfo(e.details).then(function(e){if(200==e.statusCode&&e.response.success)o.success(e.response.msg,"Success"),t(null,e.response.result);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void o.error(e.response.msg,"Error");_.each(e.response.result,function(e){o.warning(e.msg,"Warning")})}})},function(t,s){console.log("dri bai");var i=0;e.details.tags.length>0?async.eachSeries(e.details.tags,function(r,a){r.isTag?f.saveTags(r).then(function(e){return 200==e.statusCode&&e.response.success?void f.saveQuoteTags(t,{tag_id:e.response.result}).then(function(e){return 200==e.statusCode&&e.response.success?(i++,void a()):void o.error(e.response.msg,"Error")}):void o.error(e.response.msg,"Error")}):f.saveQuoteTags(t,{tag_id:r.tags_id}).then(function(e){return 200==e.statusCode&&e.response.success?(i++,void a()):void o.error(e.response.msg,"Error")}),i>=e.details.tags.length&&s(null,t)}):s(null,t)},function(e,s){i(function(){t.go(t.current,{quote_id:e},{reload:!0})},300)}])}}angular.module("POS17").controller("quotesDetailController",e),e.$inject=["$scope","$state","$filter","toastr","$timeout","$stateParams","ngTableParams","ngDialog","$uibModal","humanFactory","storeFactory","productFactory","categoryFactory","quoteFactory","localStorageService","tagsFactory","currencyFactory","countryFactory","transLogFctry"]}();
!function(){"use strict";function t(t,e,o,l,n,i,s,a){t.printQoute=function(){a.print()},t.updateBillingAddress=function(){t.modal={title:"Update Billing Address",message:"Are you sure to update Billing Address?"},s.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:t,className:"ngdialog-theme-default"}).then(function(){},function(t){console.log("Modal promise close: ")})}}angular.module("POS17").controller("quotesPrintController",t),t.$inject=["$scope","$state","$filter","toastr","$timeout","$stateParams","ngDialog","$window"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(r,e){e.state("main.purchase_order",{url:"/purchaseorder",templateUrl:"modules/purchase_order/purchase_order.html",controller:"purchaseOrderController"}).state("main.add_order",{url:"/purchaseorder/:selected_id",templateUrl:"modules/purchase_order/addor.html",controller:"addOrderController"}).state("main.list",{url:"/purchaseorder/hold",templateUrl:"modules/purchase_order/producthold.html",controller:"holdController"}).state("main.productlist",{url:"/purchaseorder/productList",templateUrl:"modules/purchase_order/productList.html",controller:"productsController"}).state("main.stock",{url:"/purchaseorder/stocks",templateUrl:"modules/purchase_order/stocks.html",controller:"stocksController"}).state("main.view_savepo",{url:"/purchaseorder/:selected_id/view_savepo/:store_id",templateUrl:"modules/purchase_order/purchase_order-view.html",controller:"viewSavedPOController"})}])}();
!function(){"use strict";function e(e,r,s,t,a,o,n,c){e.puchaseorders=[];var l=JSON.parse(t.get("user"));a.logTransaction("View Purchase Orders","PURCHASE ORDER","ALL","User:="+l.username+" View all list of Inventory - Purchase Order"),e.datenow=moment(new Date).format("MMM Do YYYY, h:mm:ss a"),e.updatePurchaseOrder=function(e,r){console.log("id",e),console.log("data",r)},e.parseDate=function(e){if(e)return moment(new Date(e)).format("MMM Do YYYY")},e.toggleModal=function(s){c.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){r.deletePurchaseOrder(s).then(function(e){return 200==e.statusCode&&e.response.success?(n.success(e.response.msg,"Success"),void o.reload()):(console.log("data.response;",e),void n.error(e.response.msg,"Error"))})},function(e){console.log("Modal promise close: ")})};var i=function(){e.puchaseordersisLoading=!0,e.puchaseorders=[],e.paginate={offset:0,limit:10},e.puchaseordersTable=new s({page:1,count:10},{counts:[10,25,50,100],getData:function(s,t){r.getAllPurchaseOrder(e.paginate).then(function(r){if(200==r.statusCode&&r.response.success){var a=r.response.result;e.txtSearch&&"All"==e.applicationStatus?e.puchaseorders=$filter("filter")(a,e.txtSearch):e.txtSearch&&"Published"==e.applicationStatus?(e.puchaseorders=$filter("filter")(a,{status:1}),e.puchaseorders=$filter("filter")(e.puchaseorders,e.txtSearch)):e.txtSearch&&"Unpublished"==e.applicationStatus?(e.puchaseorders=$filter("filter")(a,{status:0}),e.puchaseorders=$filter("filter")(e.puchaseorders,e.txtSearch)):_.isUndefined(e.txtSearch)&&"All"==e.applicationStatus?e.puchaseorders=a:_.isUndefined(e.txtSearch)&&"Published"==e.applicationStatus?e.puchaseorders=$filter("filter")(a,{status:1}):_.isUndefined(e.txtSearch)&&"Unpublished"==e.applicationStatus?e.puchaseorders=$filter("filter")(a,{status:0}):e.puchaseorders=a,t.total(e.puchaseorders.length);var o=e.puchaseorders.slice((t.page()-1)*t.count(),t.page()*t.count());s.resolve(o),e.puchaseordersisLoading=!1}else n.error(r.response.msg,"Error")})}})};i()}angular.module("POS17").controller("purchaseOrderController",e),e.$inject=["$scope","purchaseOrderFactory","ngTableParams","localStorageService","transLogFctry","$state","toastr","ngDialog"]}();
!function(){"use strict";function e(e,t,s,o,r,i,n,l,a,d,u,c,p,f,m,g,h){function v(t){if(t)return _.find(e.suppliers,function(e){return e.s_id==t})}function y(){e.items.quantity=null,e.items.price=null,e.items.total=null,e.items.product=null}function P(t){_.each(e.details.details,function(s,o){var r=[{store_id:e.details.store_id,stockTrackQty:0,stockTrackLevel:0,p_id:s.product_id,sales_unit_id:1,purchase_unit_id:null,qty_convert:null,inv_id:null,stockTrack:!0}];d.assignStore(s.product_id,r).then(function(e){e&&200===e.statusCode&&e.response.success?console.log("done ",s.product_id):console.log("problems in ",s.product_id)}),e.details.details.length-1==o&&t(!0)})}e.isColl=!1,e.radioModel="product",e.products=[],e.productBundles=[],e.items={},e.suppliers=[],e.customers=[],e.stores=[],e.details={},e.details.details=[],e.details.products_list=[],e.details.emailsubject;var b=!1,M=5e3;e.showMessage=!1,e.showsecondMessage=!1,e.showExportMessage=!1,e.enAbleToSendForm,e.profile={},e.stores.selected={},e.datenow=h(new Date).format("MMMM Do YYYY"),e.doGreeting=function(){b&&l.cancel(b),e.showMessage=!0,b=l(function(){e.showMessage=!1,e.showsecondMessage=!0,b=l(function(){e.showsecondMessage=!1},2e3)},M)},e.doExport=function(){b&&l.cancel(b),e.showExportMessage=!0,b=l(function(){e.showExportMessage=!1,e.showsecondExportMessage=!0,b=l(function(){e.showsecondExportMessage=!1},2e3)},M)},e.changeData=function(t){e.radioModel=t},e.getoveralltotal=function(t){e.overalltotal=_.sumBy(t,function(e){return e.price*(e.quantity_ordered||e.quantity)})},e.getGeneratedPOId=function(){f.generatepoid().then(function(t){e.details.po_number=t.response.result})},e.loadpo=function(){f.getAllPurchaseOrderDetail(i.selected_id).then(function(t){t&&200==t.statusCode&&t.response.success&&(e.details=t.response.result,e.details.emailsubject="PO Number "+e.details.po_number,e.getoveralltotal(e.details.details))})},e._getAllProducts=function(){d.getAllProduct().then(function(t){if(t&&200==t.statusCode&&t.response.success){t.response.result;e.products=t.response.result,e.filteredProducts=_.filter(e.products,function(t){return t.store_id==e.details.store_id})}})},e._getAllProductsOnLoad=function(){d.getAllProduct().then(function(t){if(t&&200==t.statusCode&&t.response.success){t.response.result;e.products=_.filter(t.response.result,{is_published:1})}})},e.getCurrentUser=function(){t.userprofile().then(function(t){if(200==t.statusCode&&t.response.success)e.profile=t.response.result,e.currentemail=t.response.result.profile.email,e.details.currentemail=t.response.result.profile.email;else if(400==t.statusCode&&!t.response.success)return void a.error(t.response.msg,"Error")})},u.getAllSuppliers().then(function(t){t&&200==t.statusCode&&t.response.success&&(e.suppliers=t.response.result)}),p.getAllPerson().then(function(t){t&&200==t.statusCode&&t.response.success&&(e.customers=_.filter(t.response.result,function(e){return 2==e.per_type_id}))}),e._getAllStore=function(){m.getAllStore().then(function(t){t&&200==t.statusCode&&t.response.success&&(e.stores=t.response.result,i.selected_id||(e.stores.unshift({store_id:0,name:"--select store--"}),e.details.store_id=0))})},d.getAllProductBundle().then(function(t){if(t&&200==t.statusCode&&t.response.success){var s=t.response.result;_.each(s,function(t){1!==t.is_archived&&e.productBundles.push(t)})}}),e.setSelectedStore=function(t){e.stores.selected=t,e.filteredProducts=_.filter(e.products,function(e){return e.store_id==t})},e.calculateItem=function(e){var t=0,s=0,s=e.price*e.quantity;return t+=parseFloat(s),e.total=t,e.total},e.parseDate=function(e){if(e)return h(new Date(e)).format("MMMM Do YYYY")},e.toast_emailnotifs=function(e){"Sent"==e||"sent"==e?a.success("Email Sent","Success"):a.warning("Email not Sent","Warning")},e.currentPage=1,e.entryLimit=5,e.selectDeselectAll=!1,e.applicationStatus="All",e.displayModel="List",e.viewby=25,e.pageSize=e.viewby,e.currentPage=1,e.itemsPerPage=20,e.totalUsers=0,e.addToList=function(t){_.isEmpty(t)?a.warning("Product list could not empty","Warning"):"product"==e.radioModel?_.isUndefined(t)||(e.details.details.push({item_name:t.product.item_name,quantity_ordered:t.quantity,quantity:t.quantity,price:t.price,discount:t.discount,total:t.total,product_id:t.product.p_id,bundle_id:null,total_cost:t.quantity*t.price,direct_sending:!0}),e.details.products_list=e.details.details,e.getoveralltotal(e.details.details),y()):"productgroup"==e.radioModel&&(_.isUndefined(t.productgroup)||(e.details.details.push({item_name:t.productgroup.bundle_name,quantity:t.quantity,quantity_ordered:t.quantity,price:t.price,discount:t.discount,total:t.total,product_id:null,bundle_id:t.productgroup.pb_id,total_cost:t.quantity*t.price,direct_sending:!0}),e.getoveralltotal(e.details.details),y()))},e.approvedPO=function(e){var t={approved_by:e};f.approvedPurchasedOrder(i.selected_id,t).then(function(e){e&&200==e.statusCode&&e.response.success?a.success(e.response.msg,"Success"):a.error(e?e.response.msg:"Error Found","Eror")})},e.savePO=function(t){P(function(o){if(o){var r=JSON.parse(s.get("user"));e.details.created_by=r.uc_id,e.details.emailmessage="",e.details.toSend=t,e.details.supplier_id&&e.details.deliver_to&&e.details.po_number?(e.details.suppliername=v(e.details.supplier_id).name,i.selected_id?f.updatePurchaseOrder(i.selected_id,e.details).then(function(s){if(s&&200==s.statusCode&&s.response.success){a.success(s.response.msg,"Success");i.selected_id;t&&e.approvedPO(i.selected_id),n.go("main.view_savepo",{selected_id:i.selected_id,store_id:e.details.store_id})}else a.error(s?s.response.msg:"Error Found","Eror");t?e.toast_emailnotifs(s&&s.response.email?s.response.email:"Error Found"):""}):f.savePurchaseOrder(e.details).then(function(s){if(s&&200==s.statusCode&&s.response.success){a.success(s.response.msg,"Success");var o=s.response.result.inserted_po_id;t&&e.approvedPO(o),n.go("main.view_savepo",{selected_id:o,store_id:e.details.store_id})}else a.error(s?s.response.msg:"Error Found","Eror");t?e.toast_emailnotifs(s&&s.response.email?s.response.email:"Error Found"):""})):a.warning("Fill in all the required fields in the first tab","Warning")}})},e.toggleModal=function(){g.openConfirm({templateUrl:"modules/dialog/cancelDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){e.backto_fstpasge()},function(e){})},e.calculateBilling=function(){e.total=parseFloat(e.details.sub_total||0)+parseFloat(e.details.tax||0)+parseFloat(e.details.shipping_fee||0)},e.removeProduct=function(t){e.details.details.splice(t,1),e.details.products_list=e.details.details,e.getoveralltotal(e.details.details)},e.edit=function(e){n.go("main.products-add",{p_id:e})},e.openPOUpdateModal=function(t){e.enAbleToSendForm=t,t?e.details.po_status="Sent":e.details.po_status="Open",e.details.emailsubject="PO Number "+e.details.po_number,g.openConfirm({templateUrl:"./modules/purchase_order/po.update.modal.html",scope:e,className:"ngdialog-theme-default",appendClassName:"ngdialog-custom",width:"40%"}).then(function(){e.savePO(t)},function(e){console.log("Modal promise close: ")})},e.open_scndpage=function(){e.fstpasge=!1,e.scndpage=!0},e.onSelectedProduct=function(t){e.items.price=t.sell_price},e.goback=function(){n.go("main.purchase_order")},e.isQtyNotANumber=function(t){return null==t||void 0==t||""==t||isNaN(t)?(e.items.quantity="",!0):(e.items.quantity=t,!1)},e.isPriceNotANumber=function(t){return null==t||void 0==t||""==t||isNaN(t)?(e.items.price="",!0):(e.items.price=t,!1)},e.init=function(){e.getCurrentUser(),e._getAllProductsOnLoad(),i.selected_id?(e.loadpo(),e._getAllProducts()):e.getGeneratedPOId(),e._getAllStore()},e.init()}angular.module("POS17").controller("addOrderController",e),e.$inject=["$scope","AuthFctry","localStorageService","$http","$filter","$stateParams","$state","$timeout","toastr","productFactory","supplierFctry","ngTableParams","humanFactory","purchaseOrderFactory","storeFactory","ngDialog","moment"]}();
!function(){"use strict";function t(t,o){t.value=o.value,t.fetch=function(){o.callFunction(),t.value=o.value}}function o(t,o){o.callFunction=function(){alert("Function Called Successfully"),o.value="Edoy"}}angular.module("POS17").controller("testCtrl",t).controller("testRootCtrl",o),t.$inject=["$scope","$rootScope"],o.$inject=["$scope","$rootScope"]}();
!function(){"use strict";function o(o){}angular.module("POS17").controller("holdController",o),o.$inject=["$scope"]}();
!function(){"use strict";function t(t,e,r,c,o,i,a,s,n){function u(){s.getAllCategory().then(function(e){if(200==e.statusCode&&e.response.success){for(var r=e.response.result,c=0;c<r.length;c++){var o=r[c],i=o.name,a=o.parent_id,s=o.c_id;d[a]?(o={parentid:a,label:i,item:o},null!=o&&(d[a].items||(d[a].items=[]),d[a].items[d[a].items.length]=o,d[s]=o)):(d[s]={parentid:s,label:i,item:o},l[s]=d[s])}t.categoryData=_(l).omit(_.isUndefined).omit(_.isNull).value(),t.categorycopy=angular.copy(t.categoryData)}})}t.search={},t.currentPage=1,t.entryLimit=5,t.selectDeselectAll=!1,t.applicationStatus="All",t.displayModel="List",t.viewby=25,t.pageSize=t.viewby,t.currentPage=1,t.itemsPerPage=20,t.totalUsers=0,t.categories=[];var l=[],d=[];t.side=!1,u();var p=function(){t.$watch("mytree.currentNode",function(e,r){var c=[],i={},a={};t.category=[],t.tree=[],t.currentNode=[];var s=[];if(t.mytree&&angular.isObject(t.mytree.currentNode)){t.currentNode=t.mytree.currentNode.item;var n=_.find(t.categorycopy,{parentid:t.currentNode.c_id});if(console.log("sample2:",n),_.isUndefined(n)){var u=_.map(t.productscopy,function(e){var r=_.filter(e.product_category,{category_id:t.currentNode.c_id});if(r.length>0)return _.find(r,function(t){return t})});console.log("product_categories:",u),a=_.filter(u,function(t){if(!_.isUndefined(t))return t}),console.log("product_categories2:",a),i=_.map(_.uniqBy(a,"product_id"),function(t){return t.product_id}),_.forEach(i,function(e){c.push(_.find(t.productscopy,{p_id:e}))})}else{var l=_.map(n.items,function(t){return{c_id:t.item.c_id}});_.each(t.productscopy,function(t){_.each(l,function(e){var r=_.filter(t.product_category,{category_id:e.c_id});r&&r.length>0&&s.push(r[0])})});var d=_.map(_.uniqBy(s,"product_id"),function(t){return t.product_id});_.forEach(d,function(e){c.push(_.find(t.productscopy,{p_id:e}))})}o(function(){t.$apply(function(){t.productTable.reload()})},100)}},!1)},f=function(){t.productIsLoading=!0,t.products=[],t.productscopy=[],t.productTable=new n({page:1,count:10},{counts:[10,25,50,100],getData:function(e,c){a.getAllProduct().then(function(o){if(200==o.statusCode&&o.response.success){var a=o.response.result;t.totalItems=a.length,t.productscopy=angular.copy(t.products),t.txtSearch&&"All"==t.applicationStatus?t.products=r("filter")(a,t.txtSearch):t.txtSearch&&"Publish"==t.applicationStatus?(t.products=r("filter")(a,{is_published:1}),t.products=r("filter")(t.products,t.txtSearch)):t.txtSearch&&"Archived"==t.applicationStatus?(t.products=r("filter")(a,{is_archived:1}),t.products=r("filter")(t.products,t.txtSearch)):t.txtSearch&&"Draft"==t.applicationStatus?(t.products=r("filter")(a,{is_published:0}),t.products=r("filter")(t.products,t.txtSearch)):_.isUndefined(t.txtSearch)&&"All"==t.applicationStatus?t.products=a:_.isUndefined(t.txtSearch)&&"Publish"==t.applicationStatus?t.products=r("filter")(a,{is_published:1}):_.isUndefined(t.txtSearch)&&"Archived"==t.applicationStatus?t.products=r("filter")(a,{is_archived:1}):_.isUndefined(t.txtSearch)&&"Draft"==t.applicationStatus?t.products=r("filter")(a,{is_published:0}):t.products=a,c.total(t.products.length);var s=t.products.slice((c.page()-1)*c.count(),c.page()*c.count());e.resolve(s),t.productIsLoading=!1}else t.productIsLoading=!1,i.error(o.response.msg,"Error")})}})};s.getAllCategory().then(function(e){200==e.statusCode&&e.response.success&&(t.categories=e.response.result)}),t.setPage=function(e){t.currentPage=e},t.setItemsPerPage=function(e){t.itemsPerPage=e,t.currentPage=1},t.edit=function(t){c.go("main.products-add",{p_id:t})},t.searchData=function(){t.productTable.reload()},t.refresh=function(){t.productIsLoading=!0,t.productTable.reload()},t.updateStatus=function(e){console.log("status: ",e),t.applicationStatus=e,t.productTable.reload()},t.changeSelectDeselectAll=function(){t.selectDeselectAll=!t.selectDeselectAll,_.each(t.products,function(e){e.selected=t.selectDeselectAll})},s.getAllCategory().then(function(e){200==e.statusCode&&e.response.success&&(t.categories=e.response.result)}),p(),f()}angular.module("POS17").controller("productListController",t),t.$inject=["$scope","$http","$filter","$state","$timeout","toastr","productFactory","categoryFactory","ngTableParams"]}();
!function(){"use strict";function t(t,s,e,a,o){t.applicationStatus="All";var c=function(){t.stocksisLoading=!0,t.stocks=[],t.stocksTable=new a({page:1,count:10},{counts:[10,25,50,100],getData:function(s,a){e.getAllInventory().then(function(e){if(200==e.statusCode&&e.response.success){var c=e.response.result;_.each(c,function(t){return new Date(t.expiration_date)}),console.log("data.response.result:",e.response.result),t.txtSearch&&"All"==t.applicationStatus?t.stocks=o("filter")(c,t.txtSearch):t.txtSearch&&"Published"==t.applicationStatus?(t.stocks=o("filter")(c,{status:1}),t.stocks=o("filter")(t.stocks,t.txtSearch)):t.txtSearch&&"Unpublished"==t.applicationStatus?(t.stocks=o("filter")(c,{status:0}),t.stocks=o("filter")(t.stocks,t.txtSearch)):_.isUndefined(t.txtSearch)&&"All"==t.applicationStatus?t.stocks=c:_.isUndefined(t.txtSearch)&&"Published"==t.applicationStatus?t.stocks=o("filter")(c,{status:1}):_.isUndefined(t.txtSearch)&&"Unpublished"==t.applicationStatus?t.stocks=o("filter")(c,{status:0}):t.stocks=c,a.total(t.stocks.length);var n=t.stocks.slice((a.page()-1)*a.count(),a.page()*a.count());s.resolve(n),t.stocksisLoading=!1}else toastr.error(e.response.msg,"Error")})}})};t.refresh=function(){t.stocksTable.reload()},t.updateStatus=function(s){t.applicationStatus=s,t.stocksTable.reload()},t.searchData=function(){t.stocksTable.reload()},c()}angular.module("POS17").controller("stocksController",t),t.$inject=["$scope","$rootScope","inventoryFactory","ngTableParams","$filter"]}();
!function(){"use strict";function e(e,t,s,r,a,n,o,i,l,d,c,p,u,m,f,g,h,v){function S(){var t=[];_.each(e.details,function(e){t.push({product_id:e.product_id,price:e.splycst,quantity:e.qtyrecv,quantity_ordered:e.quantity_ordered,stock_onhand:e.stock_onhand,fk_store_id:n.store_id})});return t}e.datenow=h(new Date).format("MMMM Do YYYY"),e.parent_details={},e.details=[],e.po_status="",e.po_id="",e.enAbleToSendForm,e.params={},e.params.arrOfPOIds=[],e.details2=[],e.specialVar1=[],e.specialVar2=[],n.selected_id&&(e.po_id=n.selected_id,m.getAllPurchaseOrderDetail(e.po_id).then(function(t){if(t&&200==t.statusCode&&t.response.success){e.parent_details=t.response.result,e.details=t.response.result.details,e.parent_details.products_list=e.details,e.parent_details.emailsubject="PO Number "+e.parent_details.po_number,e.fstpasge=!1,e.scndpage=!0,e.getoveralltotal(e.details);var s=e.parent_details.po_status;"Open"==s||"open"==s||"OPEN"==s?e.po_status="Saved":"Sent"==s||"sent"==s||"SENT"==s?e.po_status="Sent":e.po_status=s,_.each(e.details,function(t,s){e.details[s].splycst=t.price})}else console.log("no data fetched !")}),e.getoveralltotal=function(t){e.overalltotal=_.sumBy(t,function(e){return e.price*e.quantity_ordered})},e.parseDate=function(e){if(e)return h(new Date(e)).format("MMMM Do YYYY")},e.backto_fstpasge=function(){g.openConfirm({templateUrl:"modules/dialog/cancelDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){e.fstpasge=!0,e.scndpage=!1;n.selected_id;o.go("main.purchase_order")},function(e){console.log("reason ",e)})},e.getCurrentUser=function(){t.userprofile().then(function(t){if(200==t.statusCode&&t.response.success)e.profile=t.response.result,e.currentemail=e.profile.profile.email,e.parent_details.currentemail=e.profile.profile.email;else if(400==t.statusCode&&!t.response.success)return void l.error(t.response.msg,"Error")})},e.toast_emailnotifs=function(e){"Sent"==e||"sent"==e?l.success("Email Sent","Success"):l.warning("Email not Sent","Warning")},e.cancelPO=function(){g.openConfirm({templateUrl:"modules/dialog/cancelDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=JSON.parse(s.get("user"));e.parent_details.created_by=t.uc_id,e.parent_details.suppliername=e.parent_details.supplier.name,e.parent_details.po_status="Cancelled",e.parent_details.products_list=e.details,e.parent_details.supplier_id&&e.parent_details.deliver_to&&e.parent_details.po_number?n.selected_id?m.updatePurchaseOrder(n.selected_id,e.parent_details).then(function(e){e&&200==e.statusCode&&e.response.success?(l.success("PO status Cancelled","Success"),o.reload()):l.error(e?e.response.msg:"Error Found","Eror")}):m.savePurchaseOrder(e.parent_details).then(function(e){e&&200==e.statusCode&&e.response.success?l.success("PO status Cancelled","Success"):l.error(e?e.response.msg:"Error Found","Eror")}):l.warning("Fill in all the required fields in the first tab","Warning")},function(e){console.log("reason ",e)})},e.approvedPO=function(){var e={approved_by:n.selected_id};m.approvedPurchasedOrder(n.selected_id,e).then(function(e){e&&200==e.statusCode&&e.response.success?l.success(e.response.msg,"Success"):l.error(e?e.response.msg:"Error Found","Eror")})},e.savePO2=function(t){var r=JSON.parse(s.get("user"));e.parent_details.created_by=r.uc_id,e.parent_details.po_status="Sent",e.parent_details.toSend=t,e.parent_details.products_list=e.details,e.parent_details.supplier_id&&e.parent_details.deliver_to&&e.parent_details.po_number?(e.parent_details.suppliername=e.parent_details.supplier.name,n.selected_id&&m.updatePurchaseOrder(n.selected_id,e.parent_details).then(function(s){if(s&&200==s.statusCode&&s.response.success){l.success(s.response.msg,"Success");n.selected_id;t&&(e.approvedPO(),o.reload())}else l.error(s?s.response.msg:"Error Found","Eror");t?e.toast_emailnotifs(s&&s.response.email?s.response.email:"Error Found"):""})):l.warning("Fill in all the required fields in the first tab","Warning")},e.openPOUpdateModal2=function(t){e.enAbleToSendForm=t,e.parent_details.po_status="",g.openConfirm({templateUrl:"./modules/purchase_order/po.sendsaved.modal.html",scope:e,className:"ngdialog-theme-default",appendClassName:"ngdialog-custom",width:"40%"}).then(function(){e.savePO2(t)},function(e){console.log("Modal promise close: ")})},e.updateReceiveItemScope=function(t,s){e.details[s].qtyrecv=e.specialVar1[s]},e.updateSupplyCostScope=function(t,s){e.details[s].splycst=e.specialVar2[s]},e.promptMsg1=function(t){e.specialVar1[t]="",l.warning("Receive count must be less than or equal to number of items ordered","Warning")},e.checkSpecialVar1=function(){var t=_.find(e.specialVar1,"");return t},e.receivePO=function(){e.obj={po_id:n.selected_id,receive_number:"",receive_date:h(new Date).format("MMMM Do YYYY, h:mm:ss a"),received_by:e.profile.profile.person_id,supplier_id:e.parent_details.supplier_id,products_list:S(),store_id:n.store_id},m.receivePurchasedOrder(e.obj).then(function(e){e&&200==e.statusCode&&e.response.success?(l.success(e.response.msg,"Success"),o.reload()):l.error(e?e.response.msg:"Error Found","Eror")})},e.reactivatePO=function(){l.warning("This Feature is not yet implemented..","Warning")},e.init=function(){e.getCurrentUser()},e.init())}angular.module("POS17").controller("viewSavedPOController",e),e.$inject=["$scope","AuthFctry","localStorageService","$http","$filter","$stateParams","$state","$timeout","toastr","productFactory","supplierFctry","ngTableParams","humanFactory","purchaseOrderFactory","storeFactory","ngDialog","moment"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(e,r){r.state("main.received_order",{url:"/receivedorder",templateUrl:"modules/received_order/received_order.html",controller:"receivedOrderController"}).state("main.rec_order",{url:"/recorder/rec_order",templateUrl:"modules/received_order/recOrder.html",controller:"recOrderController"}).state("main.rec_list",{url:"/recorder/receivedorderList",templateUrl:"modules/received_order/receivedHolder.html",controller:"receivedholdController"})}])}();
!function(){"use strict";function e(e,r,t,a,o,i){e.applicationStatus="All";var c=JSON.parse(o.get("user"));i.logTransaction("View Receivings","RECEIVED ORDER","ALL","User:="+c.username+" View all list of Inventory - Received Order");var d=function(){e.receivedorderisLoading=!0,e.receivedorder=[],e.receivedorderTable=new t({page:1,count:10},{counts:[10,25,50,100],getData:function(t,o){r.getAllPurchaseOrder().then(function(r){if(200==r.statusCode&&r.response.success){var i=r.response.result;console.log("receivedorder:",i),e.txtSearch&&"All"==e.applicationStatus?e.receivedorder=a("filter")(i,e.txtSearch):e.txtSearch&&"Approved"==e.applicationStatus?(e.receivedorder=a("filter")(i,{po_status:"Open"}),e.receivedorder=a("filter")(e.receivedorder,e.txtSearch)):e.txtSearch&&"Unapproved"==e.applicationStatus?(e.receivedorder=a("filter")(i,{po_status:"Closed"}),e.receivedorder=a("filter")(e.receivedorder,e.txtSearch)):_.isUndefined(e.txtSearch)&&"All"==e.applicationStatus?e.receivedorder=i:_.isUndefined(e.txtSearch)&&"Approved"==e.applicationStatus?e.receivedorder=a("filter")(i,{po_status:"Open"}):_.isUndefined(e.txtSearch)&&"Unapproved"==e.applicationStatus?e.receivedorder=a("filter")(i,{po_status:"Closed"}):e.receivedorder=i,o.total(e.receivedorder.length);var c=e.receivedorder.slice((o.page()-1)*o.count(),o.page()*o.count());t.resolve(c),e.receivedorderisLoading=!1}else toastr.error(r.response.msg,"Error")})}})};e.updateStatus=function(r){e.applicationStatus=r,e.receivedorderTable.reload()},e.searchData=function(){e.receivedorderTable.reload()},d()}angular.module("POS17").controller("receivedOrderController",e),e.$inject=["$scope","purchaseOrderFactory","ngTableParams","$filter","localStorageService","transLogFctry"]}();
!function(){"use strict";function r(r){}angular.module("POS17").controller("recOrderController",r),r.$inject=["$scope"]}();
!function(){"use strict";function e(e){}angular.module("POS17").controller("receivedholdController",e),e.$inject=["$scope"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(r,e){e.state("main.return_order",{url:"/returnorder",templateUrl:"modules/re_order/returnOrder.html",controller:"returnOrderController"}).state("main.ret_order",{url:"/returnorder/return_orderform",templateUrl:"modules/re_order/reOrder.html",controller:"retOrderController"}).state("main.retorderHold",{url:"/returnorder/returnorderholdform",templateUrl:"modules/re_order/returnHold.html",controller:"returnholdController"})}])}();
!function(){"use strict";function e(e,r,s,t,a,o,c,l){e.puchaseorders=[];var n=JSON.parse(t.get("user"));a.logTransaction("View Purchase Orders","PURCHASE ORDER","ALL","User:="+n.username+" View all list of Inventory - Purchase Order"),e.updatePurchaseOrder=function(e,r){console.log("id",e),console.log("data",r)},e.toggleModal=function(s){l.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){r.deletePurchaseOrder(s).then(function(e){return 200==e.statusCode&&e.response.success?(c.success(e.response.msg,"Success"),void o.reload()):(console.log("data.response;",e),void c.error(e.response.msg,"Error"))})},function(e){console.log("Modal promise close: ")})};var u=function(){e.puchaseordersisLoading=!0,e.puchaseorders=[],e.puchaseordersTable=new s({page:1,count:10},{counts:[10,25,50,100],getData:function(s,t){r.getAllPurchaseOrder().then(function(r){if(200==r.statusCode&&r.response.success){var a=r.response.result;e.txtSearch&&"All"==e.applicationStatus?e.puchaseorders=$filter("filter")(a,e.txtSearch):e.txtSearch&&"Published"==e.applicationStatus?(e.puchaseorders=$filter("filter")(a,{status:1}),e.puchaseorders=$filter("filter")(e.puchaseorders,e.txtSearch)):e.txtSearch&&"Unpublished"==e.applicationStatus?(e.puchaseorders=$filter("filter")(a,{status:0}),e.puchaseorders=$filter("filter")(e.puchaseorders,e.txtSearch)):_.isUndefined(e.txtSearch)&&"All"==e.applicationStatus?e.puchaseorders=a:_.isUndefined(e.txtSearch)&&"Published"==e.applicationStatus?e.puchaseorders=$filter("filter")(a,{status:1}):_.isUndefined(e.txtSearch)&&"Unpublished"==e.applicationStatus?e.puchaseorders=$filter("filter")(a,{status:0}):e.puchaseorders=a,t.total(e.puchaseorders.length);var o=e.puchaseorders.slice((t.page()-1)*t.count(),t.page()*t.count());s.resolve(o),e.puchaseordersisLoading=!1}else c.error(r.response.msg,"Error")})}})};u()}angular.module("POS17").controller("returnOrderController",e),e.$inject=["$scope","purchaseOrderFactory","ngTableParams","localStorageService","transLogFctry","$state","toastr","ngDialog"]}();
!function(){"use strict";function e(e,s,t,o,a,c,l,n,r,i,u,d,p,g,f){e.isColl=!1,e.radioModel="product",e.products=[],e.productBundles=[],e.items={},e.details={},e.suppliers=[],e.customers=[],e.stores=[],e.details.products_list=[];var h=!1,m=5e3;e.showMessage=!1,e.showsecondMessage=!1,e.showExportMessage=!1,e.doGreeting=function(){h&&l.cancel(h),e.showMessage=!0,h=l(function(){e.showMessage=!1,e.showsecondMessage=!0,h=l(function(){e.showsecondMessage=!1},2e3)},m)},e.doExport=function(){h&&l.cancel(h),e.showExportMessage=!0,h=l(function(){e.showExportMessage=!1,e.showsecondExportMessage=!0,h=l(function(){e.showsecondExportMessage=!1},2e3)},m)},e.changeData=function(s){e.radioModel=s},console.log("$stateParams",a),a.selected_id&&p.getAllPurchaseOrderDetail(a.selected_id).then(function(s){200==s.statusCode&&s.response.success&&(e.details=s.response.result,console.log("$scope.details:",e.details))}),i.getAllSuppliers().then(function(s){200==s.statusCode&&s.response.success&&(e.suppliers=s.response.result)}),d.getAllPerson().then(function(s){200==s.statusCode&&s.response.success&&(e.customers=_.filter(s.response.result,function(e){return 2==e.per_type_id}))}),r.getAllProduct().then(function(s){if(200==s.statusCode&&s.response.success){var t=s.response.result;_.each(t,function(s){0==s.is_archived&&e.products.push(s)})}}),g.getAllStore().then(function(s){200==s.statusCode&&s.response.success&&(e.stores=s.response.result,console.log("$scope.stores:",e.stores))}),r.getAllProductBundle().then(function(s){if(200==s.statusCode&&s.response.success){var t=s.response.result;_.each(t,function(s){1!==s.is_archived&&e.productBundles.push(s)})}}),e.calculateItem=function(e){var s=0,t=0,t=e.price*e.quantity;return s+=parseFloat(t),e.total=s,e.total},e.currentPage=1,e.entryLimit=5,e.selectDeselectAll=!1,e.applicationStatus="All",e.displayModel="List",e.viewby=25,e.pageSize=e.viewby,e.currentPage=1,e.itemsPerPage=20,e.totalUsers=0,e.addToList=function(s){console.log("$scope.radioModel:",e.radioModel),console.log("aww:",e.details.products_list),console.log("details:",s),_.isEmpty(s)?n.warning("Product list could not empty","Warning"):"product"==e.radioModel?_.isUndefined(s.product)||e.details.products_list.push({item_name:s.product.item_name,quantity:s.quantity,price:s.price,discount:s.discount,total:s.total,product_id:s.product.p_id,bundle_id:null}):"productgroup"==e.radioModel&&(console.log("SURE"),_.isUndefined(s.productgroup)||e.details.products_list.push({item_name:s.productgroup.bundle_name,quantity:s.quantity,price:s.price,discount:s.discount,total:s.total,product_id:null,bundle_id:s.productgroup.pb_id})),e.calculateItems(),console.log(" $scope.details:",e.details)},e.savePO=function(){var t=JSON.parse(s.get("user"));e.details.created_by=t.uc_id,console.log("$scope.details:",e.details),p.savePurchaseOrder(e.details).then(function(e){200==e.statusCode&&e.response.success&&n.success(e.response.msg,"Success")})},e.toggleModal=function(){f.openConfirm({templateUrl:"modules/dialog/cancelDialog.html",scope:e,className:"ngdialog-theme-default"})},e.calculateItems=function(s){var t=0,o=0;_.each(e.details.products_list,function(e){var s=e.price-e.discount;t=s*e.quantity,o+=parseFloat(t)}),e.details.sub_total=o,e.calculateBilling()},e.calculateBilling=function(){e.total=parseFloat(e.details.sub_total||0)+parseFloat(e.details.tax||0)+parseFloat(e.details.shipping_fee||0)},e.removeProduct=function(s){e.products_list.splice(s,1)},e.edit=function(e){c.go("main.products-add",{p_id:e})}}angular.module("POS17").controller("retOrderController",e),e.$inject=["$scope","localStorageService","$http","$filter","$stateParams","$state","$timeout","toastr","productFactory","supplierFctry","ngTableParams","humanFactory","purchaseOrderFactory","storeFactory","ngDialog"]}();
!function(){"use strict";function n(n){}angular.module("POS17").controller("returnholdController",n),n.$inject=["$scope"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(l,t){t.state("main.articles",{url:"/articles",templateUrl:"modules/articles/articles.html",controller:"articleController"}).state("main.articles-detail",{url:"/articles/:article_id",templateUrl:"modules/articles/article.detail.html",controller:"articleDetailController"})}])}();
!function(){"use strict";function e(e,t,a,s,l,r,i,c,o,n,d,u,f){e.selectDeselectAll=!1,e.applicationStatus="All",e.filterStatus="Relevance",e.txtSearch="",e.selectedDatas=[],e.selectedPublishedDatas=[],e.selectedDraftedDatas=[],e.tagsArr=[],e.tagsFilter=[],e.example8settings={showCheckAll:!1,showUncheckAll:!1,enableSearch:!0,scrollableHeight:"300px",scrollable:!0};var g=JSON.parse(d.get("user"));n.logTransaction("View Articles","ARTICLES","ALL","User:="+g.username+" View all list of articles");var h=function(){e.articleisLoading=!0,e.articles=[],e.articleTable=new c({page:1,count:10},{counts:[10,25,50,100],getData:function(t,l){i.getArticle().then(function(r){if(200==r.statusCode&&r.response.success){var i=r.response.result;if(e.txtSearch&&"All"==e.applicationStatus?e.articles=a("filter")(i,e.txtSearch):e.txtSearch&&"Published"==e.applicationStatus?(e.articles=a("filter")(i,{is_active:1}),e.articles=a("filter")(e.articles,e.txtSearch)):e.txtSearch&&"Draft"==e.applicationStatus?(e.articles=a("filter")(i,{is_active:0}),e.articles=a("filter")(e.articles,e.txtSearch)):_.isUndefined(e.txtSearch)&&"All"==e.applicationStatus?e.articles=i:_.isUndefined(e.txtSearch)&&"Published"==e.applicationStatus?e.articles=a("filter")(i,{is_active:1}):_.isUndefined(e.txtSearch)&&"Draft"==e.applicationStatus?e.articles=a("filter")(i,{is_active:0}):e.articles=i,"Most Viewed"==e.filterStatus&&(e.articles=a("orderBy")(e.articles,"article_views",!0),e.articles=_.filter(e.articles,function(e){return parseInt(e.article_views)>0})),e.tagsFilter&&e.tagsFilter.length>0){var c=[];_.each(e.tagsFilter,function(t){_.each(e.articles,function(e){var a=_.find(e.tags,{tags_id:t.id});a&&c.push(e)})}),e.articles=c}l.total(e.articles.length);var o=e.articles.slice((l.page()-1)*l.count(),l.page()*l.count());t.resolve(o),e.articleisLoading=!1}else s.error(r.response.msg,"Error"),e.articleisLoading=!1})}})};f.getAllTags().then(function(t){if(200==t.statusCode&&t.response.success){var a=t.response.result;_.each(a,function(t){e.tagsArr.push({id:t.tags_id,label:t.tags,_id:t._id})})}else s.error(t.response.msg,"Error")}),e.selectEvents={onItemSelect:function(t){e.articleTable.reload()},onItemDeselect:function(t){e.articleTable.reload()}},e.refresh=function(){e.articleisLoading=!0,e.articleTable.reload()},e.edit=function(e){t.go("main.articles-detail",{article_id:e})},e.updateStatus=function(t){e.applicationStatus=t,e.articleTable.reload()},e.updateFilterStatus=function(t){e.filterStatus=t,e.articleTable.reload()},e.searchData=function(){e.articleTable.reload()},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.articles,function(t){t.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.article_id===t.article_id})||(e.selectedDatas.push(t),1==t.is_active&&e.selectedPublishedDatas.push(t),0==t.is_active&&e.selectedDraftedDatas.push(t)):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.article_id!==t.article_id}),e.deleteSomeData=e.selectedDatas.length>0},e.toggleModal=function(a){o.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){i.deleteArticle(a).then(function(e){return 200==e.statusCode&&e.response.success?(s.success(e.response.msg,"Success"),void t.reload()):void s.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},e.updateHistory=function(e){u.open({animation:!0,backdrop:"static",templateUrl:"./modules/articles/audit.log.modal.html",controller:"articleAuditLogModalCtrl",size:"md",resolve:{article_id:function(){return e}}})},e.deleteSelected=function(){o.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var a=0;async.each(e.selectedDatas,function(l,r){l.selected&&i.deleteArticle(l.article_id).then(function(l){return 200==l.statusCode&&l.response.success?(s.success(l.response.msg,"Success"),++a,a==e.selectedDatas.length&&t.reload(),r(),void 0):void s.error(l.response.msg,"Error")})})})},e.draftSelected=function(){e.modal={title:"Draft Article?",message:"Are you sure to Draft this selected article?"},o.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var a=1;return e.selectedPublishedDatas.length>0?void async.eachSeries(e.selectedPublishedDatas,function(l,r){l.selected&&1==l.is_active&&i.draftArticle(l.article_id).then(function(e){return 200==e.statusCode&&e.response.success?(s.success(e.response.msg,"Success"),a++,r(),void 0):void s.error(e.response.msg,"Error")}),console.log("dataCountToDelete: ",a),a==e.selectedPublishedDatas.length&&t.reload()}):void s.warning("Unable to Draft selected Articles..Selected articles are either archived or already drafted","Warning")})},e.publishSelected=function(a){e.modal={title:"Publish Article?",message:"Are you sure to Publish this selected article?"},o.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var a=1;return e.selectedDraftedDatas.length>0?void async.eachSeries(e.selectedDraftedDatas,function(l,r){l.selected&&0==l.is_active&&i.publishArticle(l.article_id).then(function(e){return 200==e.statusCode&&e.response.success?(s.success(e.response.msg,"Success"),a++,r(),void 0):void s.error(e.response.msg,"Error")}),console.log("dataCountToDelete: ",a),a==e.selectedDraftedDatas.length&&t.reload()}):void s.warning("Unable to Publish selected Articles..Selected articles are either archived or already published","Warning")})},h()}angular.module("POS17").controller("articleController",e),e.$inject=["$scope","$state","$filter","toastr","$timeout","$stateParams","articleFctry","ngTableParams","ngDialog","transLogFctry","localStorageService","$uibModal","tagsFactory"]}();
!function(){"use strict";function e(e,t,i,s,r,l,d,a,n,o,u,c,p,m,f,g){function h(e){_.each($rootScope.cartItems,function(t){t.pb_id==e.pb_id&&(t.quantity=e.quantity)}),f.set("Cart",JSON.stringify($rootScope.cartItems))}e.details={},e.details.tags=[],e.details.article_feature=[],e.details.article_features_list=[],e.details.is_published=!1,e.details.is_archived=!1,e.mediaSource={},e.radioModel="product",e.products=[],e.productBundles=[],e.mediafile=[],e.types=[],e.tags=[],e.tagsArr=[],e.infiniteScroll={},e.infiniteScroll.numToAdd=10,e.infiniteScroll.currentItems=10,e.resetInfScroll=function(){e.infiniteScroll.currentItems=e.infiniteScroll.numToAdd},e.addMoreItems=function(){e.infiniteScroll.currentItems+=e.infiniteScroll.numToAdd};var b=JSON.parse(f.get("user"));l.article_id?g.logTransaction("View Article Details","ARTICLES",l.article_id,"User:="+b.username+" View article details:="+l.article_id):g.logTransaction("Add New Article","ARTICLES","N/A","User:="+b.username+" Add new article entry"),c.getAllTags().then(function(t){200==t.statusCode&&t.response.success?e.tagsArr=t.response.result:s.error(t.response.msg,"Error")}),l.article_id&&(e.details.article_feature=[],e.details.article_features_list=[],d.getDetailArticle(l.article_id).then(function(t){200==t.statusCode&&t.response.success&&(e.details=t.response.result,e.showPublish=1!=e.details.is_active,e.details.article_features_list=_.map(e.details.article_features,function(e){return null==e.bundle_id&&null!==e.product_id?{item_name:e.product_details.item_name,item_code:e.product_details.product_code,item_brand:e.product_details.brand,item_id:e.product_details.p_id}:null!==e.bundle_id&&null==e.product_id?{item_name:e.bundle_details.bundle_name,item_code:e.bundle_details.bundle_code,item_brand:e.bundle_details.bundle_brand,item_id:e.bundle_details.pb_id}:void 0}),e.details.article_feature=_.map(e.details.article_features,function(e){return null==e.bundle_id&&null!==e.product_id?{product_id:e.product_details.p_id,bundle_id:null,article_id:l.article_id}:null!==e.bundle_id&&null==e.product_id?{product_id:null,bundle_id:e.bundle_details.pb_id,article_id:l.article_id}:void 0}),e.details.media=e.details.article_thumbnail,e.showArticleMedia(),e.mediafile=t.response.result.mediafiles,c.getAllArticleTags(l.article_id).then(function(t){200==t.statusCode&&t.response.success&&(e.details.tags=t.response.result)}))}),u.getAllProduct().then(function(t){if(200==t.statusCode&&t.response.success){var i=t.response.result;_.each(i,function(t){0==t.is_archived&&e.products.push(t)})}}),u.getAllProductBundle().then(function(t){if(200==t.statusCode&&t.response.success){var i=t.response.result;_.each(i,function(t){1!==t.is_archived&&e.productBundles.push(t)})}})),e.changeData=function(t){e.radioModel=t},e.reloadMediaFiles=function(){l.article_id&&(e.mediafile=[],e.imagesFile=[],d.getDetailArticle(l.article_id).then(function(t){200==t.statusCode&&t.response.success&&r(function(){e.$apply(function(){e.mediafile=t.response.result.mediafiles})},100)}))},e.reloadArticle=function(){l.article_id&&(e.details.article_feature=[],e.details.article_features_list=[],d.getDetailArticle(l.article_id).then(function(t){200==t.statusCode&&t.response.success&&(e.details=t.response.result,e.details.article_features_list=_.map(e.details.article_features,function(e){return null==e.bundle_id&&null!==e.product_id?{item_name:e.product_details.item_name,item_code:e.product_details.product_code,item_brand:e.product_details.brand,item_id:e.product_details.p_id}:null!==e.bundle_id&&null==e.product_id?{item_name:e.bundle_details.bundle_name,item_code:e.bundle_details.bundle_code,item_brand:e.bundle_details.bundle_brand,item_id:e.bundle_details.pb_id}:void 0}),e.details.article_feature=_.map(e.details.article_features,function(e){return null==e.bundle_id&&null!==e.product_id?{product_id:e.product_details.p_id,bundle_id:null,article_id:l.article_id}:null!==e.bundle_id&&null==e.product_id?{product_id:null,bundle_id:e.bundle_details.pb_id,article_id:l.article_id}:void 0}))}))},e.addToList=function(){"product"==e.radioModel?_.isUndefined(e.details.product)||_.isEmpty(e.details.product)||(_.find(e.details.article_features_list,{item_id:e.details.product.p_id})?s.warning("Product Item already existed","Warning"):(e.details.article_features_list.push({item_name:e.details.product.item_name,item_quantity:1,item_code:e.details.product.product_code,item_brand:e.details.product.brand,item_id:e.details.product.p_id}),e.details.article_feature.push({product_id:e.details.product.p_id,bundle_id:null,quantity:1,article_id:l.article_id}))):"productgroup"==e.radioModel&&(_.isUndefined(e.details.productgroup)||_.isEmpty(e.details.productgroup)||(_.find(e.details.article_features_list,{item_id:e.details.productgroup.pb_id})?s.warning("Bundle Item already existed","Warning"):(e.details.article_features_list.push({item_name:e.details.productgroup.bundle_name,item_quantity:1,item_code:e.details.productgroup.bundle_code,item_brand:e.details.productgroup.bundle_brand,item_id:e.details.productgroup.pb_id}),e.details.article_feature.push({bundle_id:e.details.productgroup.pb_id,product_id:null,quantity:1,article_id:l.article_id})))),e.details.product={},e.details.productgroup={}},e.minusbutton=function(e){e.quantity<1?(e.quantity=0,h(e)):(e.quantity--,h(e))},e.addbutton=function(e){e.quantity++,h(e)},e.removeOnList=function(t){e.details.article_features_list.splice(t,1),e.details.article_feature.splice(t,1)},e.deleteAllMedia=function(){n.openConfirm({templateUrl:"modules/dialog/deleteAllDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){l.article_id&&d.deleteAllArticleMedia(l.article_id).then(function(e){return 200==e.statusCode&&e.response.success?(s.success(e.response.msg,"Success"),void t.reload()):void s.error(e.response.msg,"Error")})})},e.deleteSelected=function(i){n.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){console.log("media: ",i),l.article_id&&d.deleteArticleMediaFile(l.article_id,i._id).then(function(e){return 200==e.statusCode&&e.response.success?(s.success(e.response.msg,"Success"),void t.reload()):void s.error(e.response.msg,"Error")})})},e.saveArticle=function(){async.waterfall([function(t){l.article_id?d.updateArticle(l.article_id,e.details).then(function(e){if(200==e.statusCode&&e.response.success)s.success(e.response.msg,"Success"),t(null,l.article_id);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void s.error(e.response.msg,"Error");_.each(e.response.result,function(e){s.warning(e.msg,"Warning")})}}):d.saveArticle(e.details).then(function(e){if(200==e.statusCode&&e.response.success)s.success(e.response.msg,"Success"),t(null,e.response.result);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void s.error(e.response.msg,"Error");_.each(e.response.result,function(e){s.warning(e.msg,"Warning")})}})},function(t,i){var r=1;e.details.tags.length>0?async.eachSeries(e.details.tags,function(l,d){l.isTag?c.saveTags(l).then(function(e){return 200==e.statusCode&&e.response.success?void c.saveArticleTags(t,{tag_id:e.response.result}).then(function(e){return 200==e.statusCode&&e.response.success?(r++,void d()):void s.error(e.response.msg,"Error")}):void s.error(e.response.msg,"Error")}):c.saveArticleTags(t,{tag_id:l.tags_id}).then(function(e){return 200==e.statusCode&&e.response.success?(r++,void d()):void s.error(e.response.msg,"Error")}),r>=e.details.tags.length&&i(null,t)}):i(null,t)},function(e,i){r(function(){t.go(t.current,{article_id:e},{reload:!0})},300)}])},e.tagTransform=function(e){return console.log(e),{tags:e}},e.clearInput=function(e){e.search=""},e.deleteProductTags=function(e){l.article_id&&c.deleteArticleTag(l.article_id,e.tags_id).then(function(e){return 200==e.statusCode&&e.response.success?void s.success(e.response.msg,"Success"):void s.error(e.response.msg,"Error")})},e.publishArticle=function(i){n.openConfirm({templateUrl:"modules/dialog/confirmDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){d.publishArticle(i).then(function(e){200==e.statusCode&&e.response.success?(s.success(e.response.msg,"Success"),r(function(){t.reload()},1e3)):s.error(e.response.msg,"Error")})})},e.openUploader=function(){var e=o.open({animation:!0,backdrop:"static",templateUrl:"./modules/articles/article.upload.modal.html",controller:"articleUploadModalCtrl",size:"lg",resolve:{article_id:function(){return l.article_id}}});e.result.then(function(e){t.reload()},function(){})},e.showArticleMedia=function(){var t=e.details.media;t&&("image/jpeg"==t.media_mimetype?t.media=!1:"image/jpg"==t.media_mimetype?t.media=!1:"image/gif"==t.media_mimetype?t.media=!1:"image/x-ms-bmp"==t.media_mimetype?t.media=!1:"image/png"==t.media_mimetype?t.media=!1:"video/mp4"==t.media_mimetype?(t.media=!0,t.url="http://www.videogular.com/styles/themes/default/latest/videogular.css"):"video/x-flv"==t.media_mimetype?(t.media=!0,t.url="http://www.videogular.com/styles/themes/default/latest/videogular.css"):"video/x-msvideo"==t.media_mimetype?(t.media=!0,t.url="http://www.videogular.com/styles/themes/default/latest/videogular.css"):"video/x-ms-wmv"==t.media_mimetype?(t.media=!0,t.url="http://www.videogular.com/styles/themes/default/latest/videogular.css"):"video/quicktime"==t.media_mimetype&&(t.media=!0,t.url="http://www.videogular.com/styles/themes/default/latest/videogular.css"),r(function(){e.$apply(function(){e.mediaSource=t,e.details.thumbnail_media=t._id})},10))},e.openLightboxModal=function(e){var t=[];t.push({url:e.media_path,caption:e.media_name,thumbUrl:e.media_path}),p.openModal(t,0)},e.openVideoModal=function(e){o.open({animation:!0,backdrop:"static",templateUrl:"./modules/articles/article.media.modal.html",controller:"articleMediaModalCtrl",size:"lg",resolve:{files:function(){return e},type:function(){return"video"}}})},e.openAudioModal=function(e){o.open({animation:!0,backdrop:"static",templateUrl:"./modules/articles/article.media.modal.html",controller:"articleMediaModalCtrl",size:"md",resolve:{files:function(){return e},type:function(){return"audio"}}})},e.openDocsModal=function(e){o.open({animation:!0,backdrop:"static",templateUrl:"./modules/articles/article.docs.modal.html",controller:"articleDocsModalCtrl",size:"lg",windowClass:"presentation-modal-popup",resolve:{files:function(){return e}}})},e.copyURLLink=function(e){return m.supported?(console.log("files.media_path: ",e.media_path),void m.copyText(e.media_path)):void s.warning("Sorry, copy to clipboard is not supported","Warning")}}angular.module("POS17").controller("articleDetailController",e),e.$inject=["$scope","$state","$filter","toastr","$timeout","$stateParams","articleFctry","ngTableParams","ngDialog","$uibModal","productFactory","tagsFactory","Lightbox","clipboard","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,o,t,l,n,s,c,i,a,r,u,d){console.log("articleUploadModalCtrl"),console.log("$stateParams:",c),e.item={};var m=JSON.parse(u.get("user")),f=e.uploader=new l({url:n+s+"articlemedia/"+c,method:"PUT",headers:{Authorization:"Bearer "+a.getUserToken(),accesskey:m.subscriptionKey}});f.filters.push({name:"customFilter",fn:function(e,o){return this.queue.length<10}}),f.onBeforeUploadItem=function(e){e.alias="media",console.log("item:",e)},f.onSuccessItem=function(e,o,t,l){d.success(o.response.msg,"Success")},f.onWhenAddingFileFailed=function(e,o,t){console.log("item:",e),console.log("filter:",o),console.log("options:",t)},f.onAfterAddingFile=function(e){console.log("onAfterAddingFile:",e)},f.onCompleteAll=function(e){d.success("Media / File upload complete","Success"),i(function(){t.close(c)},1300)},e.cancel=function(){t.dismiss("cancel")}}angular.module("POS17").controller("articleUploadModalCtrl",e),e.$inject=["$scope","$state","$uibModalInstance","FileUploader","API_URL","API_VERSION","article_id","$timeout","AuthFctry","$stateParams","localStorageService","toastr"]}();
!function(){"use strict";function e(e,t,i,s,a,c){e.audio="audio"==c,e.config={sources:[{src:a.trustAsResourceUrl(s.media_path),type:s.media_mimetype}],theme:{url:"http://www.videogular.com/styles/themes/default/latest/videogular.css"}},e.cancel=function(){i.dismiss("cancel")}}function t(e,t,i,s,a,c){if(console.log("files: ",a),e.pdfName=a.media_name,e.file_type=a.media_mimetype,"application/pdf"==a.media_mimetype)e.pdfUrl=s.trustAsResourceUrl(a.media_path);else if("text/plain"==a.media_mimetype)e.pdfUrl=s.trustAsResourceUrl("https://docs.google.com/gview?url="+a.media_path+"&embedded=true");else{var l=encodeURI(a.media_path);e.pdfUrl=s.trustAsResourceUrl("https://view.officeapps.live.com/op/view.aspx?src="+l)}e.cancel=function(){i.dismiss("cancel")}}angular.module("POS17").controller("articleMediaModalCtrl",e).controller("articleDocsModalCtrl",t),e.$inject=["$scope","$state","$uibModalInstance","files","$sce","type"],t.$inject=["$scope","$state","$uibModalInstance","$sce","files","localStorageService"]}();
!function(){"use strict";function t(t,e,i,a,n){t.paginateNumber=0,t.pagination={currentPage:1,limitWithPage:10,totalPages:0,sumOfPages:0},t.auditlogs=[],t.generateActivityLogs=function(e){a.getArticleAuditLog(e,{startWith:t.paginateNumber,limit:t.pagination.limitWithPage}).then(function(e){200==e.statusCode&&e.response.success&&(t.auditlogs=e.response.result,t.pagination.totalPages=e.response.pagination.results,t.pagination.sumOfPages=e.response.pagination.pages)})},n&&t.generateActivityLogs(n),t.addMoreItems=function(){t.paginateNumber=t.pagination.currentPage-1,n&&t.generateActivityLogs(n)},t.filterDate=function(){},t.cancel=function(){i.dismiss("cancel")}}angular.module("POS17").controller("articleAuditLogModalCtrl",t),t.$inject=["$scope","$state","$uibModalInstance","articleFctry","article_id"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(o,e){e.state("main.pricebook",{url:"/pricebook/overview",templateUrl:"modules/pricebook/pricebook.html",controller:"pricebookController"}).state("main.pricebook-detail",{url:"/pricebook/:pricebook_id",templateUrl:"modules/pricebook/pricebook.detail.html",controller:"pricebookDetailController"})}])}();
!function(){"use strict";function e(e,t,s,o,i,l,r,a,c,p,n,u,d){e.name="-Type-",e.status="All",e.txtSearch="",e.type={},e.selectDeselectAll=!1,e.selectedDatas=[],e.selectedToPublish=[],e.pricebooktype=[],e.tagsArr=[],e.tagsFilter=[],e.example8settings={showCheckAll:!1,showUncheckAll:!1,enableSearch:!0,scrollableHeight:"300px",scrollable:!0};var g=r.getCurrentUser(),h=JSON.parse(g);c.logTransaction("View Pricebooks","PRICEBOOKS","ALL","User:="+h.username+" View all list of pricebooks"),t.getPricebookType().then(function(t){e.pricebooktype=[],200==t.statusCode&&t.response.success&&(e.pricebooktype=t.response.result)}),p.getAllTags().then(function(t){if(200==t.statusCode&&t.response.success){var s=t.response.result;_.each(s,function(t){e.tagsArr.push({id:t.tags_id,label:t.tags,_id:t._id})})}else l.error(t.response.msg,"Error")});var f=function(){e.pricebookLoading=!0,e.pricebooks=[],e.pricebookscopy=[],e.name="-Type-",e.status="All",e.txtSearch="",e.type={},e.pricebooksTable=new s({page:1,count:10},{counts:[10,25,50,100],getData:function(s,i){t.getAllPricebook().then(function(t){if(200==t.statusCode&&t.response.success){var r=t.response.result;if(e.pricebookscopy=angular.copy(t.response.result),e.txtSearch&&"All"==e.status&&_.isEmpty(e.type)&&_.isEmpty(e.tagsFilter))console.log("1"),e.pricebooks=o("filter")(r,e.txtSearch);else if(e.txtSearch&&"Published"==e.status&&_.isEmpty(e.type)&&_.isEmpty(e.tagsFilter)){console.log("2");var a=o("filter")(r,e.txtSearch);e.pricebooks=_.reject(a,{date_approved:null})}else if(e.txtSearch&&"Unpublished"==e.status&&_.isEmpty(e.type)&&_.isEmpty(e.tagsFilter)){console.log("3");var a=o("filter")(r,e.txtSearch);e.pricebooks=_.filter(a,{date_approved:null})}else if(e.txtSearch&&"All"==e.status&&e.type&&_.isEmpty(e.tagsFilter)){console.log("4");var a=o("filter")(r,e.txtSearch);e.pricebooks=_.filter(a,{pricebook_type_id:e.type.pt_id})}else if(e.txtSearch&&"Published"==e.status&&e.type&&_.isEmpty(e.tagsFilter)){console.log("5");var a=o("filter")(r,e.txtSearch),c=_.reject(a,{date_approved:null});e.pricebooks=_.filter(c,{pricebook_type_id:e.type.pt_id})}else if(e.txtSearch&&"Unpublished"==e.status&&e.type&&_.isEmpty(e.tagsFilter)){console.log("6");var a=o("filter")(r,e.txtSearch),c=_.filter(a,{date_approved:null});e.pricebooks=_.filter(c,{pricebook_type_id:e.type.pt_id})}else if(e.txtSearch&&"All"==e.status&&e.type&&e.tagsFilter){console.log("7");var a=o("filter")(r,e.txtSearch),p=_.filter(a,{pricebook_type_id:e.type.pt_id}),n=[];e.tagsFilter&&e.tagsFilter.length>0&&_.each(e.tagsFilter,function(e){_.each(p,function(t){var s=_.find(t.tags,{tags_id:e.id});s&&n.push(t)})}),e.pricebooks=n}else if(_.isEmpty(e.txtSearch)&&"All"==e.status&&_.isEmpty(e.type)&&_.isEmpty(e.tagsFilter))console.log("8"),e.pricebooks=r;else if(_.isEmpty(e.txtSearch)&&"Published"==e.status&&_.isEmpty(e.type)&&_.isEmpty(e.tagsFilter))console.log("9"),e.pricebooks=_.reject(r,{date_approved:null});else if(_.isEmpty(e.txtSearch)&&"Unpublished"==e.status&&_.isEmpty(e.type)&&_.isEmpty(e.tagsFilter))console.log("10"),e.pricebooks=_.filter(r,{date_approved:null});else if(_.isEmpty(e.txtSearch)&&"All"==e.status&&e.type&&_.isEmpty(e.tagsFilter))console.log("11"),e.pricebooks=_.filter(r,{pricebook_type_id:e.type.pt_id});else if(_.isEmpty(e.txtSearch)&&"Published"==e.status&&e.type&&_.isEmpty(e.tagsFilter)){console.log("12");var a=_.reject(r,{date_approved:null});e.pricebooks=_.filter(a,{pricebook_type_id:e.type.pt_id})}else if(_.isEmpty(e.txtSearch)&&"Unpublished"==e.status&&e.type&&_.isEmpty(e.tagsFilter)){console.log("13");var a=_.filter(r,{date_approved:null});e.pricebooks=_.filter(a,{pricebook_type_id:e.type.pt_id})}else if(_.isEmpty(e.txtSearch)&&"All"==e.status&&_.isEmpty(e.type)&&e.tagsFilter){console.log("14");var n=[];e.tagsFilter&&e.tagsFilter.length>0&&_.each(e.tagsFilter,function(e){_.each(r,function(t){var s=_.find(t.tags,{tags_id:e.id});s&&n.push(t)})}),e.pricebooks=n}else if(_.isEmpty(e.txtSearch)&&"Published"==e.status&&_.isEmpty(e.type)&&e.tagsFilter){console.log("15");var a=_.reject(r,{date_approved:null}),n=[];e.tagsFilter&&e.tagsFilter.length>0&&_.each(e.tagsFilter,function(e){_.each(a,function(t){var s=_.find(t.tags,{tags_id:e.id});s&&n.push(t)})}),e.pricebooks=n}else if(_.isEmpty(e.txtSearch)&&"Unpublished"==e.status&&_.isEmpty(e.type)&&e.tagsFilter){console.log("16");var a=_.filter(r,{date_approved:null}),n=[];e.tagsFilter&&e.tagsFilter.length>0&&_.each(e.tagsFilter,function(e){_.each(a,function(t){var s=_.find(t.tags,{tags_id:e.id});s&&n.push(t)})}),e.pricebooks=n}else if(_.isEmpty(e.txtSearch)&&"All"==e.status&&e.type&&e.tagsFilter){console.log("17");var a=_.filter(r,{pricebook_type_id:e.type.pt_id}),n=[];e.tagsFilter&&e.tagsFilter.length>0&&_.each(e.tagsFilter,function(e){_.each(a,function(t){var s=_.find(t.tags,{tags_id:e.id});s&&n.push(t)})}),e.pricebooks=n}else if(_.isEmpty(e.txtSearch)&&"Published"==e.status&&e.type&&e.tagsFilter){console.log("18");var a=_.reject(r,{date_approved:null}),p=_.filter(a,{pricebook_type_id:e.type.pt_id}),n=[];e.tagsFilter&&e.tagsFilter.length>0&&_.each(e.tagsFilter,function(e){_.each(p,function(t){var s=_.find(t.tags,{tags_id:e.id});s&&n.push(t)})}),e.pricebooks=n}else if(_.isEmpty(e.txtSearch)&&"Unpublished"==e.status&&e.type&&e.tagsFilter){console.log("19");var a=_.filter(r,{date_approved:null}),p=_.filter(a,{pricebook_type_id:e.type.pt_id}),n=[];e.tagsFilter&&e.tagsFilter.length>0&&_.each(e.tagsFilter,function(e){_.each(p,function(t){var s=_.find(t.tags,{tags_id:e.id});s&&n.push(t)})}),e.pricebooks=n}else console.log("else"),e.pricebooks=r;i.total(e.pricebooks.length);var u=e.pricebooks.slice((i.page()-1)*i.count(),i.page()*i.count());e.pricebookLoading=!1,s.resolve(u)}else l.error(t.response.msg,"Error"),e.pricebookLoading=!1})}})};f(),e.selectEvents={onItemSelect:function(t){e.pricebooksTable.reload()},onItemDeselect:function(t){e.pricebooksTable.reload()}},e.refresh=function(){f()},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.pricebooks,function(t){t.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.checkDataChanges=function(t){t.selected?(_.find(e.selectedDatas,function(e){return e.pricebook_id===t.pricebook_id})||e.selectedDatas.push(t),_.isNull(t.date_approved)&&(_.find(e.selectedToPublish,function(e){return e.pricebook_id===t.pricebook_id})||e.selectedToPublish.push(t))):(e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.pricebook_id!==t.pricebook_id}),e.selectedToPublish=_.filter(e.selectedToPublish,function(e){return e.pricebook_id!==t.pricebook_id})),e.deleteSomeData=e.selectedDatas.length>0,e.pusblishSomeData=e.selectedToPublish.length>0},e.updateStatus=function(t){console.log("updateStatus"),e.status=t,e.pricebooksTable.reload()},e.updateType=function(t){"-Type-"!==t?(e.type=t,e.name=t.name):(e.name="-Type-",e.type={}),e.pricebooksTable.reload()},e.searchData=function(){e.pricebooksTable.reload()},e.copyDuplicatePricebook=function(s){e.modal={title:"Copy/Duplicate Pricebook?",message:"Are you sure to Copy/Duplicate Pricebook?"},i.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){s.pricebook_id&&t.duplicatePriceBook(s.pricebook_id).then(function(e){return 200==e.statusCode&&e.response.success?(l.success(e.response.msg,"Success"),void u(function(){d.reload()},1e3)):void l.error(e.response.msg,"Error")})})},e.publishSelectedItem=function(s){e.modal={title:"Publish Pricebook?",message:"Are you sure to Publish this selected pricebook?"},i.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){t.approvedPriceBook(s.pricebook_id,{approved_by:h.person_id}).then(function(e){return 200==e.statusCode&&e.response.success?(l.success(e.response.msg,"Success"),void u(function(){d.reload()},1e3)):void l.error(e.response.msg,"Error")})})},e.publishSelected=function(){e.modal={title:"Publish Pricebook?",message:"Are you sure to Publish this selected pricebooks?"},i.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){console.log("$scope.selectedDatas: ",e.selectedDatas);var s=1;async.eachSeries(e.selectedDatas,function(o,i){o.selected&&t.approvedPriceBook(o.pricebook_id,{approved_by:h.person_id}).then(function(e){return 200==e.statusCode&&e.response.success?(l.success(e.response.msg,"Success"),s++,i(),void 0):void l.error(e.response.msg,"Error")}),s==e.selectedDatas.length&&u(function(){d.reload()},1e3)})})},e.deleteSelected=function(){e.modal={title:"Delete Pricebook?",message:"Are you sure to Delete this selected pricebooks?"},i.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var s=1;async.eachSeries(e.selectedDatas,function(o,i){o.selected&&t.deletePriceBook(o.pricebook_id).then(function(e){return 200==e.statusCode&&e.response.success?(l.success(e.response.msg,"Success"),s++,i(),void 0):void l.error(e.response.msg,"Error")}),s==e.selectedDatas.length&&u(function(){d.reload()},1e3)})})},e.updateHistory=function(e){n.open({animation:!0,backdrop:"static",templateUrl:"./modules/pricebook/pricebook.auditlog.modal.html",controller:"pricebookAuditLogModalCtrl",size:"md",resolve:{pricebook_id:function(){return e}}})}}angular.module("POS17").controller("pricebookController",e),e.$inject=["$scope","pricebookFactory","ngTableParams","$filter","ngDialog","toastr","AuthFctry","localStorageService","transLogFctry","tagsFactory","$uibModal","$timeout","$state"]}();
!function(){"use strict";function e(e,s,t,o,r,i,n,c,a,u,l,d,p,g,m,f,b){console.log("pricebookDetailController");var h=o.getCurrentUser(),k=JSON.parse(h);e.tagselected=[],e.tags=[],e.tagsArr=[],e.tagschecked=[],e.customergroups=[],e.storesArr=[],e.details={},e.details.isActive=1,e.details.published=!1,e.details.stores=[],e.details.customergroups=[],e.details.tags=[],e.details.created_by=k.person_id,e.details.start_date=new Date,e.details.end_date=new Date,e.displayTab=!1,e.uniquePricebookName=!1,e.uniquePricebookType=!1,e.item={},e.selectDeselectAll2=!1,e.selectedDatas2=[],e.infiniteScrollContacts={},e.infiniteScrollContacts.numToAdd=20,e.infiniteScrollContacts.currentItems=20;var h=JSON.parse(d.get("user"));n.pricebook_id?(e.displaySchedule=!0,p.logTransaction("View Pricebook Details","PRICEBOOKS",n.pricebook_id,"User:="+h.username+" View pricebook details: ="+n.pricebook_id)):(e.displaySchedule=!1,p.logTransaction("Add New Pricebook","PRICEBOOKS","N/A","User:="+h.username+" Add new pricebook entry")),t.getPricebookType().then(function(s){e.pricebooktype=[],200==s.statusCode&&s.response.success&&(e.pricebooktype=s.response.result)}),u.getAllTags().then(function(s){200==s.statusCode&&s.response.success?e.tagsArr=s.response.result:r.error(s.response.msg,"Error")}),m.getCustomerGroup().then(function(s){200==s.statusCode&&s.response.success?(e.customergroups=s.response.result,console.log("$scope.customergroups;",e.customergroups)):r.error(s.response.msg,"Error")}),b.getAllStore().then(function(s){200==s.statusCode&&s.response.success?e.storesArr=s.response.result:r.error(s.response.msg,"Error")}),async.waterfall([function(e){m.getAllPerson().then(function(s){if(200==s.statusCode&&s.response.success){var t=s.response.result,o=_.filter(t,function(e){if("Customer"==e.person_type&&0==e.isSubscriber)return e});e(null,o)}else r.error(s.response.msg,"Error")})},function(e,s){f.getAllCompany().then(function(t){if(200==t.statusCode&&t.response.success){var o=t.response.result;s(null,e,o)}else r.error(t.response.msg,"Error")})},function(s,t,o){var r=[];s&&s.length>0&&_.each(s,function(e){r.push({_id:e._id,email:e.email,id:e.person_id,type:"customer",name:e.displayName,pricebook_id:n.pricebook_id})}),t&&t.length>0&&_.each(t,function(e){r.push({_id:e._id,email:e.email,id:e.company_id,type:"company",name:e.name,pricebook_id:n.pricebook_id})}),e.customersData=r}]),n.pricebook_id&&(e.displayTab=!0,t.getPricebookDetail(n.pricebook_id).then(function(s){200==s.statusCode&&s.response.success&&(e.details=s.response.result,console.log("$scope.details:",e.details),e.details.published=1==e.details.isActive,e.details.customergroups=e.details.customergroup,u.getAllPricebookTags(n.pricebook_id).then(function(s){200==s.statusCode&&s.response.success&&(e.details.tags=s.response.result)}))})),e.resetInfScroll=function(){e.infiniteScrollContacts.currentItems=e.infiniteScrollContacts.numToAdd},e.addMoreItems=function(){e.infiniteScrollContacts.currentItems+=e.infiniteScrollContacts.numToAdd},e.validatePricebookName=function(s){s&&t.validatePricebookName({name:s,pricebook_id:n.pricebook_id}).then(function(s){return 200!=s.statusCode||s.response.success?void(e.uniquePricebookName=!1):(e.uniquePricebookName=!0,void r.warning(s.response.msg,"Warning"))})},e.tagTransform=function(e){return{tags:e}},e.clearInput=function(e){e.search=""},e.changeSelectDeselectAll2=function(){e.selectDeselectAll2=!e.selectDeselectAll2,_.each(e.tagsArr,function(s){s.checked=e.selectDeselectAll2,e.checkDataChanges2(s)})},e.checkDataChanges2=function(s){s.checked?_.find(e.tagselected,function(e){return e.tags_id===s.tags_id})||e.tagselected.push(s):e.tagselected=_.filter(e.selectedDatas,function(e){return e.tags_id!==s.tags_id})},e.deleteProductTags=function(e){n.pricebook_id&&u.deleteArticleTag(n.pricebook_id,e.tags_id).then(function(e){return 200==e.statusCode&&e.response.success?void r.success(e.response.msg,"Success"):void r.error(e.response.msg,"Error")})},e.savePricebook=function(){e.details.isActive=1==e.details.published?1:0,e.details.customergroup=[],_.each(e.details.customergroups,function(s){e.details.customergroup.push({customer_group_id:s.cg_id})});var s=[];_.each(e.details.customers,function(e){s.push({customer_id:e.id,type:e.type})}),e.details.customers=s;var o=[];_.each(e.details.stores,function(e){o.push({store_id:e.store_id})}),e.details.stores=o,async.waterfall([function(s){n.pricebook_id?(console.log(e.details),console.log(e.details.stores),t.updatePriceBook(n.pricebook_id,{name:e.details.name,description:e.details.description,valid_from:e.details.valid_from,valid_until:e.details.valid_until,isActive:e.details.isActive,pricebook_type_id:e.details.pricebook_type_id,created_by:e.details.created_by,customergroup:e.details.customergroup,customers:e.details.customers,stores:e.details.stores}).then(function(e){return 200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),void s(null,n.pricebook_id)):void r.error(e.response.msg,"Error")})):t.savePricebook(e.details).then(function(e){return 200==e.statusCode&&e.response.success?(r.success(e.response.msg,"Success"),void s(null,e.response.result)):void r.error(e.response.msg,"Error")})},function(s,t){var o=1;e.details.tags.length>0?async.eachSeries(e.details.tags,function(i,n){i.isTag?u.saveTags(i).then(function(e){return 200==e.statusCode&&e.response.success?void u.savePricebookTags(s,{tag_id:e.response.result}).then(function(e){return 200==e.statusCode&&e.response.success?(o++,void n()):void r.error(e.response.msg,"Error")}):void r.error(e.response.msg,"Error")}):u.savePricebookTags(s,{tag_id:i.tags_id}).then(function(e){return 200==e.statusCode&&e.response.success?(o++,void n()):void r.error(e.response.msg,"Error")}),o>=e.details.tags.length&&t(null,s)}):t(null,s)},function(e,s){g(function(){i.go(i.current,{pricebook_id:e},{reload:!0})},300)}])}}angular.module("POS17").controller("pricebookDetailController",e),e.$inject=["$scope","productFactory","pricebookFactory","AuthFctry","toastr","$state","$stateParams","$filter","ngDialog","tagsFactory","$uibModal","localStorageService","transLogFctry","$timeout","humanFactory","companyFactory","storeFactory"]}();
!function(){"use strict";function e(e,o,t,i,s,c,r,n){function a(e){var o={};return o.price_sched_day_id=e.selectedDay.id,o.time_start=moment(e.time_from,["HH:mm A"]).format("HH:mm:ss"),o.time_end=moment(e.time_to,["HH:mm A"]).format("HH:mm:ss"),o.notify_me=e.isnotifyme,o.is_active=e.isactive,o}function d(e){var o={};return o.price_sched_day_id=e.selectedDay.id,o.time_start=e.time_start,o.time_end=e.time_end,o.notify_me=e.notify_me,o.is_active=e.is_active,o.price_sched_id=e.price_sched_id,o}e.settings={"default":function(){var e=new Date;return e.getHours(1),e.getMinutes(2),e}},e.settings1={"default":function(){var e=new Date;return e.getHours(1),e.getHours(2),e}},e.example8model=[],e.example8data=[{id:1,label:"Accessories"},{id:2,label:"Headset"},{id:3,label:"Mobile Headset"},{id:4,label:"Wearables"}],e.days=[],e.isnotifyme=!1,e.startWith=0,e.limit=10,e.queryparams={startWith:e.startWith,limit:e.limit},e.pricebook_publish={},e.details=[],e.isToUpdate=!1,e.selectedSchedule={},e.pricebook={},e.pricebook.days=[{id:1,label:"Monday"},{id:2,label:"Tuesday"},{id:3,label:"Wednesday"},{id:4,label:"Thursday"},{id:5,label:"Friday"},{id:6,label:"Saturday"},{id:7,label:"Sunday"},{id:8,label:"Everyday"}],e.filterDaysSelected=function(o){var t=_.filter(e.pricebook.days,function(e){return o===e.label});e.pricebook.days.selected=t[0]},e.getPricebookSched=function(){i.pricebook_id&&n.getPricebookSchedule(i.pricebook_id," ").then(function(o){_.each(o.response.result,function(e){e.time_end=moment(e.time_end,["hh:mm:ss"]).format("h:mm A"),e.time_start=moment(e.time_start,["hh:mm:ss"]).format("h:mm A")}),e.listOfSchedules=o.response.result})},e.getPriceBookDetails=function(){n.getPricebookDetail(i.pricebook_id).then(function(o){e.pricebook_details=o.response.result})},e.openScheduleModal=function(t){var s=new Date;e.pricebook.time_from=moment(s).format("hh:mm A"),e.pricebook.time_to=moment(s).format("hh:mm A"),e.pricebook.days.selected=e.pricebook.days[0],e.details.valid_from=new Date,e.details.valid_until=new Date,c.openConfirm({templateUrl:"./modules/pricebook/pricebook.schedule.modal.html",scope:e,className:"ngdialog-theme-default",appendClassName:"ngdialog-custom",width:"40%"}).then(function(){e.pricebook.selectedDay=e.pricebook.days.selected,e.pricebook._id=i.pricebook_id;var t=a(e.pricebook);console.log(t),n.createPricebookSchedule(e.pricebook._id,t).then(function(t){t.response&&t.response.success?(o.success(t.response.msg,"Success"),e.getPricebookSched()):(o.error(t.response.msg,"Error"),e.getPricebookSched())})},function(e){console.log("Modal promise close: ")})},e.openScheduleModalForEdit=function(t){e.filterDaysSelected(t.day_name),e.selectedSchedule=t,console.log("$scope.selectedSchedule;",e.selectedSchedule),c.openConfirm({templateUrl:"./modules/pricebook/pricebook.schedule.modalEdit.html",scope:e,className:"ngdialog-theme-default",appendClassName:"ngdialog-custom",width:"40%"}).then(function(){t.selectedDay=e.pricebook.days.selected;var s=d(t);n.updatepricebookSchedule(i.pricebook_id,s.price_sched_id,s).then(function(t){t.response&&t.response.success?(o.success(t.response.msg,"Success"),e.getPricebookSched()):(o.error(t.response.msg,"Error"),e.getPricebookSched())})},function(e){console.log("Modal promise close: ")})},e.deletePriceBookSched=function(t){c.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){n.deletepricebookSchedule(i.pricebook_id,t).then(function(t){t.response&&t.response.success?(o.success(t.response.msg,"Success"),e.getPricebookSched()):(o.error(t.response.msg,"Error"),e.getPricebookSched())})},function(e){console.log("Modal promise close: ")})},e.toogle_notifyme=function(){1!=e.isnotifyme},e.toggle_active=function(t){e.filterDaysSelected(t.day_name),t.selectedDay=e.pricebook.days.selected;var s=d(t);n.updatepricebookSchedule(i.pricebook_id,s.price_sched_id,s).then(function(t){t.response&&t.response.success?(o.success(t.response.msg,"Success"),e.getPricebookSched()):(o.error(t.response.msg,"Error"),e.getPricebookSched())})},e.parseDateFormat=function(e){return moment(e).format("YYYY MMM DD")},e.init=function(){e.getPricebookSched(),e.getPriceBookDetails()},e.init()}angular.module("POS17").controller("pricebookAssignCtrl",e),e.$inject=["$scope","toastr","$state","$stateParams","$filter","ngDialog","$uibModal","pricebookFactory"]}();
!function(){"use strict";function e(e,t,o,s,r,i,c,n,a,l,p){function u(e,t,o){var s=0;return s=(parseFloat(e)+parseFloat(t)-parseFloat(o)).toFixed(2)}function d(t){if(_.isEmpty(t))return void s.error("Please set values for Selling Price, Margin and Discount","Error");if(!(e.selectedDatas.length>0))return void s.error("Please select items to map","Error");if(i.pricebook_id){var r=1;async.eachSeries(e.selectedDatas,function(c,n){var a={};a.bundle_id=c.bundle_id,a.product_id=c.product_id,a.min_quantity=_.isEmpty(t.min_quantity)?c.min_quantity:t.min_quantity,a.max_quantity=_.isEmpty(t.max_quantity)?c.max_quantity:t.max_quantity,a.markup=_.isEmpty(t.margin)?c.markup:t.margin,a.discount=_.isEmpty(t.discount)?c.discount:t.discount,a.sell_price=c.sell_price,c.pi_id?o.updatePriceBookItem(i.pricebook_id,c.pi_id,a).then(function(e){return 200==e.statusCode&&e.response.success?(s.success(e.response.msg,"Success"),r++,n(),void 0):void s.error(e.response.msg,"Error")}):o.savePriceBookItem(i.pricebook_id,a).then(function(e){return 200==e.statusCode&&e.response.success?(s.success(e.response.msg,"Success"),r++,n(),void 0):void s.error(e.response.msg,"Error")}),r==e.selectedDatas.length&&(e.item.discount="",e.item.margin="",e.item.max_quantity="",e.item.min_quantity="",e.refreshData())})}}console.log("pricebookProductCtrl"),e.products=[],e.productscopy=[],e.bundles=[],e.bundlescopy=[],e.pricebookItems=[],e.pricebookItemsCopy=[],e.selectedDatas=[],e.selectDeselectAllProduct=!1,e.txtProductSearch="",e.tagsArr=[],e.tagsFilter=[],e.example8settings={showCheckAll:!1,showUncheckAll:!1,enableSearch:!0,scrollableHeight:"300px",scrollable:!0},l.getAllTags().then(function(t){if(200==t.statusCode&&t.response.success){var o=t.response.result;_.each(o,function(t){e.tagsArr.push({id:t.tags_id,label:t.tags,_id:t._id})})}else s.error(t.response.msg,"Error")}),i.pricebook_id&&(e.pricebookItems=[],e.pricebookItemsCopy=[],o.getAllPriceBookItem(i.pricebook_id).then(function(t){200==t.statusCode&&t.response.success&&(e.pricebookItems=t.response.result,_.each(e.pricebookItems,function(e){e.popoverIsOpen=!1,e.selling_price=u(e.sell_price||0,e.markup||0,e.discount||0)}),e.pricebookItemsCopy=angular.copy(e.pricebookItems))})),e.selectEvents={onItemSelect:function(t){console.log("property: ",t),e.searchProductData()},onItemDeselect:function(t){console.log("property: ",t),e.searchProductData()}},e.tagTransform=function(e){return{tags:e}},e.showTooltip1=function(t){_.each(e.pricebookItems,function(e){t.pi_id!==e.pi_id?e.popoverIsOpen=!1:e.selling_price=u(e.sell_price||0,e.markup||0,e.discount||0)});var o=_.find(e.pricebookItems,{pi_id:t.pi_id});o&&(o.popoverIsOpen?o.popoverIsOpen=!1:o.popoverIsOpen=!0)},e.onCalculateRowPrice=function(t){_.each(e.pricebookItems,function(e){t.pi_id==e.pi_id&&(e.selling_price=u(e.sell_price||0,e.markup||0,e.discount||0))})},e.onCalculatePrice=function(){e.product.selling_price=u(e.product.sell_price||0,e.product.markup||0,e.product.discount||0)},e.applyItemPrice=function(e){_.isEmpty(e)||i.pricebook_id&&o.updatePriceBookItemPrice(i.pricebook_id,e.pi_id,{sell_price:e.sell_price,markup:e.markup,discount:e.discount,min_quantity:e.min_quantity,max_quantity:e.max_quantity}).then(function(t){return 200==t.statusCode&&t.response.success?(s.success(t.response.msg,"Success"),void(e.popoverIsOpen=!1)):void s.error(t.response.msg,"Error")})},e.searchProductData=function(){if(e.txtProductSearch&&_.isEmpty(e.tagsFilter))e.pricebookItems=c("filter")(e.pricebookItems,e.txtProductSearch),e.searchcopy=angular.copy(e.pricebookItems);else if(_.isEmpty(e.txtProductSearch)&&e.tagsFilter.length>0){var t=[];e.tagsFilter&&e.tagsFilter.length>0&&_.each(e.tagsFilter,function(o){_.each(e.pricebookItemsCopy,function(e){var s=_.find(e.product_tags,{tags_id:o});s&&t.push(e)})}),e.pricebookItems=t}else if(_.isEmpty(e.txtProductSearch)||_.isEmpty(e.tagsFilter))e.refreshData();else{var t=[];e.tagsFilter&&e.tagsFilter.length>0&&_.each(e.tagsFilter,function(o){_.each(e.searchcopy,function(e){var s=_.find(e.product_tags,{tags_id:o});s&&t.push(e)})}),e.pricebookItems=t}},e.changeSelectDeselectAllProduct=function(){_.each(e.pricebookItems,function(t){t.selected=e.selectDeselectAllProduct,e.checkDataChanges(t)})},e.clickselect=function(){console.log("sadasdsadsa")},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.pi_id===t.pi_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.pi_id!==t.pi_id}),console.log("$scope.selectedDatas:",e.selectedDatas)},e.refreshData=function(){console.log("refreshData"),e.pricebookItems=[],e.pricebookItemsCopy=[],o.getAllPriceBookItem(i.pricebook_id).then(function(t){200==t.statusCode&&t.response.success&&(e.pricebookItems=t.response.result,_.each(e.pricebookItems,function(e){e.popoverIsOpen=!1,e.selling_price=u(e.sell_price||0,e.markup||0,e.discount||0)}),e.pricebookItemsCopy=angular.copy(e.pricebookItems))})},e.addNewEntry=function(){var t=a.open({animation:!0,templateUrl:"./modules/pricebook/pricebook.product.modal.html",controller:"pricebookProductModalCtrl",size:"md"});t.result.then(function(t){e.refreshData()})},e.deleteSelected=function(){e.modal={title:"Remove Items on Pricebook?",message:"Are you sure to remove pricebook for this selected product?"},n.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){if(!(e.selectedDatas.length>0))return void s.error("Please select products to map","Error");if(i.pricebook_id){var t=1;async.eachSeries(e.selectedDatas,function(r,c){r.pi_id&&o.deletePriceBookItem(i.pricebook_id,r.pi_id).then(function(e){return 200==e.statusCode&&e.response.success?(s.success(e.response.msg,"Success"),t++,c(),void 0):void s.error(e.response.msg,"Error")}),t==e.selectedDatas.length&&e.refreshData()})}})},e.deleteSelectedItem=function(t){e.modal={title:"Remove Pricebook Item?",message:"Are you sure to remove this item?"},n.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){i.pricebook_id&&o.deletePriceBookItem(i.pricebook_id,t.pi_id).then(function(t){return 200==t.statusCode&&t.response.success?(s.success(t.response.msg,"Success"),void e.refreshData()):void s.error(t.response.msg,"Error")})})},e.savePricebookItems=function(t){e.modal={title:"Apply batch update",message:"Are you sure to apply this change on the selected product?"},n.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){d(t)})}}angular.module("POS17").controller("pricebookProductCtrl",e),e.$inject=["$scope","productFactory","pricebookFactory","toastr","$state","$stateParams","$filter","ngDialog","$uibModal","tagsFactory","$timeout"]}();
!function(){"use strict";function o(o,t,c,r,u,e,p){o.pb_product={},o.pb_product.markup=0,o.pb_product.discount=0,o.pb_product.min_quantity=0,o.pb_product.max_quantity=0,o.discountchoose=!1,o.pricebookProducts=[],o.pricebookProductBundles=[],o.radioModel="product",o.pb_product.DiscountModel="Amount",o.infiniteScrollContacts={},o.infiniteScrollContacts.numToAdd=10,o.infiniteScrollContacts.currentItems=10,o.$watch("pb_product.product",function(t){t&&(o.pb_product.sell_price=t.sell_price,o.pb_product.selling_price=o.calculateSellingPrice(t.sell_price,o.pb_product.markup||0,o.pb_product.discount||0))}),o.$watch("pb_product.productgroup",function(t){t&&(o.pb_product.sell_price=t.sell_price,o.pb_product.selling_price=o.calculateSellingPrice(t.sell_price,o.pb_product.markup||0,o.pb_product.discount||0))}),o.calculateSellingPrice=function(t,c,r){var u=0;return u="Amount"==o.pb_product.DiscountModel?(parseFloat(t)+parseFloat(c)-parseFloat(r)).toFixed(2):(parseFloat(t)+parseFloat(c)-parseFloat(r)/100).toFixed(2)},o.discountOpt=function(){o.onCalculatePrice()},o.onCalculatePrice=function(){o.pb_product.selling_price=o.calculateSellingPrice(o.pb_product.sell_price||0,o.pb_product.markup||0,o.pb_product.discount||0)},async.waterfall([function(t){r.getAllProduct().then(function(c){if(200==c.statusCode&&c.response.success){var r=c.response.result;_.each(r,function(t){t.selected=!1,1==t.is_published&&o.pricebookProducts.push(t)}),_.uniqBy(o.pricebookProducts,function(o){return o.p_id}),t(null,r)}})},function(t,c){r.getAllProductBundle().then(function(t){if(200==t.statusCode&&t.response.success){var c=t.response.result;_.each(c,function(t){t.selected=!1,1==t.is_published&&o.pricebookProductBundles.push(t)}),_.uniqBy(o.pricebookProductBundles,function(o){return o.pb_id})}})}]),o.resetInfScroll=function(){o.infiniteScrollContacts.currentItems=o.infiniteScrollContacts.numToAdd},o.addMoreItems=function(){o.infiniteScrollContacts.currentItems+=o.infiniteScrollContacts.numToAdd},o.changeData=function(t){o.radioModel=t,"product"==t?(o.pb_product.product=void 0,o.pb_product.productgroup=void 0):(o.pb_product.product=void 0,o.pb_product.productgroup=void 0),o.pb_product.sell_price=0,o.pb_product.markup=0,o.pb_product.discount=0,o.pb_product.min_quantity=0,o.pb_product.max_quantity=0,o.pb_product.selling_price=""},o.saveEntry=function(){_.isUndefined(o.pb_product.product)&&_.isUndefined(o.pb_product.product)?"product"==o.radioModel?c.error("Please Provide Products","Error"):c.error("Please Provide Products Group","Error"):("product"==o.radioModel?(o.pb_product.product_id=o.pb_product.product.p_id,o.pb_product.bundle_id=null):(o.pb_product.bundle_id=o.pb_product.productgroup.pb_id,o.pb_product.product_id=null),p.savePriceBookItem(e.pricebook_id,{markup:o.pb_product.markup,discount:o.pb_product.discount,discount_type:o.pb_product.DiscountModel,sell_price:o.pb_product.sell_price,min_quantity:o.pb_product.min_quantity,max_quantity:o.pb_product.max_quantity,bundle_id:o.pb_product.bundle_id,product_id:o.pb_product.product_id}).then(function(o){if(200==o.statusCode&&o.response.success)c.success(o.response.msg,"Success"),u(function(){t.close()},100);else{if(400!==o.statusCode||o.response.success||!_.isArray(o.response.result))return void c.error(o.response.msg,"Error");_.each(o.response.result,function(o){c.warning(o.msg,"Warning")})}}))},o.cancel=function(){t.dismiss("cancel")}}angular.module("POS17").controller("pricebookProductModalCtrl",o),o.$inject=["$scope","$uibModalInstance","toastr","productFactory","$timeout","$stateParams","pricebookFactory"]}();
!function(){"use strict";function t(t,e,i,a,n){t.paginateNumber=0,t.pagination={currentPage:1,limitWithPage:10,totalPages:0,sumOfPages:0},t.auditlogs=[],t.generateActivityLogs=function(e){a.getPricebookAuditLog(e,{startWith:t.paginateNumber,limit:t.pagination.limitWithPage}).then(function(e){200==e.statusCode&&e.response.success&&(t.auditlogs=e.response.result,t.totalPages=e.response.pagination.pages)})},n&&t.generateActivityLogs(n),t.addMoreItems=function(){t.paginateNumber=t.pagination.currentPage-1,n&&t.generateActivityLogs(n)},t.filterDate=function(){},t.cancel=function(){i.dismiss("cancel")}}angular.module("POS17").controller("pricebookAuditLogModalCtrl",t),t.$inject=["$scope","$state","$uibModalInstance","pricebookFactory","pricebook_id"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(o,e){e.state("main.pricebooktype",{url:"/pricebooktype",templateUrl:"modules/pricebook_type/pricebook_type.html",controller:"priceBookTypeController"}).state("main.pricebookassoctype",{url:"/pricebook_type_assoc",templateUrl:"modules/pricebook_type/pricebook_type_assoc.html",controller:"priceBookAssocTypeController"})}])}();
!function(){"use strict";function e(e,t,o,s,a,c,l,r,n,i,p){console.log("priceBookTypeController"),e.selectDeselectAll=!1,e.selectedDatas=[];var d=JSON.parse(i.get("user"));p.logTransaction("View Pricebook Types","PRICEBOOK TYPES","ALL","User:="+d.username+" View all list of pricebook types"),e.populateData=function(){e.attribisLoading=!0,e.pricebooktypes=[],e.attributecopy=[],e.priceBookTypeTable=new r({page:1,count:10},{counts:[10,25,50,100],getData:function(t,o){n.getAllPriceBookType().then(function(a){if(200==a.statusCode&&a.response.success){var c=a.response.result;if(_.each(c,function(e){e.date_created=moment(e.date_created).format("YYYY-MM-DD")}),e.attributecopy=angular.copy(c),e.txtSearch){e.pricebooktypes=l("filter")(c,e.txtSearch),o.total(e.pricebooktypes.length);var r=e.pricebooktypes.slice((o.page()-1)*o.count(),o.page()*o.count());t.resolve(r)}else{e.pricebooktypes=c,o.total(e.pricebooktypes.length);var r=e.pricebooktypes.slice((o.page()-1)*o.count(),o.page()*o.count());t.resolve(r)}e.attribisLoading=!1}else e.attribisLoading=!1,s.error(a.response.msg,"Error")})}})},e.refresh=function(){e.attribisLoading=!0,e.priceBookTypeTable.reload()},e.searchData=function(){e.priceBookTypeTable.reload()},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.pricebooktypes,function(t){t.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.pt_id===t.pt_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.pt_id!==t.pt_id}),e.deleteSomeData=e.selectedDatas.length>0},e.deleteSelected=function(){console.log("$scope.selectedDatas: ",e.selectedDatas),o.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=0;async.eachSeries(e.selectedDatas,function(o,c){o.selected&&n.deletePriceBookType(o.pt_id).then(function(o){return console.log("data: ",o.response),200==o.statusCode&&o.response.success?(s.success(o.response.msg,"Success"),++t,t==e.selectedDatas.length&&a.reload(),c(),void 0):void s.error(o.response.msg,"Error")})})})},e.addNewEntry=function(e){var o=t.open({animation:!0,templateUrl:"./modules/pricebook_type/pricebook_type.modal.html",controller:"priceBookTypeModal",size:"md",resolve:{group:function(){return e}}});o.result.then(function(e){console.log("selectedItem: ",e),"save"==e&&a.reload()})}}angular.module("POS17").controller("priceBookTypeController",e),e.$inject=["$scope","$uibModal","ngDialog","toastr","$state","$timeout","$filter","ngTableParams","pricebookFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,s,o,c,n,t,i,r,u){e.group={};var a=JSON.parse(r.get("user"));s.article_id?u.logTransaction("View Pricebook Type Details","PRICEBOOK TYPES",s.article_id,"User:="+a.username+" View Pricebook Type details:="+s.article_id):u.logTransaction("Add New Pricebook Type","PRICEBOOK TYPES","N/A","User:="+a.username+" Add new Pricebook Type entry"),_.isUndefined(t)||i.getPriceBookType(t).then(function(s){200==s.statusCode&&s.response.success&&(e.group=s.response.result)}),e.savePriceBook=function(){_.isUndefined(t)?i.savePriceBookType(e.group).then(function(s){200==s.statusCode&&s.response.success&&(n.success("Successfully Added","Success"),c(function(){e.$apply(function(){o.close("save")})},100))}):i.updatePriceBookType(t,e.group).then(function(s){200==s.statusCode&&s.response.success&&(n.success("Successfully Update","Success"),c(function(){e.$apply(function(){o.close("save")})},100))})},e.cancel=function(){o.dismiss("cancel")}}angular.module("POS17").controller("priceBookTypeModal",e),e.$inject=["$scope","$stateParams","$uibModalInstance","$timeout","toastr","group","pricebookFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,t,o,s,a,c,l,r,n,i,p){e.selectDeselectAll=!1,e.selectedDatas=[];var d=JSON.parse(i.get("user"));p.logTransaction("View Pricebook Association Type","PRICEBOOK ASSOCIATION","ALL","User:="+d.username+" View all list of pricebook association types"),e.populateData=function(){e.attribisLoading=!0,e.pricebooktypes=[],e.attributecopy=[],e.priceBookTypeTable=new r({page:1,count:10},{counts:[10,25,50,100],getData:function(t,o){n.getAllPriceBookAssociation().then(function(a){if(200==a.statusCode&&a.response.success){var c=a.response.result;if(_.each(c,function(e){e.date_created=moment(e.date_created).format("YYYY-MM-DD")}),e.attributecopy=angular.copy(c),e.txtSearch){e.pricebooktypes=l("filter")(c,e.txtSearch),o.total(e.pricebooktypes.length);var r=e.pricebooktypes.slice((o.page()-1)*o.count(),o.page()*o.count());t.resolve(r)}else{e.pricebooktypes=c,o.total(e.pricebooktypes.length);var r=e.pricebooktypes.slice((o.page()-1)*o.count(),o.page()*o.count());t.resolve(r)}e.attribisLoading=!1}else e.attribisLoading=!1,s.error(a.response.msg,"Error")})}})},e.refresh=function(){e.attribisLoading=!0,e.priceBookTypeTable.reload()},e.searchData=function(){e.attribisLoading=!0,e.priceBookTypeTable.reload()},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.pricebooktypes,function(t){t.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.pat_id===t.pat_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.pat_id!==t.pat_id}),e.deleteSomeData=e.selectedDatas.length>0},e.deleteSelected=function(){console.log("$scope.selectedDatas: ",e.selectedDatas),o.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=0;async.eachSeries(e.selectedDatas,function(o,c){o.selected&&n.deletePriceBookAssociation(o.pat_id).then(function(o){return console.log("data: ",o.response),200==o.statusCode&&o.response.success?(s.success(o.response.msg,"Success"),++t,t==e.selectedDatas.length&&a.reload(),c(),void 0):void s.error(o.response.msg,"Error")})})})},e.addNewEntry=function(e){var o=t.open({animation:!0,templateUrl:"./modules/pricebook_type/pricebook_type_assoc.modal.html",controller:"priceBookAssocTypeModal",size:"md",resolve:{group:function(){return e}}});o.result.then(function(e){console.log("selectedItem: ",e),"save"==e&&a.reload()})}}angular.module("POS17").controller("priceBookAssocTypeController",e),e.$inject=["$scope","$uibModal","ngDialog","toastr","$state","$timeout","$filter","ngTableParams","pricebookFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";function s(s,e,o,c,n,i,t,u){s.group={};var a=JSON.parse(t.get("user"));_.isNull(n)?u.logTransaction("Add New Pricebook Association Type","PRICEBOOK ASSOCIATION","N/A","User:="+a.username+" Add new Pricebook Association Type entry"):u.logTransaction("View Pricebook Association Type Details","PRICEBOOK ASSOCIATION",n,"User:="+a.username+" View Pricebook Association Type details:="+n),_.isNull(n)||i.getPriceBookAssociation(n).then(function(e){200==e.statusCode&&e.response.success&&(s.group=e.response.result)}),s.savePriceBookAssocType=function(){_.isNull(n)?i.savePriceBookAssociation(s.group).then(function(n){200==n.statusCode&&n.response.success&&(c.success("Successfully Added","Success"),o(function(){s.$apply(function(){e.close("save")})},100))}):i.updatePriceBookAssociation(n,s.group).then(function(n){200==n.statusCode&&n.response.success&&(c.success("Successfully Update","Success"),o(function(){s.$apply(function(){e.close("save")})},100))})},s.cancel=function(){e.dismiss("cancel")}}angular.module("POS17").controller("priceBookAssocTypeModal",s),s.$inject=["$scope","$uibModalInstance","$timeout","toastr","group","pricebookFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,e){e.state("main.settings-company",{url:"/settings/company",templateUrl:"modules/company/companies.html"}).state("main.settings-company-detail",{url:"/settings/company/:company_id",templateUrl:"modules/company/company.detail.html",controller:"companyDetailController"})}])}();
!function(){"use strict";function e(e,t,o,a,l,n,c,s,r,p,i,m){console.log("companyController"),e.details=[],e.selectDeselectAll=!1,e.selectedDatas=[];var d=JSON.parse(i.get("user"));m.logTransaction("View Companies","COMPANIES","ALL","User:="+d.username+" View all list of companies");var u=function(){e.company={},e.companycopy=[],e.companyTable=new s({page:1,count:10},{counts:[10,25,50,100],getData:function(t,a){c.getAllCompany().then(function(l){if(200==l.statusCode&&l.response.success){console.log("data:",l.response.result);var c=l.response.result;if(e.companycopy=angular.copy(e.company),e.txtSearch){e.company=o("filter")(c,e.txtSearch),a.total(e.company.length);var s=e.company.slice((a.page()-1)*a.count(),a.page()*a.count());t.resolve(s)}else{e.company=c,a.total(e.company.length);var s=e.company.slice((a.page()-1)*a.count(),a.page()*a.count());t.resolve(s)}}else n.error(l.response.msg,"Error")})}})};e.searchData=function(){e.companyTable.reload()},e.refresh=function(){e.companyTable.reload(),e.txtSearch=""},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.company,function(t){t.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.company_id===t.company_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.company_id!==t.company_id}),e.deleteSomeData=e.selectedDatas.length>0},e.deleteSelected=function(){p.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var t=0;async.each(e.selectedDatas,function(o,l){o.selected&&(console.log("company: ",o),c.deleteCompany(o.company_id).then(function(o){return console.log("data: ",o.response),200==o.statusCode&&o.response.success?(n.success(o.response.msg,"Success"),++t,t==e.selectedDatas.length&&a.reload(),l(),void 0):void n.error(o.response.msg,"Error")}))})})},e.importCompanies=function(e){"excel"==e?p.open({animation:!0,backdrop:"static",size:"lg",templateUrl:"modules/dialog/import.modal.html",controller:"ImportInstanceCtrl"}):"csv"==e&&p.open({animation:!0,backdrop:"static",size:"lg",templateUrl:"modules/dialog/importcsv.modal.html",controller:"ImportCSVInstanceCtrl",windowClass:"my-modal-popup"})},u()}angular.module("POS17").controller("companyController",e),e.$inject=["$scope","$http","$filter","$state","$timeout","toastr","companyFactory","ngTableParams","ngDialog","$uibModal","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,s,t,o,n,r,l,a,c,i){e.selectDeselectAll=!1,e.applicationStatus="All",e.displayModel="List",e.selectedDatas=[];var p=function(){e.personisLoading=!0,e.persons=[],e.personscopy=[],e.personsTable=new i({page:1,count:10},{counts:[10,25,50,100],getData:function(s,t){l.getAllPerson().then(function(n){if(200==n.statusCode&&n.response.success){var r=n.response.result;e.personscopy=angular.copy(e.persons),_.each(r,function(e){if(_.isNull(e.date_end))e.isActiveAcnt=!0;else{var s=new Date(e.date_start),t=new Date(e.date_end);s<=t?e.isActiveAcnt=!0:e.isActiveAcnt=!1}}),e.txtSearch&&"All"==e.applicationStatus?e.persons=o("filter")(r,e.txtSearch):e.txtSearch&&"Employee"==e.applicationStatus?(e.persons=o("filter")(r,{per_type_id:1}),e.persons=o("filter")(e.persons,e.txtSearch)):e.txtSearch&&"Customer"==e.applicationStatus?(e.persons=o("filter")(r,{per_type_id:2}),e.persons=o("filter")(e.persons,e.txtSearch)):_.isUndefined(e.txtSearch)&&"All"==e.applicationStatus?e.persons=r:_.isUndefined(e.txtSearch)&&"Employee"==e.applicationStatus?e.persons=o("filter")(r,{per_type_id:1}):_.isUndefined(e.txtSearch)&&"Customer"==e.applicationStatus?e.persons=o("filter")(r,{per_type_id:2}):e.persons=r,e.persons=_.filter(e.persons,function(e){if("Customer"==e.person_type&&0==e.isSubscriber)return e}),console.log("persons: ",e.persons),t.total(e.persons.length);var l=e.persons.slice((t.page()-1)*t.count(),t.page()*t.count());s.resolve(l),e.personisLoading=!1}else e.personisLoading=!1,a.error(n.response.msg,"Error")})}})};p(),e.refresh=function(){e.personsTable.reload()},e.updateStatus=function(s){e.applicationStatus=s,e.personsTable.reload()},e.searchData=function(){e.personsTable.reload()},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.persons,function(s){s.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(s)})},e.checkDataChanges=function(s){s.selected?_.find(e.selectedDatas,function(e){return e.person_id===s.person_id})||e.selectedDatas.push(s):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.person_id!==s.person_id}),e.deleteSomeData=e.selectedDatas.length>0},e.toggleModal=function(s){r.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){l.deletePersonel(s).then(function(e){return 200==e.statusCode&&e.response.success?(a.success(e.response.msg,"Success"),void n.reload()):void a.error(e.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},e.deleteSelected=function(){r.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var s=0;async.each(e.selectedDatas,function(t,o){t.selected&&(console.log("person: ",t),l.deletePersonel(t.person_id).then(function(t){return console.log("data: ",t.response),200==t.statusCode&&t.response.success?(a.success(t.response.msg,"Success"),++s,s==e.selectedDatas.length&&n.reload(),o(),void 0):void a.error(t.response.msg,"Error")}))})})}}angular.module("POS17").controller("customerController",e),e.$inject=["$scope","$rootScope","$http","$filter","$state","ngDialog","humanFactory","toastr","$timeout","ngTableParams"]}();
!function(){"use strict";function e(e,s,n,o,t,a,c,r,l,i,u,p,d){e.details={},e.main=[],e.enable=!1,e.countries=[];var m=JSON.parse(p.get("user"));i.article_id?d.logTransaction("View Company Details","COMPANIES",i.company_id,"User:="+m.username+" View company details:="+i.company_id):d.logTransaction("Add New Company","COMPANIES","N/A","User:="+m.username+" Add new company entry"),async.waterfall([function(s){c.getAllCompany().then(function(n){200==n.statusCode&&n.response.success&&(e.main=n.response.result,e.main=_.filter(n.response.result,function(e){return e.company_id!=i.company_id}),s(null,n.response.result))})},function(s,n){u.getAllCountries().then(function(o){200==o.statusCode&&o.response.success&&(e.countries=o.response.result,n(null,s,o.response.result))})},function(s,n,o){i.company_id&&c.getCompanyInfo(i.company_id).then(function(s){200==s.statusCode&&s.response.success&&(e.details=s.response.result,o(null,s.response.result))})}]),e.enabledMainEvent=function(s){0==s&&(e.office=void 0,e.details.parent_id=0)},e.select=function(s){console.log("value:",s),e.details.parent_id=s.company_id},e.saveCompany=function(){console.log("$scope.details:",e.details),i.company_id?c.updateCompany(i.company_id,e.details).then(function(e){200==e.statusCode&&e.response.result&&(a.success(e.response.msg,"Success"),console.log("data:",e.response),o.go(o.current,{company_id:i.company_id},{reload:!0}))}):(console.log("$scope.details:",e.details),c.saveCompany(e.details).then(function(e){200==e.statusCode&&e.response.result&&(console.log("data:",e),a.success(e.response.msg,"Success"),o.go(o.current,{company_id:e.response.result},{reload:!0}))}))}}angular.module("POS17").controller("companyDetailController",e),e.$inject=["$scope","$http","$filter","$state","$timeout","toastr","companyFactory","ngTableParams","ngDialog","$stateParams","countryFactory","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,t,s,o,r,n,c,a,u,l,i,p){console.log("companyGroupingsController"),e.groups=[],e.groupsCopy=[],e.selectDeselectAll=!1,e.selectedDatas=[],e.refreshData=function(){console.log("refreshData"),async.waterfall([function(t){e.groups=[],e.groupsCopy=[],a.getCustomerGroup().then(function(s){if(200==s.statusCode&&s.response.success){var o=s.response.result;e.groups=o,e.groupsCopy=angular.copy(o),t(null,o)}})},function(t,s){l.company_id&&c.getCustomerGroup(l.company_id).then(function(t){if(200==t.statusCode&&t.response.success){var s=t.response.result;_.each(e.groups,function(t){var o=_.find(s,{customer_group_id:t.cg_id});o?(t.selected=!0,e.checkDataChanges(t)):t.selected=!1}),e.groupsCopy=[],e.groupsCopy=angular.copy(e.groups)}})}])},e.refreshData(),e.addGroups=function(t){var s=p.open({animation:!0,templateUrl:"./modules/humanresource/groups/customer.groups.modal.html",controller:"customerGroupModalController",size:"md",resolve:{selected:function(){return t}}});s.result.then(function(t){e.refreshData()})},e.searchData=function(){e.txtSearch?e.groups=s("filter")(e.groupsCopy,e.txtSearch):e.groups=e.groupsCopy},e.changeSelectDeselectAll=function(){_.each(e.groups,function(t){t.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(t)})},e.checkDataChanges=function(t){t.selected?_.find(e.selectedDatas,function(e){return e.cg_id===t.cg_id})||e.selectedDatas.push(t):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.cg_id!==t.cg_id}),e.deleteSomeData=e.selectedDatas.length>0},e.saveCustomerGrouping=function(){if(l.company_id){if(!(e.selectedDatas.length>0))return void n.warning("Please select groups for customer grouping","WARNING");async.waterfall([function(e){c.deleteCustomerGroup(l.company_id).then(function(t){200==t.statusCode&&t.response.success&&e(null,l.company_id)})},function(t,s){var r=0;async.each(e.selectedDatas,function(t,s){t.selected&&c.saveCustomerGroup(l.company_id,{customer_group_id:t.cg_id}).then(function(t){return 200==t.statusCode&&t.response.success?(n.success(t.response.msg,"Success"),++r,r==e.selectedDatas.length&&o.reload(),s(),void 0):void n.error(t.response.msg,"Error")})})}])}}}angular.module("POS17").controller("companyGroupingsController",e),e.$inject=["$scope","$http","$filter","$state","$timeout","toastr","companyFactory","humanFactory","ngDialog","$stateParams","countryFactory","$uibModal"]}();
!function(){"use strict";function e(e,s,t,c,o,n,i,l,r,a,d){e.selectDeselectAll=!1,e.selectedDatas=[];var u=function(){e.deviceisLoading=!0,e.devices=[],e.devicescopy=[],e.deviceTable=new r({page:1,count:10},{counts:[10,25,50,100],getData:function(s,c){i.getDeviceSelected(a.store_id).then(function(n){if(200==n.statusCode&&n.response.success){var i=n.response.result;if(e.devicescopy=angular.copy(e.devices),e.txtSearch){e.devices=t("filter")(i,e.txtSearch),c.total(e.devices.length);var l=e.devices.slice((c.page()-1)*c.count(),c.page()*c.count());s.resolve(l)}else{e.devices=i,c.total(e.devices.length);var l=e.devices.slice((c.page()-1)*c.count(),c.page()*c.count());s.resolve(l)}e.deviceisLoading=!1}else e.deviceisLoading=!1,o.error(n.response.msg,"Error")})}})};e.toggleModal=function(s,t){n.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){i.deleteassignDevice(s.dm_id).then(function(s){return 200==s.statusCode&&s.response.success?(e.deviceTable.reload(),void o.success(s.response.msg,"Success")):void o.error(s.response.msg,"Error")})},function(e){console.log("Modal promise close: ")})},e.deleteSelected=function(){n.openConfirm({templateUrl:"modules/dialog/deleteDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){e.params=[],e.selectedDatas.forEach(function(s){e.params.push(s)}),i.Reassigndevice(e.params).then(function(s){return 200==s.statusCode&&s.response.success?(e.deviceTable.reload(),void o.success(s.response.msg,"Success")):void o.error(s.response.msg,"Error")})})},e.changeSelectDeselectAll=function(){e.selectDeselectAll=!e.selectDeselectAll,_.each(e.devices,function(s){s.selected=e.selectDeselectAll,e.deleteSomeData=e.selectDeselectAll,e.checkDataChanges(s)})},e.refresh=function(){e.deviceTable.reload()},e.checkDataChanges=function(s){s.selected?_.find(e.selectedDatas,function(e){return e.device_id===s.device_id})||e.selectedDatas.push(s):e.selectedDatas=_.filter(e.selectedDatas,function(e){return e.device_id!==s.device_id}),e.deleteSomeData=e.selectedDatas.length>0},e.addNewEntry=function(){var s=d.open({animation:!0,templateUrl:"./modules/stores/detail/device.modal.html",controller:"deviceModalController",size:"lg",resolve:{store:function(){return a.store_id}}});s.result.then(function(s){e.deviceTable.reload()})},u()}function s(e,s,t,c,o,n){e.device={},s.getUnSelectedDevice(t).then(function(s){200==s.statusCode&&s.response.success&&(e.devices=s.response.result)}),e.saveEntry=function(){return _.isUndefined(e.device.store.device_id)?void o.warning("Unable to saved device. Please select device before we proceed.","Warning"):void s.assignDevice(t,e.device.store).then(function(e){if(200==e.statusCode&&e.response.success)n(function(){c.close()},600),o.success(e.response.msg,"Success");else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void o.error(e.response.msg,"Error");_.each(e.response.result,function(e){o.warning(e.msg,"Warning")})}})},e.cancel=function(){c.dismiss("cancel")}}angular.module("POS17").controller("deviceController",e).controller("deviceModalController",s),e.$inject=["$scope","$http","$filter","$state","toastr","ngDialog","deviceFactory","$timeout","ngTableParams","$stateParams","$uibModal"],s.$inject=["$scope","deviceFactory","store","$uibModalInstance","toastr","$timeout"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(t,e){e.state("main.settings-app",{url:"/settings/app",templateUrl:"modules/appsettings/appsettings.html",controller:"appSettingsController"}).state("main.settings-app-log",{url:"/settings/app/log/:userId",templateUrl:"modules/appsettings/logs.html",controller:"appSettingsController"})}])}();
!function(){"use strict";function e(e,p,s,a,t,i){e.app={device:!0,apikeys:!1,user:!1,payment:!1,logs:!1},e.showTab=function(p){"device"==p?e.app={device:!0,apikeys:!1,user:!1,payment:!1,logs:!1}:"apikeys"==p?e.app={device:!1,apikeys:!0,user:!1,payment:!1,logs:!1}:"user"==p?e.app={device:!1,apikeys:!1,user:!0,payment:!1,logs:!1}:"logs"==p?e.app={device:!1,apikeys:!1,user:!1,payment:!1,logs:!0}:"payment"==p&&(e.app={device:!1,apikeys:!1,user:!1,payment:!0,logs:!1})}}angular.module("POS17").controller("appSettingsController",e),e.$inject=["$scope","$filter","$state","ngDialog","toastr","$timeout"]}();
!function(){"use strict";function e(e,i,n,c,t,s,a,o,u,l){function r(i){_.each(e.devices,function(e){(e.device_id=i.device_id)&&(e.isSyncing=i.isSyncing),e.isBackup=i.isBackup})}e.applicationStatus="All",e.devices=[];var p=JSON.parse(u.get("user"));l.logTransaction("View Device Settings","APPLICATION SETTINGS","DEVICE","User:="+p.username+" View all list of subscribe devices"),e.init=function(){o.getAllDevices().then(function(i){200==i.statusCode&&i.response.success&&(e.devices=i.response.result,_.each(e.devices,function(e){e.isOnline=!1,e.isSyncing=!1,e.isBackup=!1}))})},e.refresh=function(){e.devices=[],e.init()},e.updateStatus=function(i){e.applicationStatus=i},e.syncData=function(e){t.info("Sync started..."),e.isSyncing=!0,r(e),s(function(){e.isSyncing=!1,r(e),t.success("Data successfully sync","Success")},2e3)},e.backupData=function(e){t.info("Backup started..."),e.isBackup=!0,r(e),s(function(){e.isBackup=!1,r(e),t.success("Data successfully backup","Success")},2e3)},e.openDeviceNotification=function(e){a.open({animation:!0,templateUrl:"./modules/appsettings/device.notification.modal.html",controller:"appSettingsDeviceModalController",size:"md"})}}function i(e,i){e.cancel=function(){i.dismiss("cancel")}}angular.module("POS17").controller("appSettingsDeviceController",e).controller("appSettingsDeviceModalController",i),e.$inject=["$scope","$filter","$state","ngDialog","toastr","$timeout","$uibModal","appSettingsFctry","localStorageService","transLogFctry"],i.$inject=["$scope","$uibModalInstance"]}();
!function(){"use strict";function e(e,s,t,n,i,o,r,a,c){e.apikeys=[];var u=JSON.parse(a.get("user"));c.logTransaction("View API Keys Settings","APPLICATION SETTINGS","API KEYS","User:="+u.username+" View all list of API Keys"),e.init=function(){r.getAllAPIKeys().then(function(s){200==s.statusCode&&s.response.success&&(e.apikeys=s.response.result,_.each(e.apikeys,function(e){e.showKeys=!1}))})},e.init(),e.refresh=function(){e.apikeys=[],e.init()},e.newAPIKeys=function(e){},e.showKey=function(e){return e.showKeys?e.showKeys=!1:e.showKeys=!0,e}}angular.module("POS17").controller("appSettingsKeysController",e),e.$inject=["$scope","$filter","$state","ngDialog","toastr","$timeout","appSettingsFctry","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,t,i,a,s,c,o,r,l){function n(t){200==t.statusCode&&t.response.success&&(e.socialauths=t.response.result,e.facebook={apiKey:e.socialauths.facebook_clientID,apiSecret:e.socialauths.facebook_clientSecret,redirectUri:e.socialauths.facebook_redirectUri,isEnable:e.socialauths.facebook_isEnable,activated:!_.isEmpty(e.socialauths.facebook_activated),request:!_.isEmpty(e.socialauths.facebook_request),social_auth_id:e.socialauths.social_auth_id},e.twitter={apiKey:e.socialauths.twitter_clientID,apiSecret:e.socialauths.twitter_clientSecret,redirectUri:e.socialauths.twitter_redirectUri,isEnable:e.socialauths.twitter_isEnable,activated:!_.isEmpty(e.socialauths.twitter_activated),request:!_.isEmpty(e.socialauths.twitter_request),social_auth_id:e.socialauths.social_auth_id},e.google={apiKey:e.socialauths.google_clientID,apiSecret:e.socialauths.google_clientSecret,redirectUri:e.socialauths.google_redirectUri,isEnable:e.socialauths.google_isEnable,activated:!_.isEmpty(e.socialauths.google_activated),request:!_.isEmpty(e.socialauths.google_request),social_auth_id:e.socialauths.social_auth_id},e.linkedin={apiKey:e.socialauths.linkedIn_clientID,apiSecret:e.socialauths.linkedIn_clientSecret,redirectUri:e.socialauths.linkedIn_redirectUri,isEnable:e.socialauths.linkedIn_isEnable,activated:!_.isEmpty(e.socialauths.linkedIn_activated),social_auth_id:e.socialauths.social_auth_id})}e.socialauths=[],e.active=!0,e.facebook={apiKey:"",apiSecret:"",redirectUri:"",isEnable:!1,activated:!1,request:!1},e.twitter={apiKey:"",apiSecret:"",redirectUri:"",isEnable:!1,activated:!1,request:!1},e.google={apiKey:"",apiSecret:"",redirectUri:"",isEnable:!1,activated:!1,request:!1},e.linkedin={apiKey:"",apiSecret:"",redirectUri:"",isEnable:!1,activated:!1,request:!1};var u=JSON.parse(r.get("user"));l.logTransaction("View User Auth Settings","APPLICATION SETTINGS","USER AUTH","User:="+u.username+" View all list of User Authentication options"),o.getSocialAuth().then(n),e.refresh=function(){o.getSocialAuth().then(n)},e.activateSocialAuth=function(t){e.modal={title:"Social Media Auth Activation",message:"Are you sure to activate "+t.toUpperCase()+" authentication for your 3rd party apps?"},a.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){o.activateSocialAuth({provider:t}).then(function(e){if(200==e.statusCode&&e.response.success)s.success(e.response.msg,"Success"),c(function(){i.reload()},1e3);else{if(400!==e.statusCode||e.response.success||!_.isArray(e.response.result))return void s.error(e.response.msg,"Error");_.each(e.response.result,function(e){s.warning(e.msg,"Warning")})}})})}}angular.module("POS17").controller("appSettingsUserAuthController",e),e.$inject=["$scope","$filter","$state","ngDialog","toastr","$timeout","appSettingsFctry","localStorageService","transLogFctry"]}();
!function(){"use strict";function t(t,e,a,n,o,r,i,l,s){console.log("appSettingsPaymentController");var c=JSON.parse(l.get("user"));s.logTransaction("View Payment Gateway Settings","APPLICATION SETTINGS","PAYMENT GATEWAYS","User:="+c.username+" View all list of Payment Gateway configuration")}angular.module("POS17").controller("appSettingsPaymentController",t),t.$inject=["$scope","$filter","$state","ngDialog","toastr","$timeout","appSettingsFctry","localStorageService","transLogFctry"]}();
!function(){"use strict";function e(e,t,s,r,a,o){var n=JSON.parse(a.get("user"));o.logTransaction("View User Log Settings","APPLICATION SETTINGS","USER LOGS","User:="+n.username+" View all list of User have logs"),e.usersTable=new r({page:1,count:20},{counts:[20,35,50,100],getData:function(t,r){s.getAllUserAccounts().then(function(s){if(200==s.statusCode&&s.response.success){var a=s.response.result;e.txtSearchUser?e.users=$filter("filter")(a,e.txtSearch2):e.users=a,r.total(e.users.length);var o=e.users.slice((r.page()-1)*r.count(),r.page()*r.count());t.resolve(o)}else toastr.error(s.response.msg,"Error"),$activityIndicator.stopAnimating(),callback(null,"error")})}}),e.searchData=function(){e.usersTable.reload()},e.viewUserLogs=function(e){t.go("main.settings-app-log",{userId:e})}}function t(e,t,s,r,a,o,n,l,c,u,i){function g(e){var t=new Date(e),s=6e4*(new Date).getTimezoneOffset(),r=new Date(t.getTime()+s),a=r.getHours(),o=r.getMinutes(),n=a>=12?"pm":"am";a%=12,a=a?a:12,o=o<10?"0"+o:o;var l=a+":"+o+" "+n;return r.getMonth()+1+"/"+r.getDate()+"/"+r.getFullYear()+"  "+l}t.details={},t.details.dateFrom=moment(),t.details.dateEnd=moment();var m=JSON.parse(i.get("user"));c.logTransaction("View User Logs","APPLICATION SETTINGS",a.userId,"User:="+m.username+" View all list of User Logs"),t.usersTable=new u({page:1,count:50},{counts:[50,65,80,100],getData:function(e,r){c.getAllLogs({userId:a.userId,dateFrom:moment(t.details.dateFrom).format("YYYY-MM-DD"),dateEnd:moment(t.details.dateEnd).format("YYYY-MM-DD")}).then(function(a){if(200==a.statusCode&&a.response.success){var o=a.response.result;_.each(o,function(e){e.created_at=g(e.created_at)}),t.txtSearchUser?t.users=s("filter")(o,t.txtSearchUser):t.users=o,r.total(t.users.length);var l=t.users.slice((r.page()-1)*r.count(),r.page()*r.count());e.resolve(l)}else n.error(a.response.msg,"Error"),callback(null,"error")})}}),t.searchData=function(){t.usersTable.reload()}}angular.module("POS17").controller("appSettingsLogController",e).controller("appSettingsUserLogController",t),e.$inject=["$scope","$state","useraccountsFctry","ngTableParams","localStorageService","transLogFctry"],t.$inject=["$window","$scope","$filter","$state","$stateParams","ngDialog","toastr","$timeout","transLogFctry","ngTableParams","localStorageService"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(s,t){t.state("main.assets",{url:"/assets",templateUrl:"modules/assets/assets.html",controller:"assetsController"}).state("main.starred",{url:"/assets/starred",templateUrl:"modules/assets/assets.html",controller:"assetsController"}).state("main.shared-with-me",{url:"/assets/shared-with-me/:_id?share",templateUrl:"modules/assets/assets.html",controller:"assetsController"}).state("main.shared-with-me_sub",{url:"/assets/shared-with-me/:_id/s/:sub_id",templateUrl:"modules/assets/assets.html",controller:"assetsController"}).state("main.trash",{url:"/assets/trash",templateUrl:"modules/assets/assets.html",controller:"assetsController"}).state("main.assets_folder",{url:"/assets/folders/:_id",templateUrl:"modules/assets/assets.html",controller:"assetsController"}).state("main.assets_sub_folder",{url:"/assets/folders/:_id/s/:sub_id",templateUrl:"modules/assets/assets.html",controller:"assetsController"})}])}();
!function(){"use strict";angular.module("POS17").controller("assetsController",["$scope","assetsFctry","$stateParams","$state","$uibModal","localStorageService","AuthFctry","ngDialog","toastr","$timeout","Lightbox","PDFJS","async","transLogFctry",function(e,s,t,o,i,l,a,n,r,d,c,u,m,h){function f(e,s){if(0==e)return"0 Byte";var t=1024,o=s+1||3,i=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],l=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,l)).toFixed(o))+" "+i[l]}function p(s){_.each(e.assets.assets,function(s){"application/pdf"==s.asset_mimetype&&(s.thumbnail=_.find(e.filesThumbs,{_id:s._id}))})}function g(s){if(200==s.statusCode&&s.response.success){if(e.items=s.response.result,e.assets=angular.copy(s.response.result),e.isLoading=!1,e.showBread=!0,e.disableToolNewFolder=!1,"main.assets"==o.current.name){var i=JSON.parse(l.get("user"));h.logTransaction("Assets and Presentation","ASSETS","ALL","User:="+i.username+" View ALL Asset and Presentation"),e.activeAllFiles=!0,e.assets.folders=_.filter(e.assets.folders,function(e){return 0==e.isDeleted}),e.assets.assets=_.filter(e.assets.assets,function(e){return 0==e.isDeleted&&null==e.folder_id})}else if("main.starred"==o.current.name){var i=JSON.parse(l.get("user"));h.logTransaction("Assets and Presentation","ASSETS","Starred","User:="+i.username+" View Starred Asset and Presentation"),e.activeStarredFiles=!0,e.assets.folders=_.filter(e.assets.folders,function(e){return 0==e.isDeleted&&1==e.isStarred}),e.assets.assets=_.filter(e.assets.assets,function(e){return 0==e.isDeleted&&1==e.isStarred})}else if("main.shared-with-me"==o.current.name){var i=JSON.parse(l.get("user"));h.logTransaction("Assets and Presentation","ASSETS","Shared","User:="+i.username+" View Shared Asset and Presentation"),e.activeSharedFiles=!0,e.assets.folders=_.filter(e.assets.folders,function(e){return 0==e.isDeleted}),t._id&&_.isUndefined(t.sub_id)?e.assets.assets=_.filter(e.assets.assets,function(e){return 0==e.isDeleted}):t._id&&t.sub_id?e.assets.assets=_.filter(e.assets.assets,function(e){return 0==e.isDeleted}):e.assets.assets=_.filter(e.assets.assets,function(e){return 0==e.isDeleted&&null==e.folder_id})}else if("main.trash"==o.current.name){var i=JSON.parse(l.get("user"));h.logTransaction("Assets and Presentation","ASSETS","Starred","User:="+i.username+" View Trash Asset and Presentation"),e.activeTrashFiles=!0,e.showBarDelete=!0,e.showBarRestore=!0,e.showBarShare=!1,e.showBarEmail=!1,e.showToolPreview=!1,e.showBarMore=!1,e.assets.folders=_.filter(e.assets.folders,function(e){return 1==e.isDeleted}),e.assets.assets=_.filter(e.assets.assets,function(e){return 1==e.isDeleted})}else"main.assets_folder"==o.current.name&&(e.activeAllFiles=!0);if(e.assets.folders&&e.assets.folders.length>0&&_.each(e.assets.folders,function(e){var s=_.sumBy(e.files,function(e){return e.asset_filesize});e.folder_filesize=f(s),e.isActive=!1,e.isFolder=!0,null==e.isPublic&&(e.isPublic=0)}),e.assets.assets&&e.assets.assets.length>0){var a=_.filter(e.assets.assets,function(e){return"application/pdf"==e.asset_mimetype}).length;m.each(e.assets.assets,function(s,t){s.asset_filesize=f(s.asset_filesize),s.isActive=!1,s.isFolder=!1,null==s.isPublic&&(s.isPublic=0),"application/pdf"==s.asset_mimetype&&u.getDocument(s.asset_url).then(function(o){o.getPage(1).then(function(o){var i=o.getViewport(.5),l=document.createElement("canvas"),n=l.getContext("2d");l.height=i.height,l.width=i.width;var r={canvasContext:n,viewport:i};o.render(r).then(function(){n.globalCompositeOperation="destination-over",n.fillStyle="#fff",n.fillRect(0,0,l.width,l.height);var o=l.toDataURL();d(function(){e.$apply(function(){e.filesThumbs.push({_id:s._id,asset_mimetype:s.asset_mimetype,thumbnail:o}),a-1==e.filesThumbs.length&&p(e.filesThumbs)})},10),l.remove(),t()})})})})}e.assets.folders&&e.assets.assets&&(e.assets.folders.length>0&&e.assets.assets.length>0?e.showFiles=!0:e.assets.folders.length>0&&e.assets.assets.length<1?e.showFiles=!0:e.assets.folders.length<1&&e.assets.assets.length>0?e.showFiles=!0:e.assets.folders.length<1&&e.assets.assets.length<1&&(e.showFiles=!1))}}function F(s){_.each(e.assets.folders,function(e){e._id!==s._id&&(e.isActive=!1)}),_.each(e.assets.assets,function(e){e._id!==s._id&&(e.isActive=!1)})}e.items={},e.assets={},e.trash={},e.starred={},e.selectedFile={},e.selectedFiles=[],e.filesThumbs=[],e.filesize=0,e.fileSize_t=0,e.fileRemain=0,e.isList="null"!=l.get("isList")&&0!=l.get("isList"),e.isLoading=!0,e.showBread=!1,e.showFiles=!1,e.disableToolNewFolder=!0,e.showToolNewFolder=!0,e.showToolMakeCopy=!1,e.showToolPreview=!1,e.showBarDelete=!1,e.showBarRestore=!1,e.showBarShare=!1,e.showBarEmail=!1,e.showBarMore=!1,e.showBarMove=!1,e.showBarAddStar=!1,e.showBarRemoveStar=!1,e.showBarRename=!1,e.activeAllFiles=!1,e.activeSharedFiles=!1,e.activeStarredFiles=!1,e.activeTrashFiles=!1;var w=!1;e.upload=!1,e.refreshAssets=function(){e.assets={},e.items={},t._id&&_.isUndefined(t.sub_id)?(e.isLoading=!0,"main.shared-with-me"==o.current.name?s.getFolderAssets(t._id,"public").then(g):s.getFolderAssets(t._id,"").then(g)):t._id&&t.sub_id?(e.showToolNewFolder=!1,e.isLoading=!0,"main.shared-with-me_sub"==o.current.name?s.getFolderAssets(t.sub_id,"public").then(g):s.getFolderAssets(t.sub_id,"").then(g)):"main.shared-with-me"==o.current.name?s.getAllAssets({action:"shared"}).then(g):s.getAllAssets({}).then(g),s.getAllAssets().then(function(s){if(200==s.statusCode&&s.response.success){var t=s.response.result,o=_.sumBy(t.assets,function(e){return e.asset_filesize});e.filesize=o;var i=2147483648;e.fileRemain=i-e.filesize}})},e.changeDisplay=function(){e.isList=!e.isList,l.set("isList",e.isList)},e.showAllFiles=function(){"main.assets"==o.current.name?e.refreshAssets():o.go("main.assets")},e.showAllTrash=function(){"main.trash"==o.current.name?e.refreshAssets():o.go("main.trash")},e.showAllStarred=function(){"main.starred"==o.current.name?e.refreshAssets():o.go("main.starred")},e.showAllShared=function(){"main.shared-with-me"==o.current.name?e.refreshAssets():o.go("main.shared-with-me")},e.doGreeting=function(){w&&d.cancel(w),e.upload=!0},e.newUploader=function(){if(!(e.fileRemain>0))return void r.error("WARNING: Storage full, unable to create file uploads.","Error");var s=i.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/assets.uploader.html",size:"lg",controller:"assetsUploadModalCtrl"});s.result.then(function(s){s&&e.refreshAssets()})},e.createNewFolder=function(){var e=i.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/newfolder.modal.html",size:"sm",controller:"assetsFolderModalCtrl"});e.result.then(function(e){e&&o.reload()})},e.shareToOthers=function(){if(e.selectedFile){var s=i.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/sharer.modal.html",size:"md",controller:"assetsShareModalCtrl",resolve:{asset_file:function(){return e.selectedFile}}});s.result.then(function(e){e&&o.reload()})}},e.emailToOthers=function(){if(e.selectedFile){var s=i.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/sharer-email.modal.html",size:"md",controller:"assetsShareEmailModalCtrl"});s.result.then(function(e){e&&o.reload()})}},e.renameSelected=function(){if(e.selectedFile){var s=i.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/assets.rename.html",size:"md",controller:"assetsRenameModalCtrl",resolve:{asset_file:function(){return e.selectedFile}}});s.result.then(function(e){e&&o.reload()})}},e.showInfoSelected=function(){if(e.selectedFile){var s=i.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/assets.info.html",size:"md",controller:"assetsInfoModalCtrl",resolve:{asset_file:function(){return e.selectedFile}}});s.result.then(function(e){e&&o.reload()})}},e.deleteSelected=function(){function t(s){console.log("handleResponse"),200==s.statusCode&&s.response.success&&(r.success(s.response.msg,"Success"),d(function(){e.refreshAssets()},1e3))}e.selectedFiles.length>0?e.modal={title:"Remove selected?",message:"Are you sure to remove the selected files?"}:e.modal={title:"Remove?",message:"Are you sure to remove this?"},n.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){var i=1;e.selectedFiles.length>0?m.eachSeries(e.selectedFiles,function(t,l){t.isFolder?t.isDeleted?s.deleteFolder(t._id).then(function(e){200==e.statusCode&&e.response.success&&(r.success(e.response.msg,"Success"),i++,l())}):s.trashFolder(t._id).then(function(e){200==e.statusCode&&e.response.success&&(r.success(e.response.msg,"Success"),i++,l())}):t.isDeleted?s.deleteAssetFile(t._id).then(function(e){200==e.statusCode&&e.response.success&&(r.success(e.response.msg,"Success"),i++,l())}):s.trashAssetFile(t._id).then(function(e){200==e.statusCode&&e.response.success&&(r.success(e.response.msg,"Success"),i++,l())}),e.selectedFiles.length>=i&&d(function(){o.reload()},1e3)}):_.isEmpty(e.selectedFile)||(e.selectedFile.isFolder?e.selectedFile.isDeleted?s.deleteFolder(e.selectedFile._id).then(t):s.trashFolder(e.selectedFile._id).then(t):e.selectedFile.isDeleted?s.deleteAssetFile(e.selectedFile._id).then(t):s.trashAssetFile(e.selectedFile._id).then(t))})},e.moveSelected=function(){if(e.selectedFile){var s=i.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/assets.move.html",size:"",controller:"assetsMoveModalCtrl",resolve:{asset_file:function(){return e.selectedFile}}});s.result.then(function(e){e&&o.reload()})}},e.previewSelected=function(){e.selectedFile&&e.openFile(e.selectedFile)},e.starredSelected=function(){function t(e){200==e.statusCode&&e.response.success&&(r.success(e.response.msg,"Success"),d(function(){o.reload()},200))}if(e.selectedFiles.length>0){var i=0;m.eachSeries(e.selectedFiles,function(t,l){t.isFolder?s.starredFolder(t._id).then(function(e){200==e.statusCode&&e.response.success&&(r.success(e.response.msg,"Success"),i++,console.log("count1: ",i),l())}):s.starredFolder(t._id).then(function(e){200==e.statusCode&&e.response.success&&(r.success(e.response.msg,"Success"),i++,console.log("count2: ",i),l())}),e.selectedFiles.length>=i&&o.reload()})}else e.selectedFile&&(e.selectedFile.isFolder?s.starredFolder(e.selectedFile._id).then(t):s.starredAssetFile(e.selectedFile._id).then(t))},e.restoreSelected=function(){function t(e){200==e.statusCode&&e.response.success&&(r.success(e.response.msg,"Success"),d(function(){o.reload()},200))}if(e.selectedFiles.length>0){var i=0;m.each(e.selectedFiles,function(t,l){t.isFolder?s.restoreFolder(t._id).then(function(e){200==e.statusCode&&e.response.success&&(r.success(e.response.msg,"Success"),i++,console.log("count1: ",i),l())}):s.restoreAssetFile(t._id).then(function(e){200==e.statusCode&&e.response.success&&(r.success(e.response.msg,"Success"),i++,console.log("count2: ",i),l())}),e.selectedFiles.length>=i&&o.reload()})}else e.selectedFile&&(e.selectedFile.isFolder?s.restoreFolder(e.selectedFile._id).then(t):s.restoreAssetFile(e.selectedFile._id).then(t))},e.openLightboxModal=function(e){console.log("openLightboxModal: ",e);var s=[];s.push({url:e.asset_url,caption:e.asset_name,thumbUrl:e.asset_url}),console.log("arry: ",s),c.openModal(s,0)},e.openVideoModal=function(e){i.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/assets.media.html",controller:"assetsMediaModalCtrl",size:"lg",resolve:{files:function(){return e},type:function(){return"video"}}})},e.openAudioModal=function(e){i.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/assets.media.html",controller:"assetsMediaModalCtrl",size:"md",resolve:{files:function(){return e},type:function(){return"audio"}}})},e.openDocsModal=function(e){i.open({animation:!0,backdrop:"static",templateUrl:"./modules/assets/assets.docs.html",controller:"assetsDocsModalCtrl",size:"lg",windowClass:"modal-fullscreen",resolve:{files:function(){return e}}})},e.openFolder=function(i){console.log("$stateParams: ",t),console.log("folder._id: ",i._id),i.isFolder&&("main.trash"!==o.current.name?"main.shared-with-me"==o.current.name?t._id?o.go("main.shared-with-me_sub",{_id:t._id,sub_id:i._id}):o.go("main.shared-with-me",{_id:i._id}):t._id?o.go("main.assets_sub_folder",{_id:t._id,sub_id:i._id}):o.go("main.assets_folder",{_id:i._id}):(e.modal={title:"This folder is in your trash",message:"To view this folder, youll need to restore it from your trash. Restore folder?"},n.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){s.restoreFolder(i._id).then(function(e){200==e.statusCode&&e.response.success&&(r.success(e.response.msg,"Success"),d(function(){o.reload()},200))})})))},e.openFile=function(s){if("image/jpeg"==s.asset_mimetype||"image/jpg"==s.asset_mimetype||"image/gif"==s.asset_mimetype||"image/x-ms-bmp"==s.asset_mimetype||"image/png"==s.asset_mimetype)e.openLightboxModal(s);else if("audio/mp3"==s.asset_mimetype||"audio/mp4"==s.asset_mimetype)e.openAudioModal(s);else if("video/mp4"==s.asset_mimetype||"video/x-flv"==s.asset_mimetype||"video/x-msvideo"==s.asset_mimetype||"video/x-ms-wmv"==s.asset_mimetype||"video/quicktime"==s.asset_mimetype||"video/3gpp"==s.asset_mimetype)e.openVideoModal(s);else if("application/pdf"==s.asset_mimetype)e.openDocsModal(s);else if("text/plain"==s.asset_mimetype)e.openDocsModal(s);else if("application/msword"==s.asset_mimetype||"application/vnd.openxmlformats-officedocument.wordprocessingml.document"==s.asset_mimetype)e.openDocsModal(s);else if("text/csv"==s.asset_mimetype||"application/vnd.ms-excel"==s.asset_mimetype||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==s.asset_mimetype)e.openDocsModal(s);else{if("application/vnd.openxmlformats-officedocument.presentationml.presentation"!=s.asset_mimetype&&"application/vnd.ms-powerpoint"!=s.asset_mimetype)return void r.warning("No available tools to open","Failed");e.openDocsModal(s)}},e.deleteFile=function(t){console.log("media: ",t),e.modal={title:"Remove File",message:"Are you sure to remove the file?"},n.openConfirm({templateUrl:"modules/dialog/customDialog.html",scope:e,className:"ngdialog-theme-default"}).then(function(){s.deleteAssetFile(t._id).then(function(e){200==e.statusCode&&e.response.success&&(r.success(e.response.msg,"Success"),d(function(){o.reload()},200))})})},e.clearSelection=function(){console.log("clearSelection"),e.showBarDelete=!1,e.showBarRestore=!1,e.showBarShare=!1,e.showBarEmail=!1,e.showBarMove=!1,e.showBarMore=!1,e.showToolPreview=!1,e.selectedFiles=[],_.each(e.assets.folders,function(e){e.isActive=!1}),_.each(e.assets.assets,function(e){e.isActive=!1})},e.activeSelected=function(s,t){if(e.showBarDelete=!0,e.showBarMore=!0,"main.shared-with-me"==o.current.name?(e.showBarEmail=!0,e.showBarShare=!1,e.showBarDelete=!1,e.showBarRestore=!1,e.showBarMove=!1,e.showBarAddStar=!1,e.showBarRemoveStar=!1,e.showBarRename=!1,e.showToolMakeCopy=!1,s.isFolder?e.showToolPreview=!1:e.showToolPreview=!0):"main.trash"==o.current.name?(e.showBarRestore=!0,s.isFolder?(e.showToolPreview=!1,e.showToolMakeCopy=!1):(e.showToolPreview=!0,e.showToolMakeCopy=!0)):(e.showBarRestore=!1,e.showBarShare=!0,e.showBarEmail=!0,e.showBarMove=!0,s.isFolder?(e.showToolPreview=!1,e.showToolMakeCopy=!1):(e.showToolPreview=!0,e.showToolMakeCopy=!0)),e.selectedFile=s,t)if(_.isUndefined(t.ctrlKey))if(_.isUndefined(t.metaKey))s.isActive=!0,e.selectedFiles=[],F(s);else{e.selectedFiles.length<1&&F(s);var i=_.find(e.selectedFiles,{_id:e.selectedFile._id});i?(s.isActive=!1,_.remove(e.selectedFiles,function(s){return s._id==e.selectedFile._id})):(s.isActive=!0,e.selectedFiles.push(e.selectedFile))}else{e.selectedFiles.length<1&&F(s);var i=_.find(e.selectedFiles,{_id:e.selectedFile._id});i?(s.isActive=!1,_.remove(e.selectedFiles,function(s){return s._id==e.selectedFile._id})):(s.isActive=!0,e.selectedFiles.push(e.selectedFile))}}}])}();
!function(){"use strict";function e(e,o,s,l,n,t,i,c,a,u,r){console.log("assetsUploadModalCtrl: ",a),e.item={},e.isUploadAll=!0,e.isClose=!1;var d=JSON.parse(u.get("user")),f=e.uploader=new l({url:n+t+"assets",method:"POST",headers:{Authorization:"Bearer "+c.getUserToken(),accesskey:d.subscriptionKey}});f.filters.push({name:"customFilter",fn:function(e,o){return this.queue.length<10}}),f.onBeforeUploadItem=function(e){e.alias="files",a._id&&_.isUndefined(a.sub_id)?e.formData=[{parent_id:a._id}]:a._id&&a.sub_id&&(e.formData=[{parent_id:a.sub_id}])},f.onSuccessItem=function(e,o,s,l){r.success(o.response.msg,"Success")},f.onWhenAddingFileFailed=function(e,o,s){console.log("item:",e),console.log("filter:",o),console.log("options:",s)},f.onAfterAddingFile=function(e){console.log("onAfterAddingFile:",e)},f.onCompleteAll=function(e){r.success("Media / File upload complete","Success"),i(function(){s.close("success")},1300)},e.uploadAll=function(){f.uploadAll(),e.isUploadAll=!1,e.isClose=!0},e.cancel=function(){s.dismiss("cancel")}}angular.module("POS17").controller("assetsUploadModalCtrl",e),e.$inject=["$scope","$state","$uibModalInstance","FileUploader","API_URL","API_VERSION","$timeout","AuthFctry","$stateParams","localStorageService","toastr"]}();
!function(){"use strict";function s(s,e,r,n,t,o){s.folder={},s.create=function(){n._id&&(s.folder.parent_id=n._id),o.createFolder(s.folder).then(function(s){200==s.statusCode&&s.response.success?(t.success(s.response.msg,"Success"),r(function(){e.close(s.response.result)},300)):400===s.statusCode&&!s.response.success&&_.isArray(s.response.result)?_.each(s.response.result,function(s){t.warning(s.msg,"Warning")}):t.error(s.response.msg,"Error")})},s.cancel=function(){e.dismiss("cancel")}}angular.module("POS17").controller("assetsFolderModalCtrl",s),s.$inject=["$scope","$uibModalInstance","$timeout","$stateParams","toastr","assetsFctry"]}();
!function(){"use strict";function s(s,e,r,t,i,n,o,c,a){s.sharer={},s.users=[],s.items=[],s.asset={},s.asset=a,s.owner={},0==s.asset.isPublic?s.sharer.isPublic=!1:null==s.asset.isPublic?s.sharer.isPublic=!1:1==s.asset.isPublic&&(s.sharer.isPublic=!0),async.waterfall([function(s){c.getAllUserAccounts().then(function(e){if(200==e.statusCode&&e.response.success){var r=e.response.result;s(null,r)}else s(null,[])})},function(r,t){s.users=angular.copy(r),_.remove(s.users,function(s){return s.uc_id==e.profile.uc_id}),_.each(s.users,function(e){var r=e.profile;s.items.push({displayName:r.displayName,email:r.email||"",_id:r._id,id:e.uc_id,type:"user"})})}]),o.getSharedAssetFile(s.asset.asset_id).then(function(e){if(200!=e.statusCode||!e.response.success)return void n.error(e.response.msg,"Error");var r=e.response.result;s.sharer.email=_.map(r,function(s){if(s.info){var e=s.info;return{displayName:e.displayName,email:e.email||"",_id:e._id,id:e.uc_id,type:"user"}}})}),s.tagTransform=function(s){return{displayName:s}},s.clearInput=function(s){s.search=""},s.deleteEmail=function(s){console.log("deleteEmail: ",s)},s.sendMail=function(){var e=_.map(s.sharer.email,function(s){return{id:s.id,type:s.type}});s.asset.isFolder?s.sharer.isPublic?o.publicSharedFolder(s.asset._id,"public").then(function(s){return 200==s.statusCode&&s.response.success?(n.success(s.response.msg,"Success"),void r.close("save")):void n.error(s.response.msg,"Error")}):e&&e.length>0||o.publicSharedFolder(s.asset._id,"private").then(function(s){return 200==s.statusCode&&s.response.success?(n.success(s.response.msg,"Success"),void r.close("save")):void n.error(s.response.msg,"Error")}):s.sharer.isPublic?o.publicSharedAssetFile(s.asset._id,"public").then(function(s){return 200==s.statusCode&&s.response.success?(n.success(s.response.msg,"Success"),void r.close("save")):void n.error(s.response.msg,"Error")}):e&&e.length>0?o.removeSharedAssetFile(s.asset.asset_id).then(function(t){if(200!=t.statusCode||!t.response.success)return void n.error(t.response.msg,"Error");var i=1;async.eachSeries(e,function(t,c){o.shareAssetFile(s.asset._id,{shared_to:t.id,share_type:t.type}).then(function(s){return 200==s.statusCode&&s.response.success?(n.success(s.response.msg,"Success"),i++,c(),void 0):400===s.statusCode&&!s.response.success&&_.isArray(s.response.result)?void _.each(s.response.result,function(s){n.warning(s.msg,"Warning")}):void n.error(s.response.msg,"Error")}),i==e.length&&r.close("save")})}):o.publicSharedAssetFile(s.asset._id,"private").then(function(s){return 200==s.statusCode&&s.response.success?(n.success(s.response.msg,"Success"),void r.close("save")):void n.error(s.response.msg,"Error")})},s.cancel=function(){r.dismiss("cancel")}}angular.module("POS17").controller("assetsShareModalCtrl",s),s.$inject=["$scope","$rootScope","$uibModalInstance","$timeout","$stateParams","toastr","assetsFctry","useraccountsFctry","asset_file"]}();
!function(){"use strict";function e(e,s,n,a,t,r,o,l,i){e.sharer={},e.persons=[],e.company=[],e.items=[],async.waterfall([function(e){l.getAllCompany().then(function(s){if(200==s.statusCode&&s.response.success){var n=s.response.result;e(null,n)}else e(null,[])})},function(e,s){o.getAllPerson().then(function(n){if(200==n.statusCode&&n.response.success){var a=n.response.result;s(null,e,a)}else s(null,[])})},function(s,n,a){e.persons=angular.copy(n),e.company=angular.copy(s),e.persons=_.filter(e.persons,function(e){if("Customer"==e.person_type&&0==e.isSubscriber)return e}),_.each(e.persons,function(s){e.items.push({displayName:s.displayName,email:s.email||"",_id:s._id})}),_.each(e.company,function(s){e.items.push({displayName:s.name,email:s.email_address||"",_id:s._id})})}]),e.tagTransform=function(e){return{email:e}},e.clearInput=function(e){e.search=""},e.deleteEmail=function(e){console.log("deleteEmail: ",e)},e.sendMail=function(){e.sharer.from="support@symphony.com.ph",e.sharer.subject="Symphony Presentation",e.sharer.message=$("#printasset").html(),e.sharer.attachment=asset_file.asset_url||"",e.sharer.email=_.map(e.sharer.email,function(e){return e.email}),console.log("$scope.sharer: ",e.sharer)},e.cancel=function(){s.dismiss("cancel")}}angular.module("POS17").controller("assetsShareEmailModalCtrl",e),e.$inject=["$scope","$uibModalInstance","$timeout","$stateParams","toastr","assetsFctry","humanFactory","companyFactory","emailFactory"]}();
!function(){"use strict";function e(e,s,t,l,c,a){e.audio="audio"==a,e.config={sources:[{src:c.trustAsResourceUrl(l.asset_url),type:l.asset_mimetype}],theme:{url:"http://www.videogular.com/styles/themes/default/latest/videogular.css"}},e.cancel=function(){t.dismiss("cancel")}}function s(e,s,t,l,c,a){e.pdfName=c.media_name,e.file_type=c.asset_mimetype,"application/pdf"==c.asset_mimetype?e.pdfUrl=l.trustAsResourceUrl(c.asset_url):"text/plain"==c.asset_mimetype?e.pdfUrl=l.trustAsResourceUrl("https://docs.google.com/gview?url="+c.asset_url+"&embedded=true"):e.pdfUrl=l.trustAsResourceUrl("https://view.officeapps.live.com/op/view.aspx?src="+c.asset_url),e.cancel=function(){t.dismiss("cancel")}}angular.module("POS17").controller("assetsMediaModalCtrl",e).controller("assetsDocsModalCtrl",s),e.$inject=["$scope","$state","$uibModalInstance","files","$sce","type"],s.$inject=["$scope","$state","$uibModalInstance","$sce","files","localStorageService"]}();
!function(){"use strict";function e(e,s,n,l,i,o,t){e.file={},e.file=t,console.log("$scope.file: ",e.file),e.file.isFolder?e.file.foldername=e.file.folder_name:e.file.filename=e.file.asset_name,e.Rename=function(){function l(e){200==e.statusCode&&e.response.success?(i.success(e.response.msg,"Success"),n(function(){s.close("save")},100)):400===e.statusCode&&!e.response.success&&_.isArray(e.response.result)?_.each(e.response.result,function(e){i.warning(e.msg,"Warning")}):i.error(e.response.msg,"Error")}e.file.isFolder?o.updateFolder(e.file._id,{folder_name:e.file.foldername}).then(l):o.updateAssetFile(e.file._id,{file_name:e.file.filename}).then(l)},e.cancel=function(){s.dismiss("cancel")}}angular.module("POS17").controller("assetsRenameModalCtrl",e),e.$inject=["$scope","$uibModalInstance","$timeout","$stateParams","toastr","assetsFctry","asset_file"]}();
!function(){"use strict";function t(t,e,a){function s(t,e){if(0==t)return"0 Byte";var a=1024,s=e+1||3,l=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],r=Math.floor(Math.log(t)/Math.log(a));return parseFloat((t/Math.pow(a,r)).toFixed(s))+" "+l[r]}t.items={},t.chart={},t.chart.labels=["Used","Free"],t.chart.data=[0,0],t.chart.colors=["#1a5350","#e2e2e2"],t.chart.options={},Chart.defaults.global.legend.display=!0,Chart.defaults.global.scaleLabel=function(t){return t.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},Chart.defaults.global.multiTooltipTemplate=function(t){return t.datasetLabel+":== "+t.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},t.filesize=0;var l=0;t.initStorage=function(){a.getAllAssets().then(function(e){if(200==e.statusCode&&e.response.success){t.items=e.response.result;var a=_.sumBy(t.items.assets,function(t){return t.asset_filesize});t.filesize=s(a);var r=2147483648;l=r-a,t.chart.data=[a,l],t.chart.options={legend:{display:!0},tooltips:{enabled:!0,mode:"single",callbacks:{label:function(t,e){var a=e.labels[t.index],l=e.datasets[t.datasetIndex].data[t.index];return a+": "+s(l)}}}}}})}}angular.module("POS17").controller("assetsStorageCtrl",t),t.$inject=["$scope","$timeout","assetsFctry"]}();
!function(){"use strict";function s(s,t,e,n,a,c){s.files={},s.files=c,s.cancel=function(){t.dismiss("cancel")}}angular.module("POS17").controller("assetsInfoModalCtrl",s),s.$inject=["$scope","$uibModalInstance","$timeout","$stateParams","toastr","asset_file"]}();
!function(){"use strict";function e(e,s,i,o,t,l,n){e.files={},e.treedata=[],e.asset_file=n,e.isLoading=!0,e.treedata.push({label:"Main Files",_id:null,folder_id:null}),l.getAllAssets().then(function(s){200==s.statusCode&&s.response.success&&(e.files=s.response.result,_.each(e.files.folders,function(s){var i={label:s.folder_name,_id:s._id,folder_id:s.folder_id,children:[]};_.each(s.sub_folders,function(e){i.children.push({label:e.folder_name,_id:s._id,folder_id:s.folder_id})}),e.treedata.push(i)}),e.isLoading=!1)}),e.Move=function(){function o(e){200==e.statusCode&&e.response.success&&(t.success(e.response.msg,"Success"),i(function(){s.close("save")},100))}if(!e.abc||!angular.isObject(e.abc.currentNode))return void t.warning("Please select directory where the files/folder to move","WARNING");var n=e.abc.currentNode;if(e.asset_file.isFolder){if(e.asset_file._id==n._id)return void t.warning("Unable to move folder on same folder source","WARNING");if(e.asset_file.parent_id==n._id)return void t.warning("Unable to move folder on root folder source","WARNING");l.moveFolder(e.asset_file._id,n._id).then(o)}else l.moveAssetFile(e.asset_file._id,n._id).then(o)},e.cancel=function(){s.dismiss("cancel")}}angular.module("POS17").controller("assetsMoveModalCtrl",e),e.$inject=["$scope","$uibModalInstance","$timeout","$stateParams","toastr","assetsFctry","asset_file"]}();
!function(){"use strict";angular.module("POS17").config(["$urlRouterProvider","$stateProvider",function(a,t){t.state("main.aim-tab",{url:"/aim/aimTab",templateUrl:"modules/aim/aim-tab.html",controller:"aimTabCtrl"})}])}();
!function(){"use strict";function e(e,t,n,o){e.viewMore=!1,e.View=!0,e.startWith=0,e.limit=50,e.dhan="",e.test={},e.today=function(){e.today=t("date")(new Date,"dd MMM yyyy")},e.today(),e.is_disable=!1,e.startRequest=function(t){n.getReceiveCode(t).then(function(t){e.receives=t.response.result.result})},e.startSync=function(){n.SyncOpetaion().then(function(e){console.log("Sync operation completed.")})},e.back=function(){e.startRequest(),e.viewMore=!1,e.View=!0},e.showMoreinfo=function(t,o,r){n.getProductBaseonRececingOrder(t).then(function(t){e.products=t.response.result}),e.receivenumber=o,e.receivedate=r,e.View=!1,e.viewMore=!0},e.parseDate=function(e){if(e)return moment(new Date(e)).format("MMMM Do YYYY")},e.check=function(t){e.received=t},e.checkValue=function(t,n,o){angular.forEach(e.products,function(e){e.row_id==o&&(t>n?e.val3=!0:e.val3=!1)})},e.save=function(){var t=!0;angular.forEach(e.products,function(e){return null==e.codes_on_hand?(t=!1,void o.error("Please check code qty fields","An error occured.")):e.codes_on_hand<0?(t=!1,void o.error("Please check code qty fields","An error occured.")):e.codes_on_hand>e.newquantity?(t=!1,void o.error("Please check code qty fields","An error occured.")):void 0}),t&&n.setCodeInventory(e.products).then(function(t){if(t.response.success)o.success("","Successfully Saved"),e.back();else if(!t.response.success)return void o.error(t.response.msg,"Error")})},e.printDoc=function(){var e=document.getElementById("receivings").innerHTML,t=window.open("","_blank","width=300,height=300");t.document.open(),t.document.write('<html><head><link rel="stylesheet" type="text/css" href="style.css" /></head><body onload="window.print()">'+e+"</body></html>"),t.document.close()},e.getCodeInventory=function(){n.getCodeInventory().then(function(t){e.codeinventory=t.response.result})},e.searchData=function(t){e.startRequest({startWith:e.startWith,limit:e.limit,searchKey:t})},e.init=function(){e.startRequest({startWith:e.startWith,limit:e.limit,searchKey:""}),e.startSync(),e.getCodeInventory()},e.init()}angular.module("POS17").controller("aimTabCtrl",e),e.$inject=["$scope","$filter","aimFctry","toastr"]}();
!function(){"use strict";angular.module("POS17").directive("errSrc",function(){return{link:function(t,e,i){t.$watch(function(){return i.ngSrc},function(t){t||e.attr("src",i.errSrc)}),e.bind("error",function(){e.attr("src",i.errSrc)})}}}).directive("sidebar",function(){return{restrict:"C",compile:function(t,e,i){$.AdminLTE.tree(t)}}}).directive("header",function(){return{restrict:"E",templateUrl:"./modules/templates/header.html",compile:function(t,e,i){$.AdminLTE.pushMenu($(t).find(".sidebar-toggle"))}}}).directive("knob",function(){return{restrict:"C",compile:function(t,e,i){t.knob({draw:function(){if("tron"==this.$.data("skin")){var t,e=this.angle(this.cv),i=this.startAngle,n=this.startAngle,r=n+e,a=!0;return this.g.lineWidth=this.lineWidth,this.o.cursor&&(n=r-.3)&&(r+=.3),this.o.displayPrevious&&(t=this.startAngle+this.angle(this.value),this.o.cursor&&(i=t-.3)&&(t+=.3),this.g.beginPath(),this.g.strokeStyle=this.previousColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,i,t,!1),this.g.stroke()),this.g.beginPath(),this.g.strokeStyle=a?this.o.fgColor:this.fgColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth,n,r,!1),this.g.stroke(),this.g.lineWidth=2,this.g.beginPath(),this.g.strokeStyle=this.o.fgColor,this.g.arc(this.xy,this.xy,this.radius-this.lineWidth+1+2*this.lineWidth/3,0,2*Math.PI,!1),this.g.stroke(),!1}}})}}}).directive("sparkline",function(){return{restrict:"C",compile:function(t,e,i){t.each(function(){var t=$(this);t.sparkline("html",t.data())})}}}).directive("box",function(){return{restrict:"C",compile:function(t,e,i){var n=this;$(t).find(this.boxWidgetOptions.boxWidgetSelectors.collapse).click(function(t){t.preventDefault(),n.collapse($(this))}),$(t).find(this.boxWidgetOptions.boxWidgetSelectors.remove).click(function(t){t.preventDefault(),n.remove($(this))})},collapse:function(t){var e=t.parents(".box").first(),i=e.find(".box-body, .box-footer");e.hasClass("collapsed-box")?(t.children(".fa-plus").removeClass("fa-plus").addClass("fa-minus"),i.slideDown(300,function(){e.removeClass("collapsed-box")})):(t.children(".fa-minus").removeClass("fa-minus").addClass("fa-plus"),i.slideUp(300,function(){e.addClass("collapsed-box")}))},remove:function(t){var e=t.parents(".box").first();e.slideUp()},boxWidgetOptions:{boxWidgetIcons:{collapse:"fa fa-minus",open:"fa fa-plus",remove:"fa fa-times"},boxWidgetSelectors:{remove:'[data-widget="remove"]',collapse:'[data-widget="collapse"]'}}}}).directive("chat",function(){return{restrict:"E",templateUrl:"./modules/templates/direct-chat.html",scope:{type:"@",title:"@",count:"@count",messages:"=messages"},replace:!0,compile:function(t,e){return t.find("[data-widget='chat-pane-toggle']").click(function(){$(this).parents(".direct-chat").first().toggleClass("direct-chat-contacts-open")}),{pre:function(t,e,i){},post:function(t,e,i){}}}}}).directive("repeatEnd",function(){return{restrict:"A",link:function(t,e,i){t.$last&&t.$eval(i.repeatEnd)}}}).directive("ngRepeatEndWatch",function(){return{restrict:"A",scope:{},link:function(t,e,i){if(!i.ngRepeat)throw"ngRepeatEndWatch: `ngRepeat` Directive required to use this Directive";t.$parent.$last&&(""!==i.ngRepeatEndWatch?"function"==typeof t.$parent.$parent[i.ngRepeatEndWatch]?t.$parent.$parent[i.ngRepeatEndWatch]():t.$parent.$parent[i.ngRepeatEndWatch]=!0:t.$parent.$parent.ngRepeatEnd=!0)}}}).directive("dateNow",["$filter",function(t){return{link:function(e,i,n){i.text(t("date")(new Date,n.dateNow))}}}]).directive("infiniteScroll",["$rootScope","$window","$timeout",function(t,e,i){return{link:function(n,r,a){var o,s,l,c;return e=angular.element(e),r.css("overflow-y","auto"),r.css("overflow-x","hidden"),r.css("height","inherit"),l=0,null!=a.infiniteScrollDistance&&n.$watch(a.infiniteScrollDistance,function(t){return l=parseInt(t,10)}),c=!0,o=!1,null!=a.infiniteScrollDisabled&&n.$watch(a.infiniteScrollDisabled,function(t){if(c=!t,c&&o)return o=!1,s()}),t.$on("refreshStart",function(){r.animate({scrollTop:"0"})}),s=function(){var e,i,s,u,d;return e=$(r.children()[0]),i=r.offset().top+r.height(),d=e.offset().top+e.height(),s=d-i,u=s<=r.height()*l,u&&c?t.$$phase?n.$eval(a.infiniteScroll):n.$apply(a.infiniteScroll):u?o=!0:void 0},r.on("scroll",s),n.$on("$destroy",function(){return e.off("scroll",s)}),i(function(){return a.infiniteScrollImmediateCheck?n.$eval(a.infiniteScrollImmediateCheck)?s():void 0:s()},0)}}}]).directive("starRating",function(){return{restrict:"EA",template:'<ul class="star-rating" ng-class="{readonly: readonly}">  <li ng-repeat="star in stars" class="star" ng-class="{filled: star.filled}" ng-click="toggle($index)">    <i class="fa fa-star"></i>  </li></ul>',scope:{ratingValue:"=ngModel",max:"=?",onRatingSelect:"&?",readonly:"=?"},link:function(t,e,i){function n(){t.stars=[];for(var e=0;e<t.max;e++)t.stars.push({filled:e<t.ratingValue})}void 0==t.max&&(t.max=5),t.toggle=function(e){void 0!=t.readonly&&t.readonly!==!1||(t.ratingValue=e+1,t.onRatingSelect({rating:e+1}))},t.$watch("ratingValue",function(t,e){e&&n()})}}}).directive("ngThumb",["$window",function(t){var e={support:!(!t.FileReader||!t.CanvasRenderingContext2D),isFile:function(e){return angular.isObject(e)&&e instanceof t.File},isImage:function(t){var e="|"+t.type.slice(t.type.lastIndexOf("/")+1)+"|";return"|jpg|png|jpeg|bmp|gif|".indexOf(e)!==-1}};return{restrict:"A",template:"<canvas/>",link:function(t,i,n){function r(t){var e=new Image;e.onload=a,e.src=t.target.result}function a(){var t=o.width||this.width/this.height*o.height,e=o.height||this.height/this.width*o.width;s.attr({width:t,height:e}),s[0].getContext("2d").drawImage(this,0,0,t,e)}if(e.support){var o=t.$eval(n.ngThumb);if(e.isFile(o.file)&&e.isImage(o.file)){var s=i.find("canvas"),l=new FileReader;l.onload=r,l.readAsDataURL(o.file)}}}}}]).directive("numbersOnly",function(){return{require:"ngModel",link:function(t,e,i,n){function r(t){if(t){var e=t.replace(/[^0-9-]/g,"");return e!==t&&(n.$setViewValue(e),n.$render()),e}}n.$parsers.push(r)}}}).directive("compareTo",function(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(t,e,i,n){n.$validators.compareTo=function(e){return e==t.otherModelValue},t.$watch("otherModelValue",function(){n.$validate()})}}}).directive("validPasswordC",function(){return{require:"ngModel",link:function(t,e,i,n){n.$setValidity("noMatch",!0),i.$observe("validPasswordC",function(t){console.log("newVal: ",t),"true"==t?n.$setValidity("noMatch",!0):1==t?n.$setValidity("noMatch",!0):n.$setValidity("noMatch",!1)})}}}).directive("validNumber",function(){return{require:"?ngModel",link:function(t,e,i,n){n&&(n.$parsers.push(function(t){if(angular.isUndefined(t))var t="";var e=t.replace(/[^-0-9\.]/g,""),i=e.split("-"),r=e.split(".");return angular.isUndefined(i[1])||(i[1]=i[1].slice(0,i[1].length),e=i[0]+"-"+i[1],i[0].length>0&&(e=i[0])),angular.isUndefined(r[1])||(r[1]=r[1].slice(0,2),e=r[0]+"."+r[1]),t!==e&&(n.$setViewValue(e),n.$render()),e}),e.bind("keypress",function(t){32===t.keyCode&&t.preventDefault()}))}}}).directive("ngBooleanRadio",function(){return{require:"ngModel",link:function(t,e,i,n){n.$formatters.push(function(t){return t===!0?"true":t===!1?"false":void 0}),n.$parsers.push(function(t){return"true"===t||"false"!==t&&void 0})}}}).directive("barsChart",function(t){var e={restrict:"E",replace:!1,scope:{data:"=chartData"},link:function(t,e,i){var n=d3.select(e[0]);n.append("div").attr("class","chart").selectAll("div").data(t.data).enter().append("div").transition().ease("elastic").style("width",function(t){return t+"%"}).text(function(t){return t+"%"})}};return e})}();

!function(){function t(t,n,u){return{getAllDevices:function(){return t.all("devices").customGET().then(function(t){return t},function(t){return t.data})},getAllAPIKeys:function(){return t.all("apikeys").customGET().then(function(t){return t},function(t){return t.data})},activateSocialAuth:function(u){return t.oneUrl("socialauth",n+"/socialauth").customPOST(u).then(function(t){return t},function(t){return t.data})},getSocialAuth:function(){return t.oneUrl("socialauth",n+"/socialauth").customGET().then(function(t){return t},function(t){return t.data})},deleteSocialAuth:function(u,e){return t.oneUrl("socialauth"+u,n+"/socialauth/"+u).customPUT(e).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("appSettingsFctry",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";angular.module("POS17").factory("httpInterceptor",["$q","$rootScope",function(r,n){var t=0;return{request:function(o){return 1===++t&&n.$broadcast("loading:progress"),o||r.when(o)},response:function(o){return 0===--t&&n.$broadcast("loading:finish"),o||r.when(o)},responseError:function(o){return 0===--t&&n.$broadcast("loading:finish"),r.reject(o)}}}])}();
!function(){"use strict";function t(t,n,u){return{getAllProduct:function(n){return t.all("product").customGET("",n).then(function(t){return t},function(t){return t.data})},getProductDetails:function(n){return t.all("product").customGET(n).then(function(t){return t},function(t){return t.data})},deleteProduct:function(n){return t.all("products").customDELETE(n).then(function(t){return t},function(t){return t.data})},saveProduct:function(n){return t.all("product").customPOST(n).then(function(t){return t},function(t){return t.data})},updateProduct:function(n,u){return t.all("product").customPUT(u,n).then(function(t){return t},function(t){return t.data})},archiveProduct:function(n){return t.all("product/"+n+"/archive").customPUT().then(function(t){return t},function(t){return t.data})},publishProduct:function(n){return t.all("product/"+n+"/publish").customPUT().then(function(t){return t},function(t){return t.data})},draftProduct:function(n){return t.all("product/"+n+"/draft").customPUT().then(function(t){return t},function(t){return t.data})},deleteProductCategory:function(n){return t.all("product/"+n+"/category").customDELETE().then(function(t){return t},function(t){return t.data})},getProductsCategory:function(n){return t.all("product/"+n+"/category").customGET().then(function(t){return t},function(t){return t.data})},saveProductsCategory:function(n,u){return t.all("product/"+n+"/category").customPUT(u).then(function(t){return t},function(t){return t.data})},getProductAttributes:function(n){return t.all("product/"+n+"/attributes").customGET().then(function(t){return t},function(t){return t.data})},saveProductBundle:function(n){return t.all("product-bundle").customPOST(n).then(function(t){return t},function(t){return t})},updateProductBundle:function(n,u){return t.all("product-bundle/"+n).customPUT(u).then(function(t){return t},function(t){return t})},getAllProductBundle:function(){return t.all("product-bundle").customGET().then(function(t){return t},function(t){return t})},getProductBundleDetails:function(n){return t.all("product-bundle").customGET(n).then(function(t){return t},function(t){return t})},publishBundle:function(n){return t.all("product-bundle/"+n+"/publish").customPUT().then(function(t){return t},function(t){return t})},draftBundle:function(n){return t.all("product-bundle/"+n+"/draft").customPUT().then(function(t){return t},function(t){return t.data})},archiveBundle:function(n){return t.all("product-bundle/"+n+"/archive").customPUT().then(function(t){return t},function(t){return t})},getProductBundleAuditLog:function(n,u){return t.all("product-bundle/"+n+"/logs").customGET("",u).then(function(t){return t},function(t){return t.data})},getProductBundleAttributes:function(n){return t.all("product-bundle/"+n+"/attributes").customGET().then(function(t){return t},function(t){return t.data})},deleteProductBundleCategory:function(n){return t.all("product-bundle/"+n+"/category").customDELETE().then(function(t){return t},function(t){return t})},saveProductBundleCategory:function(n,u){return t.all("product-bundle/"+n+"/category").customPUT(u).then(function(t){return t},function(t){return t})},getProductBundleCategory:function(n){return t.all("product-bundle/"+n+"/category").customGET().then(function(t){return t},function(t){return t})},deleteProductBundleImageFile:function(n,u){return t.all("product-bundle/"+n+"/image/"+u).customDELETE().then(function(t){return t},function(t){return t})},deleteAllProductBundleImage:function(n){return t.all("product-bundle/"+n+"/image").customDELETE().then(function(t){return t},function(t){return t})},deleteProductImageFile:function(n,u){return t.all("product/"+n+"/image/"+u).customDELETE().then(function(t){return t},function(t){return t})},deleteAllProductImage:function(n){return t.all("product/"+n+"/image").customDELETE().then(function(t){return t},function(t){return t})},setProductImage:function(n,u){return t.all("product/"+n+"/image/"+u).customPUT().then(function(t){return t},function(t){return t})},getProductAuditLog:function(n,u){return t.all("product/"+n+"/logs").customGET("",u).then(function(t){return t},function(t){return t.data})},getProductAndStores:function(n,u){return t.all("product/"+n+"/stores").customGET("").then(function(t){return t},function(t){return t.data})},getAllProductUnits:function(n,u){return t.all("product/units").customGET("").then(function(t){return t},function(t){return t.data})},getAllProductUnitsByPID:function(n){return t.all("product/"+n+"/units").customGET("").then(function(t){return t},function(t){return t.data})},assignStore:function(n,u){return t.all("product/"+n+"/assignstore").customPUT(u).then(function(t){return t},function(t){return t})}}}angular.module("POS17").factory("productFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(t,n,r){return{getAllStore:function(){return t.all("store").customGET().then(function(t){return t},function(t){return t.data})},getStoreDetails:function(n){return t.all("store").customGET(n).then(function(t){return t},function(t){return t.data})},updateStore:function(n,r){return t.all("store/"+n).customPUT(r).then(function(t){return t},function(t){return t.data})},saveStore:function(n){return t.all("store").customPOST(n).then(function(t){return t},function(t){return t.data})},deleteStore:function(n){return t.all("store").customDELETE(n).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("storeFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function n(n,t,u,r){return{getAllBanks:function(){return n.all("banks").customGET().then(function(n){return n},function(n){return n.data})},getBankDetails:function(t){return n.all("banks").customGET(t).then(function(n){return n},function(n){return n.data})},updateBank:function(t,u){return n.all("banks/"+t).customPUT(u).then(function(n){return n},function(n){return n.data})},saveBank:function(t){return n.all("banks").customPOST(t).then(function(n){return n},function(n){return n.data})},deleteBank:function(t){return n.all("banks").customDELETE(t).then(function(n){return n},function(n){return n.data})}}}angular.module("POS17").factory("bankFctry",n),n.$inject=["Restangular","API_URL","API_VERSION","toastr"]}();
!function(){"use strict";function t(t,n,u){return{getAllAttribute:function(){return t.all("attributes").customGET().then(function(t){return t},function(t){return t.data})},getAllAttributeDetails:function(n){return t.all("attributes").customGET(n).then(function(t){return t},function(t){return t.data})},getAttributeGroupDetails:function(n){return t.all("attributegroup").customGET(n).then(function(t){return t},function(t){return t.data})},saveAttributeGroup:function(n){return t.all("attributegroup").customPOST(n).then(function(t){return t},function(t){return t.data})},deleteAttribute:function(n){return t.all("attributes").customDELETE(n).then(function(t){return t},function(t){return t.data})},updateAttributeGroup:function(n,u){return t.all("attributegroup/"+n).customPUT(u).then(function(t){return t},function(t){return t.data})},getAllAttributeGroup:function(){return t.all("attributegroup").customGET().then(function(t){return t},function(t){return t.data})},deleteAttributeGroup:function(n){return t.all("attributegroup").customDELETE(n).then(function(t){return t},function(t){return t.data})},getAllAttributeTypes:function(){return t.all("attributeTypes").customGET().then(function(t){return t},function(t){return t.data})},saveAttribute:function(n){return t.all("attributes").customPOST(n).then(function(t){return t},function(t){return t.data})},updateAttribute:function(n,u){return t.all("attributes/"+n).customPUT(u).then(function(t){return t},function(t){return t.data})},getAttributeValues:function(n){return t.all("attributes/"+n+"/values").customGET().then(function(t){return t},function(t){return t.data})},saveAttributeValues:function(n,u){return t.all("attributes/"+n+"/values").customPOST(u).then(function(t){return t},function(t){return t.data})},updateAttributeValues:function(n,u,r){return console.log("_id:",u),console.log("data:",r),t.all("attributes/"+n+"/values/"+u).customPUT(r).then(function(t){return t},function(t){return t.data})},deleteAttributeValues:function(n,u,r){return t.all("attributes/"+n+"/values/"+u).customDELETE().then(function(t){return t},function(t){return t.data})},saveAttributeValueList:function(n,u){return t.all("attributes/"+n+"/valuelist").customPOST(u).then(function(t){return t},function(t){return t.data})},deleteAttributeValueList:function(n,u){return t.all("attributes/"+n+"/valuelist/"+u).customDELETE().then(function(t){return t},function(t){return t.data})},getAttributeValueList:function(n,u){return t.all("attributes/"+n+"/valuelist").customGET().then(function(t){return t},function(t){return t.data})},getAttibuteMapping:function(n){return t.all("attributes/"+n+"/mapping").customGET().then(function(t){return t},function(t){return t.data})},saveAttributeMapping:function(n,u){return t.all("attributes/"+n+"/mapping").customPOST(u).then(function(t){return t},function(t){return t.data})},deleteAttributeMapping:function(n){return t.all("attributes/"+n+"/mapping").customDELETE().then(function(t){return t},function(t){return t.data})},updateAttributeVisibility:function(n){return console.log(n),t.all("attributes/attributevisibility").customPOST(n).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("attributeFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(t,n,e){return{getAllCategory:function(){return t.all("categories").customGET().then(function(t){return t},function(t){return t.data})},getCategoryDetails:function(n){return t.all("categories").customGET(n).then(function(t){return t},function(t){return t.data})},saveCategory:function(n){return t.all("categories").customPOST(n).then(function(t){return t},function(t){return t.data})},updateCategory:function(n,e){return t.all("categories/"+n).customPUT(e).then(function(t){return t},function(t){return t.data})},deleteCategory:function(n){return t.all("categories").customDELETE(n).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("categoryFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(t,n,u,r){return{getAllProdType:function(){return t.all("productType").customGET().then(function(t){return t},function(t){return t.data})},getAllProdTypeDetails:function(n){return t.all("productType").customGET(n).then(function(t){return t},function(t){return t.data})},saveProductType:function(n){return t.all("productType").customPOST(n).then(function(t){return t},function(t){return t.data})},updateProductType:function(n,u){return t.all("productType/"+n).customPUT(u).then(function(t){return t},function(t){return t.data})},deleteProductType:function(n){return t.all("producttype").customDELETE(n).then(function(t){return t},function(t){return t.data})},getAttributeMapping:function(n){return t.all("producttype/"+n+"/attributemaps").customGET().then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("ptypeFactory",t),t.$inject=["Restangular","API_URL","Upload","toastr"]}();
!function(){"use strict";function t(t,n,u){return{getAllSuppliers:function(){return t.all("supplier").customGET().then(function(t){return t},function(t){return t.data})},getAllSuppliersDetails:function(n){return t.all("supplier").customGET(n).then(function(t){return t},function(t){return t.data})},saveSupplier:function(n){return t.all("supplier").customPOST(n).then(function(t){return t},function(t){return t.data})},updateSupplier:function(n,u){return t.all("supplier/"+n).customPUT(u).then(function(t){return t},function(t){return t.data})},deleteSupplier:function(n){return t.all("supplier").customDELETE(n).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("supplierFctry",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(t,n,r){return{getAllVariation:function(){return t.all("variation").customGET().then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("variationFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function n(n,t,u){return{getAllPerson:function(){return n.all("persons").customGET().then(function(n){return n},function(n){return n})},getAllPersonDetail:function(t){return n.all("persons").customGET(t).then(function(n){return n},function(n){return n})},savePersonel:function(t){return n.all("persons").customPOST(t).then(function(n){return n},function(n){return n})},updatePersonel:function(t,u){return n.all("persons/"+t).customPUT(u).then(function(n){return n},function(n){return n})},getPersonType:function(){return n.all("persontype").customGET().then(function(n){return n},function(n){return n})},getImage:function(t,u){return n.all("persontype/"+t).customPUT(u).then(function(n){return n},function(n){return n})},getTimeZone:function(){return n.all("timezones").customGET().then(function(n){return n},function(n){return n})},deletePersonel:function(t){return n.all("persons").customDELETE(t).then(function(n){return n},function(n){return n})},updateUsername:function(t){return n.all("user/username").customPUT(t).then(function(n){return n},function(n){return n})},updatePassword:function(t){return n.all("user/password").customPUT(t).then(function(n){return n},function(n){return n})},getUserSocial:function(){return n.all("user/social").customGET().then(function(n){return n},function(n){return n})},addRecoveryPassword:function(t){return n.all("user/recovery").customPUT(t).then(function(n){return n},function(n){return n})},addUserPIN:function(t){return n.all("user/pin").customPUT(t).then(function(n){return n},function(n){return n})},getUserPIN:function(){return n.all("user/pin").customGET().then(function(n){return n},function(n){return n})},getCustomerGroup:function(){return n.all("customergroup").customGET().then(function(n){return n},function(n){return n})},getCustomerGroupDetail:function(t){return n.all("customergroup").customGET(t).then(function(n){return n},function(n){return n})},saveCustomerGroup:function(t){return n.all("customergroup").customPOST(t).then(function(n){return n},function(n){return n})},updateCustomerGroup:function(t,u){return n.all("customergroup/"+t).customPUT(u).then(function(n){return n},function(n){return n})},deleteCustomerGroup:function(t){return n.all("customergroup/"+t).customDELETE().then(function(n){return n},function(n){return n})},getCustomerGroupMapping:function(t){return n.all("customergroup/"+t+"/mapping").customGET().then(function(n){return n},function(n){return n})}}}angular.module("POS17").factory("humanFactory",n),n.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function n(n,t,r){return{generatePasswordString:function(n){for(var t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",u=0;u<n;u++)t+=r.charAt(Math.floor(Math.random()*r.length));return t},getAllUserAccounts:function(){return n.all("useraccounts").customGET().then(function(n){return n},function(n){return n.data})},saveUserAccount:function(t){return n.all("useraccounts").customPOST(t).then(function(n){return n},function(n){return n.data})},getUserAccount:function(t,r){return n.all("useraccounts/"+t+"/info/"+r).customGET().then(function(n){return n},function(n){return n.data})},updateUserAccount:function(t,r){return n.all("useraccounts/"+t).customPUT(r).then(function(n){return n},function(n){return n.data})},deleteUserAccount:function(t){return n.all("useraccounts").customDELETE(t).then(function(n){return n},function(n){return n.data})},updateUserUsername:function(t,r){return n.all("useraccounts/"+t+"/username").customPUT(r).then(function(n){return n},function(n){return n.data})},updateUserPassword:function(t,r){return n.all("useraccounts/"+t+"/password").customPUT(r).then(function(n){return n},function(n){return n.data})},updateUserEmailRecovery:function(t,r){return n.all("useraccounts/"+t+"/recovery").customPUT(r).then(function(n){return n},function(n){return n.data})},getUserEmailRecovery:function(t){return n.all("useraccounts/"+t+"/recovery").customGET().then(function(n){return n},function(n){return n.data})},getUserPIN:function(t){return n.all("useraccounts/"+t+"/pin").customGET().then(function(n){return n},function(n){return n.data})},updateUserPIN:function(t,r){return n.all("useraccounts/"+t+"/pin").customPUT(r).then(function(n){return n},function(n){return n.data})}}}function t(n,t,r){return{createUserGroup:function(t){return n.all("usergroups").customPOST(t).then(function(n){return n},function(n){return n.data})},getAllUserGroups:function(){return n.all("usergroups").customGET().then(function(n){return n},function(n){return n.data})},getUserGroupById:function(t){return n.all("usergroups").customGET(t).then(function(n){return n},function(n){return n.data})},deleteUserGroup:function(t){return n.all("usergroups").customDELETE(t).then(function(n){return n},function(n){return n.data})},updateUserGroup:function(t,r){return n.all("usergroups/"+t).customPUT(r).then(function(n){return n},function(n){return n.data})}}}function r(n,t,r){return{getAllModulesPermissions:function(){return n.all("/modules/permissions").customGET().then(function(n){return n},function(n){return n.data})},generateAccessPermission:function(t){return n.all("useraccounts/"+t+"/permissions").customGET().then(function(n){return n},function(n){return n.data})},setGroupPrivilege:function(t,r){return n.all("useraccounts/"+t+"/permissions").customPUT(r).then(function(n){return n},function(n){return n.data})},resetGroupPrivilege:function(t,r){return n.all("useraccounts/"+t+"/permissions").customDELETE().then(function(n){return n},function(n){return n.data})}}}angular.module("POS17").factory("useraccountsFctry",n).factory("usergroupsFctry",t).factory("permissionFctry",r),n.$inject=["Restangular","API_URL","toastr"],t.$inject=["Restangular","API_URL","toastr"],r.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function n(n,t,e){return{getAllEmployees:function(){return n.all("persons").customGET().then(function(n){return n},function(n){return n.data})},saveEmployee:function(t){return n.all("persons").customPOST(t).then(function(n){return n.data},function(n){return n.data})},updateEmployee:function(t,e){return n.all("persons/"+t).customPUT(e).then(function(n){return n.data},function(n){return n.data})},deleteEmployee:function(t){return n.all("persons").customDELETE(t).then(function(n){return n.data},function(n){return n.data})},getEmployee:function(t){return n.all("persons").customGET(t).then(function(n){return n.data},function(n){return n.data})},getAssignedStorePerson:function(t){return n.all("getassignedstoreP/"+t).customGET().then(function(n){return n},function(n){return n})},assignedStorePerson:function(t,e){return n.all("assignedstoreToP/"+t).customPOST(e).then(function(n){return n},function(n){return n})}}}angular.module("POS17").factory("personFctry",n),n.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(t,n,r){return{getAllCurrencies:function(){return t.all("currencies").customGET().then(function(t){return t},function(t){return t.data})}}}function n(t){return{getAllCountries:function(){return t.all("countries").customGET().then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("currencyFactory",t).factory("countryFactory",n),t.$inject=["Restangular","API_URL","toastr"],n.$inject=["Restangular"]}();
!function(){"use strict";function t(t,e,n,r){return{authenticate:function(e){return t.all("identity").customPOST(e).then(function(t){return t},function(t){return t.data})},logout:function(){return t.all("identity").customDELETE().then(function(t){return t},function(t){return t.data})},userprofile:function(){return t.all("identity").customGET().then(function(t){return t},function(t){return t.data})},setUserToken:function(t){r.set("token",t)},getUserToken:function(){return r.get("token")},setCurrentUser:function(t){r.set("user",t)},getCurrentUser:function(){return r.get("user")},forgotPassword:function(e){return t.all("forgot_password").customPOST(e).then(function(t){return t},function(t){return t})},resendVerification:function(e){return t.all("resend_verification").customPOST(e).then(function(t){return t},function(t){return t})},isVerifiedContact:function(e){return t.all("users/"+e+"/verify").customGET().then(function(t){return t},function(t){return t})},verifyContact:function(e){return t.all("users/"+e+"/verify").customPOST().then(function(t){return t},function(t){return t})},isVerifiedEmailRecovery:function(e){return t.all("users/"+e+"/recovery").customGET().then(function(t){return t},function(t){return t})},verifyEmailRecovery:function(e){return t.all("users/"+e+"/recovery").customPOST().then(function(t){return t},function(t){return t})}}}function e(t,e,n,r,u,o){return{request:function(t){if(t.headers=t.headers||{},o.get("token")){var e=o.get("token"),n=JSON.parse(o.get("user"));t.headers.Authorization="Bearer "+e,t.headers.timezone=moment.tz.guess(),t.headers.timezone2=moment().format("Z"),n&&(t.headers.accesskey=n.subscriptionKey)}return t},response:function(t){if(o.get("token")){var e=o.get("token");u.isTokenExpired(e)&&(o.remove("token"),o.remove("user"),n.path("/login"))}return t},responseError:function(e){return 401===e.status&&(t.$broadcast("unauthorized"),n.path("/login")),e}}}angular.module("POS17").factory("AuthFctry",t).factory("authInterceptor",e),t.$inject=["Restangular","API_URL","API_VERSION","localStorageService"],e.$inject=["$rootScope","$q","$location","$injector","jwtHelper","localStorageService"]}();
!function(){"use strict";function t(t,n,r){return{getPriceHistory:function(n){return t.all("pricehistory").customGET(n).then(function(t){return t},function(t){return t.data})},getStoreP:function(n){return t.all("storeowner").customGET(n).then(function(t){return t},function(t){return t.data})},deleteSP:function(n){return t.all("pricehistory").customGET(n).then(function(t){return t},function(t){return t.data})},saveSP:function(n,r){return t.all("pricehistory/"+n).customPUT(r).then(function(t){return t},function(t){return t.data})},updateSP:function(n,r){return t.all("detail/"+n).customPUT(r).then(function(t){return t.data},function(t){return t.data})}}}angular.module("POS17").factory("priceHistoryFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(t,n,u){return{getAllProduct:function(){return t.all("product").customGET().then(function(t){return t},function(t){return t.data})},getProductDetails:function(n){return t.all("product").customGET(n).then(function(t){return t},function(t){return t.data})},deleteProduct:function(n){return t.all("products").customDELETE(n).then(function(t){return t},function(t){return t.data})},saveProduct:function(n){return t.all("product").customPOST(n).then(function(t){return t},function(t){return t.data})},updateProduct:function(n,u){return t.all("product").customPUT(u,n).then(function(t){return t},function(t){return t.data})},archiveProduct:function(n){return t.all("product/"+n+"/archive").customPUT().then(function(t){return t},function(t){return t.data})},publishProduct:function(n){return t.all("product/"+n+"/publish").customPUT().then(function(t){return t},function(t){return t.data})},deleteProductCategory:function(n){return t.all("product/"+n+"/category").customDELETE().then(function(t){return t},function(t){return t.data})},getProductsCategory:function(n){return t.all("product/"+n+"/category").customGET().then(function(t){return t},function(t){return t.data})},saveProductsCategory:function(n,u){return t.all("product/"+n+"/category").customPUT(u).then(function(t){return t},function(t){return t.data})},getProductAttributes:function(n){return t.all("product/"+n+"/attributes").customGET().then(function(t){return t},function(t){return t.data})},saveProductBundle:function(n){return t.all("product-bundle").customPOST(n).then(function(t){return t},function(t){return t})},updateProductBundle:function(n,u){return t.all("product-bundle/"+n).customPUT(u).then(function(t){return t},function(t){return t})},getAllProductBundle:function(){return t.all("product-bundle").customGET().then(function(t){return t},function(t){return t})},getProductBundleDetails:function(n){return t.all("product-bundle").customGET(n).then(function(t){return t},function(t){return t})},publishBundle:function(n){return t.all("product-bundle/"+n+"/publish").customPUT().then(function(t){return t},function(t){return t})},archiveBundle:function(n){return t.all("product-bundle/"+n+"/archive").customPUT().then(function(t){return t},function(t){return t})}}}angular.module("POS17").factory("productpurchasedFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){function t(t,n,r){return{getArticle:function(){return t.all("articleinfo").customGET().then(function(t){return t},function(t){return t.data})},getDetailArticle:function(n){return t.all("articleinfo").customGET(n).then(function(t){return t},function(t){return t.data})},saveArticle:function(n){return t.all("articleinfo").customPOST(n).then(function(t){return t},function(t){return t.data})},updateArticle:function(n,r){return t.all("articleinfo/"+n).customPUT(r).then(function(t){return t},function(t){return t.data})},deleteArticle:function(n){return t.all("articleinfo").customDELETE(n).then(function(t){return t},function(t){return t.data})},deleteAllArticleMedia:function(n){return t.all("articlemedia").customDELETE(n).then(function(t){return t},function(t){return t.data})},deleteArticleMediaFile:function(n,r){return t.all("articlemedia/"+n+"/file/"+r).customDELETE().then(function(t){return t},function(t){return t.data})},publishArticle:function(n){return t.all("articleinfo/"+n+"/publish").customPUT().then(function(t){return t},function(t){return t.data})},draftArticle:function(n){return t.all("articleinfo/"+n+"/draft").customPUT().then(function(t){return t},function(t){return t.data})},getArticleAuditLog:function(n,r){return t.all("articleinfo/"+n+"/logs").customGET("",r).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("articleFctry",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(t,n){return{getAllTags:function(n){var u={filter:n};return t.all("tags").customGET("",u).then(function(t){return t},function(t){return t.data})},saveTags:function(n){return t.all("tags").customPOST(n).then(function(t){return t},function(t){return t.data})},saveProductTags:function(n,u){return t.all("product/"+n+"/tags").customPOST(u).then(function(t){return t},function(t){return t.data})},getAllProductTags:function(n){return t.all("product/"+n+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteProductTag:function(n,u){return t.all("product/"+n+"/tags/"+u).customDELETE().then(function(t){return t},function(t){return t.data})},saveProductGroupTags:function(n,u){return t.all("product-bundle/"+n+"/tags").customPOST(u).then(function(t){return t},function(t){return t.data})},getAllProductBundleTags:function(n){return t.all("product-bundle/"+n+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteProductBundleTag:function(n,u){return t.all("product-bundle/"+n+"/tags/"+u).customDELETE().then(function(t){return t},function(t){return t.data})},saveArticleTags:function(n,u){return t.all("article/"+n+"/tags").customPOST(u).then(function(t){return t},function(t){return t.data})},getAllArticleTags:function(n){return t.all("article/"+n+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteArticleTag:function(n,u){return t.all("article/"+n+"/tags/"+u).customDELETE().then(function(t){return t},function(t){return t.data})},saveBankTags:function(n,u){return t.all("bank/"+n+"/tags").customPOST(u).then(function(t){return t},function(t){return t.data})},getAllBankTags:function(n){return t.all("bank/"+n+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteBankTag:function(n,u){return t.all("bank/"+n+"/tags/"+u).customDELETE().then(function(t){return t},function(t){return t.data})},saveStoreTags:function(n,u){return t.all("store/"+n+"/tags").customPOST(u).then(function(t){return t},function(t){return t.data})},getAllStoreTags:function(n){return t.all("store/"+n+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteStoreTag:function(n,u){return t.all("store/"+n+"/tags/"+u).customDELETE().then(function(t){return t},function(t){return t.data})},saveCategoryTags:function(n,u){return t.all("categories/"+n+"/tags").customPOST(u).then(function(t){return t},function(t){return t.data})},getAllCategoryTags:function(n){return t.all("categories/"+n+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteCategoryTag:function(n,u){return t.all("categories/"+n+"/tags/"+u).customDELETE().then(function(t){return t},function(t){return t.data})},saveProductTypeTags:function(n,u){return t.all("producttype/"+n+"/tags").customPOST(u).then(function(t){return t},function(t){return t.data})},getAllProductTypeTags:function(n){return t.all("producttype/"+n+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteProductTypeTag:function(n,u){return t.all("producttype/"+n+"/tags/"+u).customDELETE().then(function(t){return t},function(t){return t.data})},saveSupplierTags:function(n,u){return t.all("supplier/"+n+"/tags").customPOST(u).then(function(t){return t},function(t){return t.data})},getAllSupplierTags:function(n){return t.all("supplier/"+n+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteSupplierTag:function(n,u){return t.all("supplier/"+n+"/tags/"+u).customDELETE().then(function(t){return t},function(t){return t.data})},saveQuoteTags:function(n,u){return t.all("quote/"+n+"/tags").customPOST(u).then(function(t){return t},function(t){return t.data})},getAllQuoteTags:function(n){return t.all("quote/"+n+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deleteQuoteTag:function(n,u){return t.all("quote/"+n+"/tags/"+u).customDELETE().then(function(t){return t},function(t){return t.data})},savePricebookTags:function(n,u){return t.all("pricebook/"+n+"/tags").customPOST(u).then(function(t){return t},function(t){return t.data})},getAllPricebookTags:function(n){return t.all("pricebook/"+n+"/tags").customGET().then(function(t){return t},function(t){return t.data})},deletePricebookTag:function(n,u){return t.all("pricebook/"+n+"/tags/"+u).customDELETE().then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("tagsFactory",t),t.$inject=["Restangular","API_URL"]}();
!function(){function t(t,n,u){return{saveQuoteInfo:function(n){return t.all("quoteinfo").customPOST(n).then(function(t){return t},function(t){return t.data})},getAllQuotes:function(){return t.all("quoteinfo").customGET().then(function(t){return t},function(t){return t.data})},getDetailQuote:function(n){return t.all("quoteinfo").customGET(n).then(function(t){return t},function(t){return t.data})},updateQuoteInfo:function(n,u){return t.all("quoteinfo/"+n).customPUT(u).then(function(t){return t},function(t){return t.data})},deleteQuoteInfo:function(n){return t.all("quoteinfo").customDELETE(n).then(function(t){return t},function(t){return t.data})},getQuoteAuditLog:function(n,u){return t.all("quoteinfo/"+n+"/logs").customGET("",u).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("quoteFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(t,n,e){return{getAllPricebook:function(){return t.all("pricebook").customGET().then(function(t){return t},function(t){return t.data})},getPricebookDetail:function(n){return t.all("pricebook").customGET(n).then(function(t){return t},function(t){return t.data})},getPricebookType:function(){return t.all("pricebooktype").customGET().then(function(t){return t},function(t){return t.data})},validatePricebookName:function(n){return t.all("pricebook/validate/name").customPOST(n).then(function(t){return t},function(t){return t.data})},savePricebook:function(n){return t.all("pricebook").customPOST(n).then(function(t){return t},function(t){return t.data})},updatePriceBook:function(n,e){return t.all("pricebook/"+n).customPUT(e).then(function(t){return t},function(t){return t.data})},getAllPriceBookType:function(){return t.all("pricebooktype").customGET().then(function(t){return t},function(t){return t.data})},savePriceBookType:function(n){return t.all("pricebooktype").customPOST(n).then(function(t){return t},function(t){return t.data})},getPriceBookType:function(n){return t.all("pricebooktype/"+n).customGET().then(function(t){return t},function(t){return t.data})},updatePriceBookType:function(n,e){return t.all("pricebooktype/"+n).customPUT(e).then(function(t){return t},function(t){return t.data})},deletePriceBookType:function(n){return t.all("pricebooktype/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},getAllPriceBookAssociation:function(){return t.all("pricebookassoc").customGET().then(function(t){return t},function(t){return t.data})},savePriceBookAssociation:function(n){return t.all("pricebookassoc").customPOST(n).then(function(t){return t},function(t){return t.data})},getPriceBookAssociation:function(n){return t.all("pricebookassoc/"+n).customGET().then(function(t){return t},function(t){return t.data})},deletePriceBookAssociation:function(n){return t.all("pricebookassoc/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},updatePriceBookAssociation:function(n,e){return t.all("pricebookassoc/"+n).customPUT(e).then(function(t){return t},function(t){return t.data})},savePriceBookItem:function(n,e){return t.all("pricebook/"+n+"/items").customPOST(e).then(function(t){return t},function(t){return t.data})},getAllPriceBookItem:function(n){return t.all("pricebook/"+n+"/items").customGET().then(function(t){return t},function(t){return t.data})},deletePriceBookItem:function(n,e){return t.all("pricebook/"+n+"/items/"+e).customDELETE().then(function(t){return t},function(t){return t.data})},updatePriceBookItem:function(n,e,o){return t.all("pricebook/"+n+"/items/"+e).customPUT(o).then(function(t){return t},function(t){return t.data})},updatePriceBookItemPrice:function(n,e,o){return t.all("pricebook/"+n+"/items/"+e+"/price").customPUT(o).then(function(t){return t},function(t){return t.data})},duplicatePriceBook:function(n){return t.all("pricebook/"+n+"/duplicate").customPUT().then(function(t){return t},function(t){return t.data})},approvedPriceBook:function(n,e){return t.all("pricebook/"+n+"/approved").customPUT(e).then(function(t){return t},function(t){return t.data})},deletePriceBook:function(n){return t.all("pricebook/"+n).customDELETE().then(function(t){return t},function(t){return t.data})},getPricebookAuditLog:function(n,e){return t.all("pricebook/"+n+"/logs").customGET("",e).then(function(t){return t},function(t){return t.data})},getPricebookSchedule:function(n,e){return t.all("pricebooksched/"+n).customGET("",e).then(function(t){return t},function(t){return t.data})},createPricebookSchedule:function(n,e){return t.all("pricebooksched/"+n).customPOST(e).then(function(t){return t},function(t){return t.data})},updatepricebookSchedule:function(n,e,o){return t.all("pricebooksched/"+n+"/pricebookday/"+e).customPUT(o).then(function(t){return t},function(t){return t.data})},deletepricebookSchedule:function(n,e){return t.all("pricebooksched/"+n+"/pricebookday/"+e).customDELETE().then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("pricebookFactory",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function n(n,t,u){return{importCSVCompanyData:function(t){return n.all("companyinfo/import?type=csv").customPOST(t).then(function(n){return n},function(n){return n.data})},getAllCompany:function(){return n.all("companyinfo").customGET().then(function(n){return n},function(n){return n.data})},getCompanyInfo:function(t){return n.all("companyinfo").customGET(t).then(function(n){return n},function(n){return n.data})},saveCompany:function(t){return n.all("companyinfo").customPOST(t).then(function(n){return n},function(n){return n.data})},updateCompany:function(t,u){return n.all("companyinfo/"+t).customPUT(u).then(function(n){return n},function(n){return n.data})},deleteCompany:function(t){return n.all("companyinfo").customDELETE(t).then(function(n){return n},function(n){return n.data})},saveCustomerGroup:function(t,u){return n.all("companyinfo/"+t+"/group").customPUT(u).then(function(n){return n},function(n){return n.data})},getCustomerGroup:function(t){return n.all("companyinfo/"+t+"/group").customGET().then(function(n){return n},function(n){return n.data})},deleteCustomerGroup:function(t){return n.all("companyinfo/"+t+"/group").customDELETE().then(function(n){return n},function(n){return n.data})}}}angular.module("POS17").factory("companyFactory",n),n.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function t(t){return{getAllRelationType:function(){return t.all("relation_type").customGET().then(function(t){return t},function(t){return t.data})},getRelationType:function(n){return t.all("relation_type").customGET(n).then(function(t){return t},function(t){return t.data})},updateRelationType:function(n,e){return t.all("relation_type/"+n).customPUT(e).then(function(t){return t},function(t){return t.data})},saveRelationType:function(n){return t.all("relation_type").customPOST(n).then(function(t){return t},function(t){return t.data})},deleteRelationType:function(n){return t.all("relation_type").customDELETE(n).then(function(t){return t},function(t){return t.data})},getAllRelatedProduct:function(n){return t.all("product/"+n+"/related").customGET().then(function(t){return t},function(t){return t.data})},getRelatedProduct:function(n,e){return t.all("product/"+n+"/related/"+e).customGET().then(function(t){return t},function(t){return t.data})},saveRelatedProduct:function(n,e){return t.all("product/"+n+"/related").customPOST(e).then(function(t){return t},function(t){return t.data})},updateRelatedProduct:function(n,e,u){return t.all("product/"+n+"/related/"+e).customPUT(u).then(function(t){return t},function(t){return t.data})},deleteRelatedProduct:function(n,e){return t.all("product/"+n+"/related/"+e).customDELETE().then(function(t){return t},function(t){return t.data})},getAllRelatedBundle:function(n){return t.all("product-bundle/"+n+"/related").customGET().then(function(t){return t},function(t){return t.data})},getRelatedBundle:function(n,e){return t.all("product-bundle/"+n+"/related/"+e).customGET().then(function(t){return t},function(t){return t.data})},saveRelatedBundle:function(n,e){return t.all("product-bundle/"+n+"/related").customPOST(e).then(function(t){return t},function(t){return t.data})},updateRelatedBundle:function(n,e,u){return t.all("product-bundle/"+n+"/related/"+e).customPUT(u).then(function(t){return t},function(t){return t.data})},deleteRelatedBundle:function(n,e){return t.all("product-bundle/"+n+"/related/"+e).customDELETE().then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("relatedProductFactory",t),t.$inject=["Restangular"]}();
!function(){"use strict";angular.module("POS17").factory("clipboard",["$document","$window",function(e,t){function o(o,n){var r=e[0].createElement("textarea");return r.style.position="absolute",r.textContent=o,r.style.left="-10000px",r.style.top=(t.pageYOffset||e[0].documentElement.scrollTop)+"px",r}function n(t){try{e[0].body.style.webkitUserSelect="initial";var o=e[0].getSelection();if(o.removeAllRanges(),t.select(),!e[0].execCommand("copy"))throw"failure copy";o.removeAllRanges()}finally{e[0].body.style.webkitUserSelect=""}}function r(t,r){var i=o(t,r);e[0].body.appendChild(i),n(i),e[0].body.removeChild(i)}return{copyText:r,supported:"queryCommandSupported"in e[0]&&e[0].queryCommandSupported("copy")}}]).directive("clipboard",["clipboard",function(e){return{restrict:"A",scope:{onCopied:"&",onError:"&",text:"=",supported:"=?"},link:function(t,o){t.supported=e.supported,o.on("click",function(n){try{e.copyText(t.text,o[0]),angular.isFunction(t.onCopied)&&t.$evalAsync(t.onCopied())}catch(r){angular.isFunction(t.onError)&&t.$evalAsync(t.onError({err:r}))}})}}}])}();
!function(){"use strict";function e(e,n,t){return{getAllDevice:function(){return e.all("devices").customGET().then(function(e){return e},function(e){return e.data})},getDeviceSelected:function(n){return e.all("devicesselected").customGET(n).then(function(e){return e},function(e){return e.data})},getUnSelectedDevice:function(){return e.all("devicesnotselected").customGET().then(function(e){return e},function(e){return e.data})},Reassigndevice:function(n){return e.all("reassigndevice").customPOST(n).then(function(e){return e},function(e){return e.data})},assignDevice:function(n,t){return e.all("assigndevice/"+n).customPOST(t).then(function(e){return e},function(e){return e.data})},deleteassignDevice:function(n){return e.all("deleteassignedDevice/"+n).customDELETE().then(function(e){return e},function(e){return e.data})}}}angular.module("POS17").factory("deviceFactory",e),e.$inject=["Restangular","API_URL","toastr"]}();
(function(e){"use strict";if("undefined"==typeof XLSX)return void console.log("xlsx.js is required. Get it from https://github.com/SheetJS/js-xlsx");if("undefined"==typeof _)return void console.log("Lodash.js is required. Get it from http://lodash.com/");var r=this,t=(r.XLSXReader,function(e,r,o,n){var i={};return t.utils.intializeFromFile(i,e,r,o,n),i});"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.XLSXReader=t):r.XLSXReader=t,t.VERSION="0.0.1",t.utils={intializeFromFile:function(e,r,o,n,i){var a=new FileReader;a.onload=function(r){var i=r.target.result,a=XLSX.read(i,{type:"binary"});e.sheets=t.utils.parseWorkbook(a,o,n)},a.readAsBinaryString(r)},parseWorkbook:function(e,r,o){if(o===!0)return t.utils.to_json(e);var n={};return _.forEachRight(e.SheetNames,function(o){var i=e.Sheets[o];n[o]=t.utils.parseSheet(i,r)}),n},parseSheet:function(r,t){var o=XLSX.utils.decode_range(r["!ref"]),n=[];return t===!0&&_.forEachRight(_.range(o.s.r,o.e.r+1),function(t){var i=[];_.forEachRight(_.range(o.s.c,o.e.c+1),function(o){var n=XLSX.utils.encode_cell({c:o,r:t}),a=r[n];i[o]=a?a.v:e}),n[t]=i}),{data:n,name:r.name,col_size:o.e.c+1,row_size:o.e.r+1}},to_json:function(e){var r={};return e.SheetNames.forEach(function(t){var o=XLSX.utils.sheet_to_row_object_array(e.Sheets[t]);o.length>0&&(r[t]=o)}),r}}}).call(this),function(e){var r=angular.module("POS17");r.factory("XLSXReaderService",["$q","$rootScope",function(e,r){var t=function(e){angular.extend(this,e)};return t.readFile=function(t,o){var n=e.defer();return XLSXReader(t,o,function(e){r.$apply(function(){n.resolve(e)})}),n.promise},t}])}.call(this);
!function(e){"use strict";function r(r,n){function t(e,r){var t=n.defer();return r=r||{},r.complete=function(e){return r.rejectOnError&&e.errors.length?void t.reject(e):void t.resolve(e)},r.error=function(e){t.reject(e)},c.parse(e,r),t.promise}function o(e,r){try{return n.resolve(c.unparse(e,r))}catch(t){return n.reject(t)}}var c=r.Papa;e.extend(this,{parse:t,unparse:o,Papa:c})}e.module("POS17").service("Papa",r),r.$inject=["$window","$q"]}(angular);
!function(){"use strict";function r(r,e,n,t){return{getAllPurchaseOrder:function(){return r.all("purchaseorder").customGET().then(function(r){return r},function(r){return r.data})},getAllPurchaseOrderDetail:function(e){return r.all("purchaseorder").customGET(e).then(function(r){return r},function(r){return r.data})},savePurchaseOrder:function(e){return r.all("purchaseorder").customPOST(e).then(function(r){return r},function(r){return r.data})},updatePurchaseOrder:function(e,n){return r.all("purchaseorder/"+e).customPUT(n).then(function(r){return r},function(r){return r.data})},deletePurchaseOrder:function(e){return r.all("purchaseorder").customDELETE(e).then(function(r){return r},function(r){return r.data})},receivePurchasedOrder:function(e){return r.all("receiveorder").customPOST(e).then(function(r){return r},function(r){return r.data})},approvedPurchasedOrder:function(e,n){return r.all("purchaseorder/"+e+"/approve").customPUT(n).then(function(r){return r},function(r){return r.data})},generatepoid:function(){return r.all("purchaseorder/generatepoid").customGET().then(function(r){return r},function(r){return r.data})}}}angular.module("POS17").factory("purchaseOrderFactory",r),r.$inject=["Restangular","API_URL","Upload","toastr"]}();
!function(){"use strict";function n(n,t,e){return{getAllInventory:function(){return n.all("inventory").customGET().then(function(n){return n},function(n){return n.data})},saveEmployee:function(t){return n.all("persons").customPOST(t).then(function(n){return n.data},function(n){return n.data})},updateEmployee:function(t,e){return n.all("persons/"+t).customPUT(e).then(function(n){return n.data},function(n){return n.data})},deleteEmployee:function(t){return n.all("persons").customDELETE(t).then(function(n){return n.data},function(n){return n.data})},getEmployee:function(t){return n.all("persons").customGET(t).then(function(n){return n.data},function(n){return n.data})}}}angular.module("POS17").factory("inventoryFactory",n),n.$inject=["Restangular","API_URL","toastr"]}();
!function(){function t(t,n,e){return{getAllAssets:function(n){return t.all("assets").customGET("",n).then(function(t){return t},function(t){return t.data})},deleteAssetFile:function(n,e){return t.all("assets").customDELETE(n,e).then(function(t){return t},function(t){return t.data})},trashAssetFile:function(n){return t.all("assets/"+n+"/trash").customDELETE().then(function(t){return t},function(t){return t.data})},starredAssetFile:function(n){return t.all("assets/"+n+"/starred").customPUT().then(function(t){return t},function(t){return t.data})},restoreAssetFile:function(n){return t.all("assets/"+n+"/restore").customPUT().then(function(t){return t},function(t){return t.data})},moveAssetFile:function(n,e){return t.all("assets/"+n+"/move/"+e).customPUT().then(function(t){return t},function(t){return t.data})},updateAssetFile:function(n,e){return t.all("assets/"+n).customPUT(e).then(function(t){return t},function(t){return t.data})},shareAssetFile:function(n,e){return t.all("assets/"+n+"/share").customPOST(e).then(function(t){return t},function(t){return t.data})},getSharedAssetFile:function(n){return t.all("assets/"+n+"/share").customGET().then(function(t){return t},function(t){return t.data})},removeSharedAssetFile:function(n){return t.all("assets/"+n+"/share").customDELETE().then(function(t){return t},function(t){return t.data})},publicSharedAssetFile:function(n,e){return t.all("assets/"+n+"/share?action="+e).customPUT().then(function(t){return t},function(t){return t.data})},getFolderAssets:function(n,e){return t.all("assets_folders/"+n+"?share="+e).customGET().then(function(t){return t},function(t){return t.data})},createFolder:function(n){return t.all("assets_folders").customPOST(n).then(function(t){return t},function(t){return t.data})},deleteFolder:function(n){return t.all("assets_folders").customDELETE(n).then(function(t){return t},function(t){return t.data})},trashFolder:function(n){return t.all("assets_folders/"+n+"/trash").customDELETE().then(function(t){return t},function(t){return t.data})},starredFolder:function(n){return t.all("assets_folders/"+n+"/starred").customPUT().then(function(t){return t},function(t){return t.data})},restoreFolder:function(n){return t.all("assets_folders/"+n+"/restore").customPUT().then(function(t){return t},function(t){return t.data})},moveFolder:function(n,e){return t.all("assets_folders/"+n+"/move/"+e).customPUT().then(function(t){return t},function(t){return t.data})},updateFolder:function(n,e){return t.all("assets_folders/"+n).customPUT(e).then(function(t){return t},function(t){return t.data})},publicSharedFolder:function(n,e){return t.all("assets_folders/"+n+"/share?action="+e).customPUT().then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("assetsFctry",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function n(n){return{shareExperience:function(t,l){n.all("sharer").customPOST(t).then(function(n){l(null,n)},function(n){l(n.data,null)})},htmltoPDF:function(t,l){n.all("htmltopdf").customPOST(t).then(function(n){l(null,n)},function(n){l(n.data,null)})},sendMail:function(t,l){n.all("sendMail").customPOST(t).then(function(n){l(null,n)},function(n){l(n.data,null)})}}}angular.module("POS17").factory("emailFactory",n),n.$inject=["Restangular"]}();
!function(){"use strict";function t(t,n,r){return{getAllLogs:function(n){return t.all("transactionlog").customGET("",n).then(function(t){return t},function(t){return t.data})},logTransaction:function(n,r,a,o){return t.all("transactionlog").customPOST({action:n,module:r,parameters:a,details:o}).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("transLogFctry",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";function n(n){return{SyncOpetaion:function(){return n.all("sync").customGET().then(function(n){return n},function(n){return n.data})},getReceiveCode:function(t){return n.all("receiving").customGET("",t).then(function(n){return n},function(n){return n.data})},getProductBaseonRececingOrder:function(t){return n.all("receiving").customGET(t).then(function(n){return n},function(n){return n.data})},setCodeInventory:function(t){return n.all("codeinventory").customPOST(t).then(function(n){return n},function(n){return n.data})},getCodeInventory:function(){return n.all("codeinventory").customGET().then(function(n){return n},function(n){return n.data})}}}angular.module("POS17").factory("aimFctry",n).factory("aimDataFactory",["Restangular","API_URL_2","API_VERSION_2",function(n,t,e){return n.withConfig(function(n){n.setBaseUrl(t+e)})}]),n.$inject=["aimDataFactory"]}();
!function(){"use strict";function t(t,r,n){return{getDashboardReport:function(r){return t.all("report/reports").customGET("",r).then(function(t){return t},function(t){return t.data})},getDashboardSalesAndInventoryReport:function(r){return t.all("report/report_sales_inventory").customGET("",r).then(function(t){return t},function(t){return t.data})}}}angular.module("POS17").factory("dashboardReportsFctry",t),t.$inject=["Restangular","API_URL","toastr"]}();
!function(){"use strict";angular.module("POS17").filter("propsFilter",function(){return function(r,t){var n=[];return angular.isArray(r)?r.forEach(function(r){for(var e=!1,u=Object.keys(t),i=0;i<u.length;i++){var f=u[i],o=t[f].toLowerCase();if(r[f].toString().toLowerCase().indexOf(o)!==-1){e=!0;break}}e&&n.push(r)}):n=r,n}}).filter("percentage",["$filter",function(r){return function(t,n){return r("number")(100*t,n)+"%"}}]).filter("fromNow",function(){return function(r){return moment(r).fromNow()}}).filter("ellipsis",function(){return function(r,t,n,e){if(!r)return"";if(n=parseInt(n,10),!n)return r;if(r.length<=n)return r;if(r=r.substr(0,n),t){var u=r.lastIndexOf(" ");u!=-1&&("."!=r.charAt(u-1)&&","!=r.charAt(u-1)||(u-=1),r=r.substr(0,u))}return r+(e||" ")}}).filter("mydate",function(){var r=/\/Date\(([0-9]*)\)\//;return function(t){var n=t.match(r);return n?new Date(parseInt(n[1])):null}})}();